{"_default": {"1": {"INRIX-joel-winarske": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1627", "title": "Minimizing RAM footprint", "body": "I have a dedicated app using libh2o + libuv.  Currently my overall RAM footprint running on Linux is ~8.5 MB.\r\n\r\nWhat can I do to decrease RAM consumption?", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1627/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1418", "title": "http1client - File URI resolution", "body": "When requesting a File URI via http1client, I get an error response of \"Name or service not known\".\r\n\r\nExamples that generate error response:\r\nfile:///tmp/ts1504822735506-0\r\nfile://localhost/tmp/ts1504822735506-0", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1418/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1333", "title": "[libh2o] http1client / on_reprocess_request_cb", "body": "I implemented a http1client wrapper very similar to the re-proxy client.  I invoke the wrapper from a custom endpoint handler.  I'm seeing a timeout trigger prior to my operation (file download) completing.\r\n\r\nThe call stack looks like this:\r\ndo_close() at httpclient.c:281 0x419abf  (my wrapper code)\r\nclose_generator_and_filters() at request.c:192 0x42d43e\t\r\nh2o_reprocess_request() at request.c:343 0x42e780\r\non_reprocess_request_cb() at request.c:386 0x42e993\r\nh2o_timeout_run() at timeout.c:35 0x425606\r\non_timeout() at uv-binding.c.h:334 0x421485\r\nuv__run_timers() at timer.c:165 0x45fca5\r\nuv_run() at core.c:350 0x4577d2\r\nmain() at simple.c:250 0x414d28\r\n\r\nHow do I avoid this timeout?  The actual operation (file download) is still active, and this timeout causes it to be cut short.\r\n\r\nThanks,\r\nJoel\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1333/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1298", "title": "reproxy method type HEAD", "body": "In case of a reproxy of method type HEAD, two issues:\r\n\r\n1.  A reproxy head method request does not work every time.  When it fails the output looks something like this: \r\nx-reproxy-url: http://www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png\r\n[lib/core/proxy.c] in request:/images/branding/googlelogo/1...:socket create error\r\n\r\nUpdate:  It seems less frequent when there is more endpoint activity.  If server is idle, it's sure to happen when the first re-proxy request is a HEAD method and it needs to resolve the host name.\r\n\r\nIf I remove the need to resolve the host name, there is no issue.  Such as:\r\nhttp://216.58.216.164/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png\r\n\r\nSo it would seem the issue is host name resolution in the case of HEAD method.\r\n\r\n2.  The content-length header is not set to 0, so the originating client will timeout waiting for body response, as the header has a non-zero content-length header.  [PR 1299](https://github.com/h2o/h2o/pull/1299)", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1298/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "kazuho": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1617", "title": "Add support for Forwarded header (RFC 7239)", "body": "`x-forwarded-for` and `x-forwarded-proto` have been standardized in a slightly different (and obviously more streamlined way) in [RFC 7239](https://tools.ietf.org/html/rfc7239).\r\n\r\nWe should support it with an option to turn it _off_.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1617/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1601", "title": "more support for request streaming", "body": "With the merger of #1357 it has become possible to stream request body to the application without buffering entire content in H2O. However, the feature has so far been only implemented by the http2 protocol handler and the proxy handler.\r\n\r\nWe need to implement the feature in the following modules as well.\r\n* [ ] http1\r\n* [ ] fastcgi\r\n* [ ] mruby\r\n\r\nrelates to: #1585 ", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1601/reactions", "total_count": 4, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1592", "title": "fetch-ocsp-response should receive the certificate chain from the h2o process", "body": "At the moment, fetch-ocsp-response (a helper program that is used to fetch the OCSP response for stapling) loads the certificate chain from the file specified in the configuration file.\r\n\r\nThis has two unfortunate side-effects.\r\n\r\n1. the certificate file needs to be accessible from the running privilege of the server process\r\n2. if the certificate file is replaced after the worker process starts, the `fetch-ocsp-response` command will return a OCSP response for the replaced certificate, whereas the worker process will continue to use the certificate that it has loaded at startup\r\n\r\nWe should better supply the certificate chain from the H2O process and supply it to fetch-ocsp-response.\r\n\r\nNote that regarding point 1, technically speaking, there is no reason to restrict access to a certificate file (it's going to be sent over the wire to anybody). However, certbot (the de-facto standard program to update a let's encrypt certificate) restricts the access to root only. So we have an interoperability issue.\r\n\r\nRelates to: #1588.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1592/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1340", "title": "Refactor the timeout design", "body": "As we mature, we are seeing needs for a more flexible timeout control than we have today.\r\n\r\nCurrent timeout design is based on the expectation that many objects (i.e. `h2o_timeout_entry_t`) share a small number of timeout values (`h2o_timeout_t`). The approach is very efficient and works fine for a server implementation.\r\n\r\nHowever, to support QUIC (for which we need pacing) or mruby (which provides a `sleep` method that can take an arbitrary value as an argument, see #1330), we need a different design.\r\n\r\nNote that as discussed in https://github.com/h2o/h2o/pull/1330#discussion_r122901408 the current approach is not ideal in how a timeout object is disposed.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1340/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1248", "title": "connection-level logging", "body": "Log TLS- and HTTP/2-level errors (or events).\r\n\r\nrelates to #1230, #1235", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1248/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1159", "title": "output filtering using mruby (or Rack middleware)", "body": "At the moment, it is impossible to modify an output of another handler using mruby, even though the Rack API generally provides such method by nesting the handlers.\r\n\r\nWe should provide a way to implement output filtering in the way Rack does, so that middlewares can be implemented and/or reused.\r\n\r\nFor example, such configuration should look like:\r\n```yaml\r\npaths:\r\n  /:\r\n    mruby.handler: |\r\n      Proc.new do |env|\r\n        resp = app.call(env)\r\n        if resp[0] == 200\r\n          resp[1][\"x-header-added-by-mruby\"] == \"hello from mruby\"\r\n        end\r\n        resp\r\n      end\r\n    proxy.reverse.url: http://upstream/\r\n```\r\nThe snippet would add `x-header-added-by-mruby` header if the response generated by the following handlers (referred from the mruby code as `app`) has the status code 200.\r\n        ", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1159/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/968", "title": "cache-digests", "body": "Add support for [Cache Digests for HTTP/2](https://tools.ietf.org/html/draft-kazuho-h2-cache-digest-01).\n- [x] implement cache-digests decoder #967\n- [ ] modify the cookie-based impl. (i.e. casper) to not take etag into consideration\n- [x] recognize `cache-digests` header #967 \n  - [ ] cache the parsed header within HPACK structure\n  - [ ] delay the parsing of the header until use\n- [ ] add support for CACHE_DIGESTS HTTP/2 frame\n- [ ] support for stale digests\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/968/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/905", "title": "keep-alive with x-reproxy-url", "body": "The reverse proxy handler of H2O supports connection pooling.\n\nHowever, HTTP connections that are established as a result of `x-reproxy-url` header are not pooled.  This becomes an issue if you try to use H2O as a gateway of a distributed object storage (e.g. mogilefs).\n\nA distributed object storage is typically implemented as follows.\n\nWhen a client connects to a HTTP gateway (i.e. H2O), the web application running behind handles the request, and then returns an HTTP response with an `x-reproxy-url` header that points to a resource stored in one of the storage servers.  H2O recognizes the header, fetches the pointed resource, and returns the resource as the response to the client.\n\nIn such case, it is evident that H2O will send thousands or millions of requests to the storage servers, therefore it is essential to have persistent connection to the servers.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/905/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/889", "title": "TLS session resumption in HTTP/1 client", "body": "In #875 support for HTTPS has been added to the HTTP/1 client implementation (used by the proxy module), but it does not support TLS session resumption.\n\nrelates to: #657\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/889/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/888", "title": "HTTP client (i.e. proxy) talking HTTP/2", "body": "H2O supports HTTP/2 as a server, but its HTTP client (used for reverse proxying etc.) only supports HTTP/1.\n\nrelates to: #657\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/888/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/808", "title": "refactor the MIME-map API", "body": "The primary key of the MIME mapping is the mime-type, to which any number of extensions can be associated.\n\nHowever, current API of the mimemap does not reflect the structure; instead it exposes the signature below - the function always takes one extension as its argument.\n\n``` c\nvoid h2o_mimemap_define_mimetype(h2o_mimemap_t *mimemap, const char *ext, const char *mime, h2o_mime_attributes_t *attr)\n```\n\nThis has long been a headache.\n\nFor example in #806 we want to define `is_compressible` flag for each mime-type.  However, [handler/mimemap/defaults.c.h](https://github.com/h2o/h2o/blob/v1.7.0/lib/handler/mimemap/defaults.c.h) that uses a wrapper to calling the aforementioned function has the same mime-type declared multiple times (see how many times `application/octet-stream` appears).  And the fact makes it hard to introduce an argument that specifies an attribute _against_ a MIME-type.\n\nIt's high time we should address the issue.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/808/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/732", "title": "allow definition of a mime-type without extensions", "body": "As of now, the mimemap structure requires that at least one extension to be mapped for every mime-type.\n\nHowever for example if we have a definition like following in the configuration file, the default mapping for `text/css` gets removed, since the mapping for its only extension (i.e. `.css`) is overwritten.  This causes an unwanted side-effect that it invalidates the priority modification in case a FastCGI application returns a response with `text/css` wo. charset set as the content-type.\n\n```\nfile.mime.add-types:\n  \"text/css; charset=utf-8\":\n    extensions: [\".css\"]\n    is_compressible: yes\n    priority: highest\n```\n\nrelates to #730 #731\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/732/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/672", "title": "Rack API for pushing assets", "body": "As discussed in http://blog.kazuhooku.com/2015/12/optimizing-performance-of-multi-tiered.html, it is important to start pushing asset files using HTTP/2 _while_ proxying the request to backend.\n\nIn version 1.6, it is possible to do so using a mruby handler that returns 399 (fallback) status code, e.g.:\n\n```\npath: /\n  mruby.handler: |\n    Proc.new do |env|\n      [399, {\"Link\" => \"</style.css>; rel=preload\"}, []]\n    end\n  proxy.reverse.url: http://backend.example.com/\n```\n\nHowever, now that we are exposing HTTP client API to mruby handler in 1.7 (see #643 #637 #651), we need to provide a callback method to trigger HTTP/2 push without returning a status code.  As an example, we would need to do something like:\n\n```\npath: /\n  mruby.handler: |\n    Proc.new do |env|\n      # trigger HTTP/2 push\n      if env.responds_to? :push\n        env.push(\"/style.css\")\n      end\n      # transfer the request to backend\n      http_request(\"http://backend.example.com#{env[\"REQUEST_URI\"}\").join\n    end\n```\n\nThe question is how should the API (i.e. the `push` method in the example above) be designed:\n- Q1. should it be a method, or should it be a block stored as a hash element?\n- Q2. what is the appropriate name?\n\n@tenderlove Do you have any suggestions?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/672/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/621", "title": "FastCGI handler should close the response when it sees a zero-length FCGI_STDOUT record", "body": "In [FastCGI specification](http://www.fastcgi.com/drupal/node/6?q=node/22) a stream is defined as:\n\n> records of this type form a stream, terminated by a record with empty contentData.\n\nIt is also natural for a CGI application to continue processing after closing STDOUT, while possibly emitting to STDERR.\n\nTherefore, the FastCGI handler of H2O should:\n- call `h2o_send` with `is_final` flag set as soon as it receives an empty FCGI_STDOUT record\n- after that, the handler should collect FCGI_STDERR records and emit the content though `h2o_req_log_error`\n- it is after both streams gets closed that the request object should be discarded (at which point access log is emitted)\n\nHowever it is not implemented as such, see https://github.com/h2o/h2o/blob/v1.6.0/lib/handler/fastcgi.c#L616.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/621/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/447", "title": "push cache validator", "body": "Even if we do not want to push the _contents_ of every asset file (if it is not cached, see #421), pushing cache validators (i.e. notify the client that a file it _might_ have cached need not be revalidated) is still a good thing, since it would nullify the RTT required for revalidation.\n\nIn H2O, we are considering of implementing following method.\n- when receiving a `GET` request against an asset file without `etag` query parameter, temporary redirect the request to the same asset file with `etag` query parameter added, with the value of the parameter being the etag of the asset file\n  - e.g. request to `/assets/foo.js` is redirected to `/assets/foo.js?etag=xxxxxxxx`\n- if the `GET` request against the asset file contained the correct `etag` query parameter, respond with a 200 response containing the asset file with `expires` header set to a time in very far future\n- for every `link: rel=preload` header (that do not trigger cache-aware server push), trigger a server-push that pushes the temporary redirect described above\n\nBy implementing this approach, web browsers can identify zero-RTT whether or not a valid entry exists in its cache.  They would only spend 1-RTT or more if the asset does not exist in its cache.\n\nNotes:\n- [this thread](https://lists.w3.org/Archives/Public/ietf-http-wg/2014OctDec/0800.html) discusses a different approach, however it is unlikely that it would work 100% correctly\n- in HTTP/1, the best practice for nullifying the time spent for cache revalidation was to add query parameters to the asset files and at the server side serve such files with `expires` headers.  The problem with the approach is that it is hard to maintain; to avoid unnecessary transfers you need to set different tags (i.e. query parameters) to every asset file, and only update the tags of the files that have actually been modified (which in fact is rarely done).  With the proposed method, web developers no longer need to take care of such tags.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/447/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/421", "title": "cache-aware server-push", "body": "To optimize the responsiveness of a website, it is desirable to push assets (e.g. CSS and/or JavaScript files) that block the page rendering process when and only when such files do not already exist within the client's cache.  However, the specifications do not define a way to determine whether if a resource is already cached.\n\nThis issue proposes of using a cookie containing a probablistic data set as an approximation for determining the cache state of the client, and using it for restricting server-push - i.e. only push the asset files that are unlikely to be cached.\n\n**Basic Design**\n- use a single cookie that stores a Golomb coded set as to mark if the assets are cached\n- key for the set will be calculated as `key(filename)=sha1(filename + etag(filename))`\n- for each HTTP2 connection, the server maintains the value of the set\n  - the set is initialized as empty\n  - when receiving the cookie, the value of the set is set the the received value\n  - when starting to send a response,  for that response mark the set using a key calculated using the rule above, and send `set-cookie` header containing the value of the set\n  - when application logic triggers a server-push, check if the to-be-pushed content is marked within the set, and if marked, ignore the trigger.  If not, push the content to the client at the same time updating the value of the set using the rule above.\n- server may also maintain a set that maps all the existing files, and use the set to clear the keys of the incoming set that do not exist (i.e. means that the corresponding file has either been removed or updated), before copying the value to the internally maintained value\n\nBy applying this design for restricting server push, the only drawback of using server push will become when the cookie on the client expires before the asset cached in the client's cache expires.  In other words, the design will work effectively if such case is unlikely.\n\n**Notes**\n\nSince HTTP2 multiplexes the HTTP requests over a single stream, it has become possible for the web server to expect in which order the client receives the responses (i.e. we can safely say that: if the client has received the headers of response A, then it must have received the headers of response B that has been sent prior to A).  The design takes advantage of the property.\n\nA good read on Golomb coded set is [this blogpost](http://giovanni.bajo.it/post/47119962313/golomb-coded-sets-smaller-than-bloom-filters).  The only issue the doc has is how _M_ of Golomb coded is calculated; theoretically it should use median instead mean value.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/421/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/239", "title": "directives for tweaking the server header", "body": "Although low prority, we might need one.\n\nrelates to: #229\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/239/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/208", "title": "better behavior when getaddrinfo returns multiple addresses", "body": "If `getaddrinfo` returns more than one address, the HTTP proxy implementation of H2O should:\n- use a round-robin to determine the one to which the proxy should connect\n  - note: at the moment, the first entry is always selected\n- try to connect to the second (or third, 4th, ...) address if the first one fails\n\nrelates to #207 \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/208/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/199", "title": "global (i.e. non-host:port specific) socket pool", "body": "We need such thing, since `x-reproxy-url` (#197) may request H2O to connect to _any_ server.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/199/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}], "commits": [{"url": "https://api.github.com/repos/h2o/h2o/commits/764bb0ee6b152943ad529aa25c54d46f93d9a0cf", "message": "merge pull request #1624\n\nadd interface to release thread-local data"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/9e03bb5c03ea8337e1c6e2e8f4ee096e0482ffe7", "message": "extern variables should appear in the header files"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/c2c1d6584230ad9a2223be0ebc679171eaa149a3", "message": "rearrange the position"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/f41fbf6150edc0007bab72774f399c169b6ec244", "message": "Merge pull request #1623 from h2o/kazuho/issues/1615\n\nin examples/libh2o/simple.c, emit access-log to /dev/stdout as default"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/e99eed35a4e677f95f80496b2e99e3fc3ab9757d", "message": "emit access-log to /dev/stdout as default"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/75df8496445371e690ca3ab9e65d9d7a96d4d6ab", "message": "Merge pull request #1622 from h2o/kazuho/fix-leaks-on-destroy\n\nfix leaks on destroy"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/74a13a21f06e99b1b81841a9a6aeb73c7425adda", "message": "Merge pull request #1606 from h2o/kazuho/parse-mapping\n\nrefactor YOML attribute parsing"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/f33188386fc6062cffab287872b25d54914713b5", "message": "report the cause of the logic flaw"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/8ebd869b9494c56b17eb91ba3078eca429668b50", "message": "always use type specifier"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/8fce8da6a8386b7218e8f11642ad9de2d0d27e45", "message": "always use type specifier"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/84fd24b1be99760eab08c2c5fca9d9b9dd9c56e0", "message": "Merge pull request #1618 from h2o/kazuho/docker-enter\n\nadd utility commands for docker-based CI"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6fa976a255d902706a5406f9e97e20610c7aea18", "message": "update docs"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/7c9dabd3009a4a27278f9511d4ea89866e49506e", "message": "add utility commands for docker-based CI"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/d883788b612aa21f887aa5c5174fa893334c51ac", "message": "remove function no longer being used"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6b0a76efa3a8666a71ea5588cd90371c33400745", "message": "release memory in destroy"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/05e8a6831593dda756b80557bd57a3f3a20dc037", "message": "Merge pull request #1607\n\nintegrate document build process into CMake"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/7714977377b83769b9cfb650b7583fca85d6a999", "message": "Merge pull request #1614 from zlm2012/docker-ci-opt\n\nDocker CI Optimizations"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/fe1cf76768af25c519e1b9352187bf7666ae790d", "message": "update Changes"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/3083ba709c3b9200c050c012a2e23c11a4bfbcb5", "message": "Merge branch 'kazuho/tls13-replay'"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/7f23b3d610e921460fba1e9bd300ad2f585b530c", "message": "lib-examples-evloop can always be built now that openssl is a mandatory dependency (amends #1546 #1589)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ca432efd1806a9ec08f544803ff425eb917ce012", "message": "Merge pull request #1605\n\nalignment-aware memory allocation"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/13ecf4ca79fa2f9ccb71e30ae7db048abb1aa746", "message": "Merge pull request #1589 from chenbd/libh2o-websocket-libh2o-evloop\n\n\"examples/libh2o/websocket.c\" built support without libuv"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0c4324f06ec0c6c2fd04745658c3f446b32b0aed", "message": "macro for calculating the alignment can be function-local"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/9fb46c1d30b0dfc55526a2d03e1efbc4a3346593", "message": "we do not enforce (or check) that `sizeof T` is a multiple of `alignof T` elsewhere (consider `h2o_mem_alloc_pool`)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/8b9c6cb200f5b7bcf0ed1fb84b4c14d3320f499f", "message": "`chunk_offset` is an index of `bytes`, hence apply sizeof against `bytes`"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ae8bc1ac7bb04e9bfcca836cdb2ac4873d2b98fc", "message": "assert that the alignment is power of 2"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/8b7b1fb8205d08b626f675eb58045c247183a5cf", "message": "move alignof to top"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/89f665b05cdc2c01aaefea713e26d4ac852055ae", "message": "Merge pull request #1600 from h2o/kazuho/constify-write-vec\n\navoid copying vec when calling writev(2)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/d721f950698d369c388894a5ccedfe7924bbcd7e", "message": "integrate document build process into CMake"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/db338e11140e2d2b39693b71eda52e5d1edf3b17", "message": "test the case where h2 handler receives 425 after seeing ClientFinished"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/5965d3ac4a26b0dd5ea87f56dcc8f485b20aa655", "message": "close generator before replaying; otherwise a handler that does not close the stream on its first invocation of `h2o_send` (e.g., fastcgi) will fail on its second call to `h2o_start_response`"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/5e56d758f98076c09d93fca7e657af4f61b5d632", "message": "add h2 tests"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/33c72425d835e772438aeaab98b43acef6390dbd", "message": "yet another type issue"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/5ae2567189a2c76967cb2ae461b744c0af9b6c07", "message": "fix type https://twitter.com/n0kada/status/952741395554484224"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/5ea077fa168e73ca658d0ccc60f06c60eb97e3af", "message": "add missing parens"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/e06918d1c9f9c2585186b49f51368b72b3ffdf34", "message": "refine the doc-comment"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/32720d1840a2962b7fb64bec47f81958e4b56cdf", "message": "`:s` suffix to assert scalar type"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/fa628f83c7b80ef0fe69b801f4574bb986ab8416", "message": "use parse_mappings"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a0ebe35234bdc740dd1a4d1652ecfdf8ddee3a90", "message": "handle `owner`, `permission`"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/e9a9353dde554e43f088ac4fc0f966f920e495a5", "message": "use parse_mappings"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/522cc3bc810dff3fdf598e085cc9b337a94a5306", "message": "use parse_mappings"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/f5e7cb3af45c7bb980522709358c0b52f803ac35", "message": "use parse_mappings"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/94096af12043925cce65c95820625c9607ad4e2e", "message": "use parse_mappings"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ac396c868380b500eba90e8fca6dd1d72677ab8d", "message": "use parse_mappings"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ee30d9101b5adbd0c2c1e3b3c06d956244f219e4", "message": "use parse_mappings"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ee4eb2d20b965397fca2dbfe2c4a61aa8c1f2656", "message": "use parse_mappings"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/02c7b1571af804801df6c25dfe4426fd168ff32e", "message": "use parse_mappings"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/2bb9c72e8cb9c2c05fc788ca46ad3970a6db333d", "message": "introduce utility function for extracting attributes"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/8584b6d8adb2c04f1c234afc3bfb8c37f8cee0a3", "message": "Merge pull request #1361\n\nMultiple load balancing strategies"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/71944163b78b21e168970a20401442d378b676fd", "message": "regen doc"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/2de09a2a84886f3ec089591def2c0a8fe0d89dc3", "message": "doc adjustments"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/19db65ec449135f80fb14317960790419c7fa855", "message": "use our malloc"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/e474320c3b808c2cd00ad57b2beccf18ba9acd3c", "message": "update comment to reflect the changes"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/8df132fc3479f60035061ddd93a7c3b2804b7312", "message": "should check the type"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/fb17f130aa982635d99af41a103f7c64e66dfc95", "message": "simplify"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/f1675acd050e99e6a10261e5a302eea5274d68e9", "message": "simplify"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/74d6ad2e2b2572d932461f2540830c8f353bf9e5", "message": "remove unused variable"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ecb971dd5f2c54011d268b91afaa374937cd04ed", "message": "check early"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/9cec7ca49e15120af7686c5f5e38c1a03271e581", "message": "remove redundant selection of the default; the logic exists in `h2o_socketpool_init_specific`"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/8412484728b740d6bafedaf4a61efdf77cd28692", "message": "refine the error message"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/4e738a0d0d2c317ae1c0c22ec0429d88a9c5d850", "message": "improve locality"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/bb1db8bba8fc5883b5d3b6e00ec6f4d1fdfa5901", "message": "improve locality"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/9ee79bbdc7faf4432f8712672457329c4a799e47", "message": "rename for consistency"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/b08139725ce5839564dff5ed7dcb0a28c6ef4969", "message": "report error when facing an unknown property"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/7cf7fac48c82d4465a6176c2052759f48bb049b1", "message": "do not retain a pointer to a local variable of an inner block"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6030030267770bed20cf4c7265892e96ede01120", "message": "Merge pull request #1534 from zlm2012/fix-heap-use-after-free\n\nfix heap-use-after-free when upstream response stops unexpectly"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/edaa84c61d25be3aadda1b6d528629995cf764e6", "message": "add tests for (fcgi/mruby) vs. http1"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/7faa2ee6100c0de727b1e40aa05422460a6f801e", "message": "add test for h1"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a499f599f569e38fdd050cefc96dad6fe484f350", "message": "build picotls-cli for TLS 1.3 testing"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/48277d159151e70d222e5281398fc7a930a2ec0c", "message": "link picotest so that picotls can be built"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/f59cafab6d76867582ade0a8af72f48265c5da2c", "message": "Merge branch 'master' into kazuho/tls13-replay"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/fac62dbffec5a1249c5d6d0f420fa5e98ed4e805", "message": "Merge pull request #1590\n\nqueue 4 chunks for wslay's send_callback(), and merged with one h2o_socket_write() call"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/feab55f950eaaf9c88a496909d527b5fe4262c48", "message": "reuse the logic for disposal"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/4af08392cefefd2325ed52dfaa840d4df12c7df0", "message": "Merge pull request #1602 from h2o/kazuho/issues/1595\n\nenable ECDH in the example server"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0f6f995be908253b646562c9f5fb661836f44fc7", "message": "fix corrupt output (amends #1546)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/b83b30e5f2c9fc929889f79c060527359a3b9aa4", "message": "add \"\\n\" to the error (as well as the ciphers being supplied)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ee0cf6a6bb0fd81db8ff6d35141be6d8be92fa55", "message": "Merge pull request #1546 from h2o/kazuho/unbundle-libressl\n\nunbundle libressl"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/9983284521a1406d7acfac17ed948fab227e4834", "message": "fix fuzzer build error"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/d45cd2ca7d606b54fb769de98d19969a71a774df", "message": "let the name indicate that the value is subtracted by one (otherwise we would wonder how _weight_ is being defined (i.e, is `H2O_SOCKETPOOL_TARGET_MAX_WEIGHT` pre-subtracted value?)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/031db7571f44d0293850116489c23655792c68b5", "message": "fix compiler and C conformance issues"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/be8ee99800764c7603e92283d4c903b8f622155e", "message": "add files to xcodeproj"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/42387187c5ee7655d9fc37b992c8af8e984b7fcc", "message": "adjust doc-comment to clarify the differences"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/dd88f55124861d4e831bfee5fc102d9b850e8fae", "message": "revert changes that make the value of `pool->_shared.count` errorneous (the value is inceremented in `h2o_socketpool_connect` and decremented when the application is notified of a connection failure"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/17f382d55f72fa6a1e901cf616f8d07834c0a876", "message": "clang-format"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/b2987580e8e584422e7a6775ea923d6aac436c7a", "message": "be consistent in the way referring to a value"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0d52e38b6e54ba8a08cc5d03ea1b1e71bb4b5b24", "message": "revert addition of an unused variable"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/d2aebef3116413a473cac61dafa95ade8ed08e3d", "message": "get rid of struct initialization without any member (i.e. `{}`) which is a violation of C99, as well as avoiding copy of h2o_vector"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/507f82db15670b91dfeca47d8cd4722870c1abdc", "message": "change type of tried from `int []` to `char []` (ideally they should be a bit array"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/26be4bf42e7a6a729ba34a3a1f27950d3ec6ebed", "message": "some doc-comment"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/188a2c965221a32ad9f5731049cd459dc9958279", "message": "merge add_target into `h2o_socketpool_connect` now that the logic is specific to the global pool"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/af3ee7be66f37a9b6fd280e7f7949b0d540fac92", "message": "function names should follow the convention: `h2o_<module_name>_verb_...`"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/8caa8bf8c6f98c4a31cf0741c4e225a2ed75c8e6", "message": "add balancer source files to `server`"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/837290890953a00c59766c67b2e4df6a23b414cc", "message": "to minimize the changes, revert the order of the function declaration to the original"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/b98157df1dd0693052ed6441330acf5094ddad07", "message": "avoid copying vec when calling writev(2)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/bd50b46263b8dfa05be7a31f08b53de8d1228937", "message": "s/either//"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/bdf7de3a8c1b9daac3aba4209b8d276c4f127c0f", "message": "set `-ldl`, otherwise linking agaist a static version of libcrypto would fail"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a10449c0ec2061673885b081adba0614c185164f", "message": "remove libressl files"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a2da6caf9b6b829eb88048ddd372321450d9ce34", "message": "drop bundled_ssl support from cmake; on macOS use /usr/local/opt/openssl as the default OPENSSL_ROOT_DIR"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0cbb91b63e931e26f26cd8b11618ce823dba0a75", "message": "Merge pull request #1599 from h2o/kazuho/http2/entire-payload-for-flow-control\n\nEntire DATA frame payload is included in flow control"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/d084c99d557b5457a9a40f1ff2c9d706492d8ae0", "message": "clang-format"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/b77738f4681be0b72b58c1292cbb7b99ab9493f1", "message": "The entire DATA frame payload is included in flow control, including the Pad Length and Padding fields if present. (RFC 7540 section 6.1)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/9a18f4ef251164364b853ab176f55ddc6623a2a4", "message": "Merge pull request #1598 from h2o/kazuho/http2/fix-streaming-request-stall\n\nnever enable idle-timeout when the server is blocking the request"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6b992590d57a562833b1de71177e0dd04dabe3d3", "message": "fix assertion failure when receiving more data than advertised"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/27ae6dfc74268bf37d884f19270ab99b27025b67", "message": "expect GOAWAY for a open stream with the server-side timeout smaller than the client-side value"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ef2b0a5f819cd5ec14dec3ed3ccea77556d67126", "message": "add to xcodeproj"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/c1c25fb2e23f3f5735cd7cfd241d23224cb71ecf", "message": "do not pass zero-sized input to handler"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/497735d4faf5366683942eb64709f049b6aa635f", "message": "Merge pull request #1596 from chenbd/filename_max\n\nreplace \"FILENAME_MAX\" with \"H2O_TMP_FILE_TEMPLATE_MAX\""}, {"url": "https://api.github.com/repos/h2o/h2o/commits/4b45897af21019024389c067a4598edbfafa8cbe", "message": "increase stream-level input window to for non-streaming requests as well"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/9e39d7883606d50d5c3376f099062ebd84f8038c", "message": "no need for \"initailize\", since it is the only connection-level value"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/47c2c97d45ab6908efd6ed9356610e21b9afb301", "message": "remember `bytes_unnotified` for input stream window to send WINDOW_UPDATE at the right moment"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0c19e21d5e176bc25bcd4c76f59e2d0fadc6cb4d", "message": "nghttp2 will always negotiate"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/482064480150a596a414cb85da065507f94ec90d", "message": "more chance of seeing failures"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/175352a52640c0267c59eb882de3043f3af937d7", "message": "Merge pull request #1593: describe the format of the ticket key file"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/7fac8c76f9af9fdb5961242fba18ed6b78bd82a2", "message": "describe the format of the ticket key file"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/d6571e6b2b32139132450a9fe3b689d6071853a4", "message": "Merge pull request #1524: !env support in config"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/d9192a3c7e2f6cb5244d48550b648eab5f6f933f", "message": "[doc] adjust the syntax error as well as minor clarification"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/fc4d78cdb6abfbf4f364a45521a473e150fe6861", "message": "add test"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6078fddd54c76b1d9f73e385249aa7c0112ce405", "message": "reset tag"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/707d2387a7074723331d8d9010d1ed1e815f398c", "message": "Merge pull request #1528 with tweaks"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/f274c2be4eae3bd6ee77a41a8bfb002810476975", "message": "adjust the text"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a1cae482a1c89677045f56bc4d68f2f6ab8426d9", "message": "Merge pull request #1568 from chenbd/tcp_nodelay_to_listening_socket\n\nomit setting TCP_NODELAY flag for a socket that inherits the property from an accepting socket"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/c9d8f069586ba6598ae015e2f9e92a5c5c665138", "message": "Merge pull request #1556 from h2o/i110/process-existing-streams-after-goaway\n\nprocess existing streams after goaway"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/c42dde93fa9eded4870b71c807ace8fae71f5686", "message": "use lower-case hostnames (as specified in misc/docker-ci/check.mk) since the name resolution is case-sensitive; see https://github.com/moby/moby/issues/21169"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/10907347485063b48f1c2ab352f7f267de0a999b", "message": "Merge pull request #1587 from h2o/kazuho/amend-1582\n\nDon't call the proceed callback for a stream that has already sent a closing send-state"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/8a014dfa183eb10eee57438c2792b7e4b8da766e", "message": "should not \"proceed\" when the socket is in send_body_is_final state (means that we still have pending data)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0895bfd9a64ec6bb4a684c0ca5724a4791c621fc", "message": "Merge pull request #1583 from h2o/kazuho/fix-test-stall-when-h2get-is-missing\n\nfix test stall when h2get is missing"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/d1bd916a24edd03b037df9ab2ee5e13f45673530", "message": "bail out if h2get is missing before spawning `nc`; otherwise `nc` will run forever"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/d55d9969183d8d5a5b9f1370f0958ef9a3d8fbda", "message": "add files to xcodeproj"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/511be9d3dd6387d87889e0612b4cc0201ec6812c", "message": "Merge pull request #1582 from h2o/kazuho/h2-negative-window\n\ncorrectly handle window size becoming negative"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/e03772a9567ae5fb3a656b7ca50e815fc57790e4", "message": "allow `h2o_http2_scheduler_activate` to be called when it is already active; we already allow misfiring the proceed callback when the window is zero-sized"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/298a500282c2c27880a0320bccdcdbc99331ab90", "message": "correctly handle window size becoming negative"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/2f6ac8ed1532918c390608d461e4d4b4e4b6dd48", "message": "Merge pull request #1580 from h2o/kazuho/h2spec\n\nrun h2spec as part of  CI"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/c767ae5439b9f602fb819748f23cc19f8b72bf0c", "message": "capture output of h2spec so that prove does not get confused"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/5e3513cb503de8dd37921d43084abfb7425b6cbc", "message": "Merge pull request #1576 from h2o/kazuho/fix-crash-when-status-code-is-not-a-number\n\nfix crash when the status code is not a number"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/238dac9b406aa652ad4c2b57f775c7bca7650bab", "message": "update xcodeproj"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/d68f0c0aa876d4415e9cb435dec086246b40f0c9", "message": "add test"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/bd08544a5824f4afbd79aff389baba9252ca7f10", "message": "install h2spec to docker image"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/bea9a943e1e89716222f7a529a931806165611eb", "message": "test should cover none,nil,invalid"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/c28f63caf199a1850ab58d57eaeac22e646b154a", "message": "add test"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/9567dc13520e5aef33b4f83405599d4d52e93a56", "message": "Merge branch 'master' into kazuho/fix-crash-when-status-code-is-not-a-number"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/2dac681e4018150d0336213d6d5e32be2e13ab2a", "message": "Merge pull request #1579 from h2o/kazuho/http2/ignore-reserved-bit-of-frame-header\n\nignore reserved bit of the frame header"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/3d12d7f7ffad86c6d308c6a725ff87497c55161f", "message": "regen doc"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/2222d4a96c719338dd14652e6a4fccf380e69ceb", "message": "Merge pull request #1577 from h2o/kazuho/amend-pr-1559\n\namend #1559"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/4e3a40357f12bc98c1b8fb719c8f11b40f058815", "message": "the reserved bit of the frame header MUST be ignored"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/abcfb88f2c66a007b0cfa746de04479afcac2898", "message": "should compare against MAX_CONCURRENT_STREAMS"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/c5761def20ec7ba9edf315addd827047e89602db", "message": "for simplicity, only allow h2o to increase the window size as well as set max to the size of the connection-level window"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/eb9eb2e4e10084bfaaec475a8abb1083a3ce38e8", "message": "add doc"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/4db98c9f071106549d1659afeb5188605dd8e0b6", "message": "for better clarification rename the directive"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/88522846208b42220f6c6113f8ac1b9e80c6d9ee", "message": "Merge pull request #1574 from h2o/kazuho/fiber-switch-in-constructor\n\nallow fiber switch in constructor"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/c627527778f2dc1a9d37148896211c3228da83d9", "message": "server should not crash when the first element of a rack repsonse is not a number"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ffd9e79d8b6c8703ed60e9931d71d9052ff0adb3", "message": "Merge pull request #1559 from h2o/kazuho/bigger-receive-window\n\nfaster request body streaming"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/46eee249e3323b8fa5b1c3b164becac6c7e51826", "message": "extract https://github.com/kazuho/mruby-class-new-fiber-safe @ b1b811a () at deps/mruby-class-new-fiber-safe"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/bc486fe4b58676f4241b19c54f57fb1332f6fbae", "message": "add failing test"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/f3c02f476c3f393e28850f96d4f906d2b28be829", "message": "Merge branch 'master' into kazuho/bigger-receive-window"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ada699223969e84f25095a85f77e4a8c51f6b919", "message": "add missing file to xcodeproj"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/9e4e5ff3e2093e72b21b7a7fc7edd45ca571c15e", "message": "add test"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a7379f7bdb597409f5f44af67905cfb09cc4f953", "message": "Merge pull request #1573 from h2o/kazuho/issues/no-handler-vs-h2-post\n\nfix crash when trying to dispatch request body against `/` with no handler"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/8eda4f1d7786b2476d76935cc56be4910f850800", "message": "number of handlers can be zero"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/b424b34d050cbde9405e0691b2ac9a55ac37d8fc", "message": "add failing test"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/c14e44308bfcd0c095232f6e5fc8f976ff5a7d6c", "message": "Merge pull request #1569 from chenbd/remove-unused-fcntl\n\nremove duplicate fcntl with O_NONBLOCK call"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0dd96321f16c99ad1fc85a128910922c25be759d", "message": "Merge pull request #1570 from chenbd/SERVER_STARTER_PORT_to_macro\n\nmove \"SERVER_STARTER_PORT\" to macro \"SERVER_STARTER_ENV_NAME\""}, {"url": "https://api.github.com/repos/h2o/h2o/commits/fe5f7c8bf13209cbbfed417d4388b9726225e3ce", "message": "Merge pull request #1562 from h2o/i110/mruby-http-request-timeout-error\n\nclient-warning header for mruby's http_request method"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0f46059949b27ed77e55d8660bf9c710af54dcc3", "message": "supply the active stream-level window size as a configuration parameter"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/b27fc134e4960fe6cdf718ed5c78d0cbef8ae938", "message": "Merge pull request #1555 from h2o/i110/stop-opening-new-push-streams-after-goaway\n\nstop opening new push streams after received GOAWAY frame"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0e7e9814c70efd73e7ed020cf8072e14d68f9989", "message": "Merge pull request #1561 from h2o/i110/send-headers-immediately\n\nsend headers immediately vol.2"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6efd9d30cf28764964eda3879bde98396f50e8e5", "message": "Merge pull request #1564 from h2o/kazuho/libyaml-0.1.7\n\nUpdate libyaml to 0.1.7"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a8f22709bced040aa886d79407fab3e207f197b9", "message": "reapply 00f8c79"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/f161cdb4d13acece84fbfab27a1d1b388d3e26b5", "message": "redo 2af64cb"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/16dfa0660a3da70d9a3618c4a5fefc49640eaf02", "message": "import http://pyyaml.org/download/libyaml/yaml-0.1.7.tar.gz (sha: f6eeefdda42bfc9d5a817dc728d5fbcf41cff1d8)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/bfbdd0463f651a881510ca98252dbff193c2bd15", "message": "Merge pull request #1563 from h2o/kazuho/issues/1560\n\ndon't add trailing slash to upstream request"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/427d747a05c3271a3557fcbecacbd6071a1f7442", "message": "add some tests"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/c9c742d05082e7f8c2a20e32061598df68cdf600", "message": "allow `req->path` to be an empty string while connecting to upstream"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/fb2f00acb84317945b331527ed1e877c4bb6f925", "message": "raise window size to 16MB for the streaming request stream"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/4c3f27efd0819664c918db3e79e81ef6f783998c", "message": "fix spurious test failure"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/5dfa511d0465b86e394fb9e47ffb5dbc8abe566c", "message": "retain the current size of the input window"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/c9367936e34f783798037ff5e7f58cfb4d57ccc9", "message": "set initial connection-level recieve window size to 16MB to reflect the fact that we are sending that as the SETTINGS property"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/034abee43845bb1c5003d7b7ddf9ca7795a762bd", "message": "use `-H`, `-B` to ignore CMakeCache.txt in the source directory (in case it exists) (amends #1551 #1553)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/de7bdc3e8a36546e0655cd01496c342f4659bf5f", "message": "it's meaningless to change /etc/hosts in image (amends #1551 #1553)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/e04026ac24bef725878b4d5bdf6900410e0f37e3", "message": "use `--add-host` for 127.0.0.1.xip.io (amends #1551 #1553)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/7c477a6230c25010ab892585ead1ff55d05559c0", "message": "Merge pull request #1553 from h2o/kazuho/docker-ci-simplify\n\n[CI] mount source directory from container"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/994dfa59f96e554e4a3bbdca630a6c4b0fa1934b", "message": "rename the CI enviroment build script"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6bbb12b6fdcd1c8549753f73853595c76029727f", "message": "remove Dockerfile for building the image with source"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/1901197705e8f9825259213287f1468c02d7a7b6", "message": "corpus is under source directory"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/fcb4f9d2da521ae651da1bf449ec6c69c7ac0386", "message": "allow write to source directory to update version.h"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/71fc6d601191ec286fb902cee7eaf7f91f663c79", "message": "mount the source directory instead of building a new container"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6db7033a5d57b23ddaa4f6daa0debad2e97f1063", "message": "Merge pull request #1551 from h2o/kazuho/docker-ci\n\nCI using docker"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/280a120e86663422b809e57770d188e167d50fc4", "message": "wait until the log gets emitted"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/7f476faf3ac8f5547fe34757aa883bd6b4676cb0", "message": "install certain modules from CPAN"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/669b1ef16e6bef0e4b8464e7df8f76680164281d", "message": "add 127.0.0.1.xip.io to /etc/hosts"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ab3bc6360e3c6ced89deb2cd96caf9bab44549a3", "message": "server should bind to the same address as `empty_port` queried"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/75de7504cd7107439f18dd4202f9fb6ab82b1b18", "message": "minimize .dockerignore"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6a430e1340e7820a85bf4f62969314f89c31370b", "message": "add dockerfile used for building kazuho/h2o-ci"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/7dbc457404196e5489fb3fb119e4a70f4c1b4bc3", "message": "bootstrap from public image"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/c08a2d8cf5b10dcb921d1b1eb933c8fb00745a49", "message": "add fuzz"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/316b2282d713e25876d0b050b88815311780ceb7", "message": "eliminate cache (for the time being)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6bc5b4c9c7a94f140103568ccce2cd9712d4c9f3", "message": "simplify"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/f0755e0a13a738ea45970663108895c46e96d04c", "message": "wait until the server dies"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a84d30bd78ce3918ac265cc1af8c6d121579c616", "message": "always save the cache"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/baafbf02a57ad93558ed33c8a4c8334a00cd6a53", "message": "use openbsd version of netcat"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a7e5673ec905b5fdc99e94d4dd7c6063a72845ee", "message": "simplify"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/e2d2cb3bfa12522c577a479d9062c7dcab3ba833", "message": "revert to listening to global port"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/bf81d298175ccb16b74d94fce62f1e2805a3651f", "message": "cache base image"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/837e9362f686111da52607d5f48ef317063e2994", "message": "split docker images for cacheability"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/d145c779383cf2c5e6c41f8695d7b272b12c44c2", "message": "suppress bogus warnings on travis"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0f6791cc8cbaa58c81fe40f634fbd6987c238d78", "message": "test docker-based ci"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/626d554327948b51cc83342201b2c94ebc873487", "message": "fix race issues"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6c339077e27d7fa380ee6f5396fe601b482fffdc", "message": "add wait"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/8fcec01e1f6bcf208cd5040a565eed474f4513d8", "message": "more reliable way of running upstream"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/30ad2971c2afb8a8308046f47230dd2810f5a6ae", "message": "use Docker to run tests"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/04cfdc9b17515a4a805a3822f8aa869c724e9187", "message": "Merge pull request #1547 from h2o/i110/doc-directive-list\n\nadd directive lists in document"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/e0d3180de260abd1bab41d1edb46b468c1b02a58", "message": "Merge pull request #1548 from h2o/i110/doc-navigatable-selected-tab\n\nmake document's selected tab navigatable"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/cc1c9e0ebc0d02a972ea68753720cab1bfbc1379", "message": "send HTTP response after validating the request"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/16fbb607837d3bba86e7c1180835a463b438f0a7", "message": "Merge pull request #1545 from h2o/i110/fix-sock-bytes-written\n\ncount sock->bytes_written correctly"}], "pull_requests": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/865", "title": "[refactor] move URL rebase function to url.c", "body": "We might need this in future.\n", "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/813", "title": "enable backtrace logging on freebsd", "body": "For some time we log backtrace on Linux when receiving SEGV.  The code can be used on FreeBSD >= 10 since it has `backtrace_symbols_fd` as well as the addr2line command.\n\nrelates to #809\n", "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/613", "title": "add ServiceWorker support to cache-aware server-push", "body": "adds support for `cache-fingerprint-key` response header, and `cache-fingerprint` request header.\n", "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/330", "title": "Refactor how SSL_write is called", "body": "This PR makes couple of changes to how SSL_write is being called:\n- concatenates small iovecs before calling SSL_write\n  - results in faster operation and lesser overhead in bandwidth (since the number of TLS records gets reduced)\n  - HTTP/1 w. push generators will benefit from this change (see how the chunked encoder builds the iovecs)\n- does not emit log if SSL_write returns an error (final fix for #297)\n  - see comment on 3666bbd for the reasons behind this change; the protocol implementation that is doing this is the HTTP/2 impl.\n- changes the max. payload size of a TLS record from 1400 to 1376\n  - 1376 has been chosen since it is the largest value multiple of 32 below 1400\n  - AVX registers are 256-bits (32-bytes) long and we would expect memcpy / TLS encryption operations to use aligned access to the data\n  - raising the value to 1408 (smallest multiple of 32 above 1408) since in such case the TLS record size might become somewhere above 1440 depending on the cipher-suite being used; it would become too near to the MSS\n", "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/138", "title": "introduce shared-memory cache", "body": "This PR implements a tiny in-memory cache, suitable for caching open files etc.\n\nIt has so far been not merged to master as there has been no practical use case.  However this might be desirable if we are to let users define server-push URL mapping files for statically served content using the file handler (#137).\n", "author_association": "OWNER"}], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54407780", "body": ":+1:\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54407780/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54615996", "body": "\u3042\u3056\u3059\u3002pr\u307e\u3060\u898b\u3066\u307e\u305b\u3093\u304c\u3001htdocs/index.html\u304c\u5b58\u5728\u3059\u308b\u3088\u3046\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u52d5\u304b\u305b\u3070keep-alive\u304c\u52b9\u304f\u3068\u601d\u3044\u307e\u3059\u3002\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54615996/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54695930", "body": "WIN32\u306e\u5834\u5408\u306f`h2o_buf_t`\u306e\u30e1\u30f3\u30d0\u306e\u5b9a\u7fa9\u9806\u3092\u9006\u306b\u3057\u3066 `WSABUF` \u3068\u7b49\u3057\u304f\u3059\u308b\u3053\u3068\u3067\u3001`writev`\u3092\u518d\u5b9f\u88c5\u3059\u308b\u306e\u3067\u306f\u306a\u304f`WSASend`\u3092\u4f7f\u3063\u3066\u4e00\u767a\u3067\u66f8\u304f\u3088\u3046\u306b\u3059\u308b\u3068\u3044\u3046\u306e\u306f\u4e0d\u53ef\u80fd\u3067\u3057\u3087\u3046\u304b\uff1f\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54695930/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54768769", "body": "\u306a\u308b\u307b\u3069\u3067\u3059\u3002\u3067\u3042\u308c\u3070 h2o_buf_t \u306f\u73fe\u72b6\u306e\u307e\u307e\u3067\u826f\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u4e00\u65b9\u3067\u3001Win32\u5b9f\u88c5\u306e\u4e2d\u3067\u306fWSASend\u3092\u4f7f\u3046\u3088\u3046\u306b\u3059\u3079\u304d\u304b\u3068\u601d\u3044\u307e\u3059\uff08\u3053\u308c\u306fh2o\u306e\uff08\u7279\u306bHTTP2\u5b9f\u88c5\u3067\u306f\uff09\u591a\u6570\u306e\u5c0f\u3055\u306a\u30c1\u30e3\u30f3\u30af\u3092writev\u3092\u901a\u3057\u3066\uff11\u56de\u3067\u66f8\u304d\u8fbc\u3080\u3053\u3068\u3067\u901f\u5ea6\u3092\u7a3c\u3044\u3067\u3044\u308b\u304b\u3089\u3067\u3059\uff09\u3002\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54768769/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54774811", "body": "\u7834\u58ca\u3057\u306a\u304c\u3089\u30b9\u30ef\u30c3\u30d7\u3057\u3061\u3083\u3063\u3066\u3082\u3044\u3044\u30ab\u30e2\uff01\uff01\uff01\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54774811/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/55718437", "body": ":+1:\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/55718437/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/55721133", "body": ":+1: thank you for the fix!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/55721133/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/55847417", "body": "Thank you for reporting the issue.  Couple of problems were found as well: feec03b df0ef9e.\n\nPS. and thank you for writing nghttp.  It helps me understand and test HTTP/2 very much.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/55847417/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56078717", "body": ":+1:\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56078717/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56132514", "body": "almost complete, the leftover is to automatically detecting the number of cores\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56132514/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56253768", "body": "closing the PR since I cannot see any commits that aren't yet been merged to master.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56253768/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56256225", "body": "Please install libyaml as stated in README.md (on osx it is avaiable as a [homebrew](http://brew.sh/) package as well).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56256225/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56256710", "body": ":+1:\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56256710/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56266931", "body": ":+1: \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56266931/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56280676", "body": "@ipeychev Thank you for reporting the issue.  Changed the URL of a submodule of yoml (which is in turn a submodule of H2O).  Running the following commands will fix your problem.\n\n```\n$ git pull --rebase origin master\n$ git submodule update --init --recursive\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56280676/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56280815", "body": "@swinghu Did you run [cmake](http://www.cmake.org/)?  You would need it to generate an appropriate Makefile (or a Visual Studio Project or whatever).\n\nAnd there will likely be other problems as well if you try to build H2O on Windows.\n1. some of the `#include`s should be changed\n2. pthread-related and socket-related functions need be tweaked\n3. libraries need to be installed at a location that can be searched by CMake\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56280815/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56323752", "body": "Thank you for your comment.\n\nIMO writing papers do not _prove_ the performance.  Only benchmarks can _prove_ it.  And I am not interested in writing papers.  If you are interested in the differences between the implementations, how about taking benchmarks, profiles etc.  I would appreciate it if you could share the results.\n\nPS. That said, https://news.ycombinator.com/item?id=8342684 might be an answer.  There might be other reasons as well, but I am not interested in analyzing the differences.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56323752/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56347484", "body": "@wangbin579 Thank you for the suggestion.\n\nI have updated the benchmark numbers to reflect the performance of the newest version of H2O, and nginx with tcp_nopush being set.\n\n> BTW\uff0cwe found nginx outperforms h2o significantly when using webbench.\n\nThank you for taking the benchmark.  I have noticed that H2O was not setting TCP_NDELAY and have updated the code just a couple of minutes ago in commit eef1612.\n\nIt would be great if you could take the benchmark again and check if the issue persists.  If it does, it would be great if you could provide the parameters of the benchmark you are running.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56347484/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56350220", "body": "@xiangzhai Did you ever take a look at the link I provided in https://github.com/kazuho/h2o/issues/14#issuecomment-56323752 ?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56350220/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56351712", "body": "@wangbin579 Thank you for the log.  It is likely that the concurrency you use for the benchmark (= 10) is too small.  It depends on the performance of the benchmark PC, but I expect both nginx and h2o to perform faster than (960826 pages/min = 16014 pages/sec) if benchmarked correctly.\n\nWould you mind change `-c` to 100 or so and try again?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56351712/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56356081", "body": "@wangbin579 \n\n> We also notice that nginx consumes more cpu resources(vmstat's us) than h2o\n\nThat means that it is highly likely that your benchmark is failing to give enough load to the httpd.  In order to take a correct benchmark, both nginx and H2O should use the same CPU resouces (since the benchmark is running the servers on a single core, they should ideally consume 100% of the single core).\n\nThere are couple of ways to achieve such goal.\n\nOne way is to pin webbench to a single core (it is a preforking benchmark tool and that means that unless being pinned, it would scramble to allocate CPU resources against the server which is being benchmarked).\n\nBut I would suggest switching to another benchmark tool, since using a preforking client is likely too heavy for benchmarking event-driven HTTP servers like nginx or H2O.\n\nPS. I have tried running `taskset 1 webbench -c 100 -t 15` on my testbed (taskset is the linux command to pin the processes to a single CPU core) but with such confirugration neither nignx nor H2O utilized 100% of the CPU core.  That means that you would at least assign more than two CPU cores for webbench when you are going to benchmark nginx or H2O running on a single CPU core.\n\nPS2. I had to assign three CPU cores to webbench to not let the http servers idle.  And the results for serving 6-byte content on my testbed were as follows.  I hope you can reproduce similar results.\n\n```\n# H2O\n$ taskset 7 ./webbench -c 100 -t 15 http://127.0.0.1:7890/\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\n\nBenchmarking: GET http://127.0.0.1:7890/\n100 clients, running 15 sec.\n\nSpeed=1820880 pages/min, 6312384 bytes/sec.\nRequests: 455220 susceed, 0 failed.\n\n# nginx\n$ taskset 7 ./webbench -c 100 -t 15 http://127.0.0.1:8080/\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\n\nBenchmarking: GET http://127.0.0.1:8080/\n100 clients, running 15 sec.\n\nSpeed=1300524 pages/min, 5072043 bytes/sec.\nRequests: 325131 susceed, 0 failed.\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56356081/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56489384", "body": "@wangbin579 \n\n> It should be noted that webbench uses short-lived connections while wrk uses long-lived connections.\n> When using wrk to stress nginx and h2o, we get the following results: \n\nAh!  Thank you for mentioning that!\n\nI hadn't noticed that webbench was not using persistent connections.  H2O's way of calling of `accept(2)` is very primitive (one call to `accept(2)` per one event loop) and that explains why it's not performing as well as nginx when using webbench.\n\n> BTW, in my opinion benchmarks can prove nothing to the engineers sometimes and production workload based comparison is more useful.\n\nI totally agree that production workload-based comparison is more useful, although I would like to point out the fact that the types of HTTP requests that matters for an ordinary HTTP server in terms of performance are `GET` requests against small-to-medium-sized asset files over persistent connections since those are the ones that consist most of the requests sent to a typical web server.\n\nThank you anyways for your help in improving the benchmark and for analyzing the characteristics of the benchmarks.  I really appreciate it.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56489384/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56587699", "body": "@xiangzhai Your analysis is totally incorrect.\n\nI suggest you once again to actually perform dynamic analysis (e.g. profile the code) instead of trying to persuade somebody with your static analysis.  The number of mistakes you have made in analyzing picohttpparser is a clear sign that your approach is failing.  I cannot expect a correct analysis on nginx or H2O from the same approach that caused so many mistakes in analyzing picohttpparser (which is < 1,000 LOC).\n\nI expect to see more productive comments from you in the future.\n\nFYI, below are some of the mistakes found in your analysis.\n\n> the phr_parse_request's time complexity shown as below:\n> 1 is_complete O(n) to check whether nor not buf_start == buf_end\n\nWrong. is_complete is never called in most of the cases since HTTP requests typically arrive as a single packet.  The fact would have been clear if you had applied dynamic analysis, or had considered the meaning of the comment right before the call to the function.\n\n> 2 ADVANCE_TOKEN O(n) is it really better than strtok? called TWICE by parse_request\n\nYou should never ever apply a function that take a C string as the argument against a chunk of data that is not terminated.  This is one of the very basic thing in secure C coding.\n\n> 4 parse_headers O(n^2)\n> 5 get_token_to_eol O(n^2) called by parse_headers\n\nWrong.  They are O(N) under the assumption that N is the length of the request (generally speaking, you should better clarify what N is before using the O() notation).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56587699/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56617214", "body": "@xiangzhai \n\n> please patched the time-complexity-test.patch https://github.com/xiangzhai/picohttpparser/blob/master/time-complexity-test.patch to check out the time elpased called your HTTP parser about request stuff 10K times.\n\nWhat are you trying to compare with the benchmark?  If you think that picohttpparser is O(N^2) against the length of the HTTP input, then you should compare the times consumed for different lengths of inputs.  Parsing a single request 10,240 times does not mean anything.\n\n> I hold the view that your HTTP parser is O(n^2) just like VERY BASIC one http://leetcode.com/2011/11/longest-palindromic-substring-part-i.html NOT black art O(n) http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html\n\nDo you really think that the below function is O(N^2)?  It does have a nested loop, but it is clearly O(N).  If you cannot understand, you should really go back to your text book on computer science.\n\n```\nstatic const char* get_token_to_eol(const char* buf, const char* buf_end,\n                    const char** token, size_t* token_len,\n                    int* ret)\n{\n  const char* token_start = buf;\n\n  while (1) {\n    if (likely(buf_end - buf >= 16)) {\n      unsigned i;\n      for (i = 0; i < 16; i++, ++buf) {\n        if (unlikely((unsigned char)*buf <= '\\015')\n            && (*buf == '\\015' || *buf == '\\012')) {\n          goto EOL_FOUND;\n        }\n      }\n    } else {\n      for (; ; ++buf) {\n        CHECK_EOF();\n        if (unlikely((unsigned char)*buf <= '\\015')\n            && (*buf == '\\015' || *buf == '\\012')) {\n          goto EOL_FOUND;\n        }\n      }\n    }\n  }\n EOL_FOUND:\n  if (*buf == '\\015') {\n    ++buf;\n    EXPECT_CHAR('\\012');\n    *token_len = buf - 2 - token_start;\n  } else { /* should be: *buf == '\\012' */\n    *token_len = buf - token_start;\n    ++buf;\n  }\n  *token = token_start;\n\n  return buf;\n}\n```\n\n> YUP, it is the fastest algorithm if you developed NOTHING ;) https://github.com/xiangzhai/picohttpparser/blob/master/test_print.c\n\nThank you for your vandalism.  In my last comment, I said I expect you to provide more productive comments.  Should I better give up and ignore you?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56617214/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56619673", "body": "@xiangzhai \n\n> 1 I do not have time to write testcase of heavy pressure and boundary test for your copy/paste open source project.\n\nShould I take your comment \"copy/paste open source project\" as a personal insult?\n\n> 2 get_token_to_eol`s time complexity is O(n), my mistake, sorry\n\nIt is glad that you have acknowledged one of the mistakes you have made in the analysis.  As previously stated, there are other mistakes as well; I recommend you to look back all of your analysis.\n\n> 3 just ignore me ;) because I argue that your stuff is not better than Nginx\n\nThis place exists to discuss the problems and/or improvements related to H2O (and improvements to the benchmark on the README fit into the criteria).  But your comments do not seem to fit in.\nFrom now on, I will remove your comments without warning unless it is productive.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56619673/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56621363", "body": ":+1:\nThank you for noticing the issue.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56621363/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56621817", "body": "Should use sigaction(2) instead since H2O uses pthread when `num-threads` > 1.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56621817/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56626899", "body": "Keeping this work as a unmerged PR so that we could come back laterwards.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56626899/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56627755", "body": "Sorry, SSL support exists in the source code (and thus is available if H2O is used as a library) but there is no configuration directive for the server.\n\nPlease wait a while.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56627755/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56638733", "body": "Merged to master.  The benchmark numbers are:\n\n| Server \\ size of content | 6 bytes | 4,096 bytes |\n| --- | --: | --: |\n| nghttpd@a9b7426 | 65,725 | 34,121 |\n| trusterd@962d031 | 125,482 | 50,103 |\n| H2O@605a9ad | 202,781 | 95,964 |\n\nTaken using `h2load -c 100 -m 100 -n 2000000 http://`; note that H2O does not (yet) compress header using tables (which might have positive or negative impact on the benchmark).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56638733/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56742195", "body": "@razum2um \n\n> I read #15 and as far as I understand the problem shifted to discussing benchmark tool, I think it's wrong direction and I support @xiangzhai 's opinion that to be X times faster you need to do some notable improvements.\n\nMy understanding is that in #15 we have figured out the following points, and I think we are in the good direction.\n1. found that `tcp_nopush` was massing, and updated the benchmark\n2. confirmed that for persistent connections the updated benchmark is correct\n3. found that for non-persistent connections nginx is faster\n\nOTOH, I do agree that there should be some notable differences between the two since there is a certain amount of difference in performance when handling persistent connections (that send small responses).\n\n> I understand, that being modular slows nginx down, but I don't think that it's the main reason,\n\nAgreed.\n\n> Still, have you seen nginx's source and can you tell differences in implementation?\n\nI have suggested that the parser implementation is different.  I have not taken any benchmarks, but if you will understand at [https://github.com/nginx/nginx/blob/1176952193ccf47078dc84b8494d0496ad1ac4a2/src/http/ngx_http_parse.c#L855] and [https://github.com/kazuho/picohttpparser/blob/master/picohttpparser.c#L179] the approaches are different.  Nginx uses a state machine to parse the data; H2O uses a separate for loop for each state (note: lowercasing the header names are performed laterwards in H2O).\n\nGenerally speaking, H2O omits the use of state machines in favor of tight loops to fullfill the CPU pipeline / decrease the number of branch mispredictions.\n\nI cannot tell if this is the reason, but it _might_ be an explanation.\n\nUnfortunately I am not interested in analysing the details of the differences, but I hope this comment will be of some help to whom is interested in doing so.\n\nPS. Their would be other things to consider.  For example, the fact that nginx required nopush to be used seem to indicate that it is using multiple syscalls to send a single response, H2O uses writev(2) to send headers and data at once (and instead does not use sendfile, it uses read(2) to read file into memory).  Memory management strategies might be different as well... there will be many things to consider on table.  And that is why I suggest using a profile tool to analyse the differences.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56742195/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56781410", "body": "Memo: #23 introduced a callback that should be called when a connection gets closed.  Do not forget to call the function when SSL handshake fails.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56781410/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56781692", "body": "move the leftover to #24\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56781692/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56910958", "body": "Thank you for your interest and the suggestion.\n\nH2O does not expose a callback-based API so that it could be used with external event loops.  But it is possible to switch between event loops using `#ifdef`s.\n\nH2O already support two kind of event loops, libuv and evloop (which is a tiny event loop tailor-made for H2O).  So it might not be difficult to add a third backend.\n\nFYI, Binding for libuv can be found in the following files:\n- [include/uv-binding.h](https://github.com/kazuho/h2o/blob/master/include/h2o/uv-binding.h)\n- [lib/socket/uv-binding.c.h](https://github.com/kazuho/h2o/blob/master/lib/socket/uv-binding.c.h)\n\nBinding and the implementation for evloop can be found in the following files:\n- [include/evloop.h](https://github.com/kazuho/h2o/blob/master/include/h2o/evloop.h)\n- [lib/socket/evloop.c.h](https://github.com/kazuho/h2o/blob/master/lib/socket/evloop.c.h)\n- [lib/socket/evloop/*.c.h](https://github.com/kazuho/h2o/blob/master/lib/socket/evloop/)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56910958/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57100428", "body": "@Alir3z4 Great!  Thanks a lot.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57100428/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57100465", "body": "@swinghu Never mind.  They are spams.  Spamming users and spam issues get removed, but notifications are not.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57100465/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57101416", "body": "@tatsuhiro-t \nUnderstood.  Your HTTP2-related tools have been a great help for the development of H2O, and it is hard to say how grateful I feel (not to mention that part of your work is [copied into H2O](https://github.com/kazuho/h2o/blob/master/lib/http2/hpack_huffman_table.h)).\n\nThe scores of `example/tiny-nghttpd` were 146,506 reqs/sec (6 bytes) and 77,352 reqs/sec (4,096 bytes).  Haven't yet run trusterd.\n\nDo you want me to change the score listed in `README.md` from that of nghttpd to tiny-nghttpd?  Seems like we should better do so that people would not misunderstand the true performance of nghttpd.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57101416/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57198378", "body": "Thank you for the PR.\n- **I have cherry-picked some of your changes to master in 9c098f5**\n- _undeterminate_ has been changed to _indeterminate_ (which is the correct word)\n- I am preserving the use of _NUL_ for now, since the word implies that it is a character\n  - note: NUL is a word used to designate a _null character_ (source: http://en.wikipedia.org/wiki/Null_character)\n\nIf you find any other problems, please let us know.  Thank you in advance.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57198378/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57259085", "body": "@tatsuhiro-t \nUpdated README.md, and thank you for your help.\n\nnote: The score of trusterd has not been updated since the scores seem to have changed after upgrading the host OS of the benchmark machine from OS X 10.9.4 to 10.9.5.  Will need to find a better platform to run the benchmarks.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57259085/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57406533", "body": "@mingodad \nNo, [the configuration file](https://gist.github.com/kazuho/c9c12021567e3ab83809#file-gistfile1-txt-L11) has access log disabled.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57406533/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57406648", "body": "@mingodad \nNo.  As commented on https://github.com/kazuho/h2o/issues/14#issuecomment-57406533 both nginx and h2o are run with their access logs disabled.  The configuration file can be found on the link of the README.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57406648/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57409781", "body": "Thank you for the PR.\n- use of SSL is commented out in the examples so that people could test them more easily by using HTTP\n- thank you for noticing that the logger did not work if uncommented, it was a bug in the register function. fixed in e234421\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57409781/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57411530", "body": "> Also changing inexisting h2o_accept(&ctx, sock) by h2o_accept_ssl(&ctx, sock, ssl_ctx)\n\nThank you for noticing the issue.  Non-libuv implementation of the example was in fact outdated.  Fixed in 7953938.\n\nRegarding your test, with [this patch](https://gist.github.com/kazuho/449b62d35cedbc3ec7f7) applied to the updated master branch (at 3bdba08) I was successful in running `ab -k -n 1000 -c 5 https://127.0.0.1:7890/index.html`.\n\nNote that the following files should exist under the current working directory at where `examples-simple` is invoked.\n- server.crt (the SSL certificate in PEM format)\n- server.key (corresponding private key)\n- htdocs/index.html (the document to be fetched)\n\nWould you mind retrying?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57411530/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57412628", "body": "Thanks a lot for the PR!\n- 486f936 has been fixed the other way round in e234421\n- d6ab355 SSL and logging will not be enabled by default (see #34), the \"accept\" code has been fixed by in 7389898 (I should have seen this PR before figuring it out by myself)\n- eb32bc8 not necessary since static variables are zero-filled by default\n- 36536e7 the SSL part has been cherry-picked to master in 65aabb2\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57412628/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57466659", "body": "We will not do this, since AFAIK Apache does not (citation needed).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57466659/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58426273", "body": "What is the OS (or linux distro?) are you using?  Did you build libcrypto (which is part of OpenSSL) by yourself?\n\nIt seems like that on your environment libcrypto wants to link to libdl, so adding `dl` after `pthread` [at the last line of CMakeLists.txt](https://github.com/kazuho/h2o/blob/master/CMakeLists.txt#L73) might fix the problem.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58426273/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58475160", "body": "Mostly finished by the above commit.\n\nConfiguration directive `listen` has been introduced replacing `port`.  It is possible to setup HTTPS server by using the directive as show in the below example.\n\n```\nlisten:\n  port: 8081\n  host: 127.0.0.1\n  ssl:\n    certificate-file: examples/server.crt\n    key-file: examples/server.key\n```\n\nThe leftover is to properly implement multi-thread support in handling SSL (needs to define hooks as is done in http://openssl.6102.n7.nabble.com/When-to-use-CRYPTO-set-locking-callback-and-CRYPTO-set-id-callback-td7379.html).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58475160/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58619106", "body": "I am sorry but would you please explain what you did, what was the expected behavior, and what you saw so that I can try to reproduce?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58619106/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58619143", "body": "Your welcome!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58619143/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58771698", "body": "Thank you for the description.\n\nSo far I am been unable to reproduce the problem (I have tested running a small website using H2O, but all the information are rendered as they should be, e.g. HTML, CSS, and images were not corrupt).\n\nIs your web site accessible from anywhere?  If it is, I would like to fetch the content you are trying to publish using H2O and try myself.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58771698/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58772253", "body": "- session cache\n- load intermediary CA certs\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58772253/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58847732", "body": "- configurable list of ciphersuites\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58847732/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58848074", "body": "@ipeychev @desaxce \nIt seems true that there is some issue.  I have tried setting up a copy site of http2rulez.com using H2O and confirmed that (at least) Firefox Nightly has problem connecting to it via HTTP/2 (reports a SSL MAC error).\n\nRegarding the ciphersuites being supported, H2O does not provide any way to modify the list of ciphersuites from those enabled by OpenSSL by default (we should obviously add a way to configure the list; thank you for noticing it).  But in the case of http2rulez.com I do not think that is the cause of the problem.\n\nEDIT: The error also happens with HTTP/1.1 over SSL.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58848074/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58981710", "body": "note: H2O supports session resumption (OpenSSL by default uses a in-memory session cache).\nhttps://www.openssl.org/docs/ssl/SSL_CTX_set_session_cache_mode.html\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58981710/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/59115467", "body": "@chzhewl \nIn the commit above I have fixed a bug that seemingly relates to the issue.  It would be great if you could see if the problem still persists.\n\nEDIT: **Seems like I have failed to fix the issue.  Please ignore this comment.  Sorry for the fuss.**\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/59115467/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/59145847", "body": "@ipeychev \nWould you mind retrying?  I think I have fixed all the issues with commits up to 3de5b06.\n\nI can now access a copy site of http2rulez.com setup for my own using HTTP/2 (HTTPS) using Google Chrome Canary.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/59145847/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/59146349", "body": "@chzhewl \nI believe that the problem has been fixed with the commits above.  I would appreciate it if you could try and check.  Thank you in advance.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/59146349/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/59310525", "body": "Wow!  Thanks a lot!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/59310525/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/59310856", "body": "- server name indication\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/59310856/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/60322602", "body": "@chzhewl Glad to hear that the problem has been fixed. Thank you for spending your time on the issue!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/60322602/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61581659", "body": "My slides at http://blog.kazuhooku.com/2014/11/the-internals-h2o-or-how-to-write-fast.html covers new benchmark results (including access from remote), addresses some of the implementation differences bet. nginx (with the understanding that http-parser is a fork of nginx's HTTP parser).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61581659/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61706891", "body": ":+1:\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61706891/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61707701", "body": ":+1:\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61707701/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61761613", "body": "Thank you for the PR.  I am generally fine with the idea.  However I would like to get few things get addressed before merging to master.\n- please create and access an attribute instead of using `unix:` as an indicator of UNIX socket\n  - i.e. the configuration file should look like:\n\n```\nlisten:\n  port: path-to-unix-file\n  type: unix\n```\n- would you mind tell me what the real use case is?  I'm curious.\n  - IMO h2o is suited for a front-end server and that means that it would be likely setup to bound to a global TCP address\n- please consider the suggestions / questions made in-line within the commit\n\nThank you in advance.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61761613/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61769798", "body": "Apparently you are using an older version of libuv.  H2O requires libuv that has compatible API with libuv 1.0.\nThe latest RC for libuv 1.0 can be found [here](https://github.com/joyent/libuv/releases).\n\n\uff08\u5225\u306b\u65e5\u672c\u8a9e\u3067\u3082\u3044\u3044\u3067\u3059\u3088\u3001\u3068\u3044\u3046\u3053\u3068\u3067\u4ee5\u4e0b\u65e5\u672c\u8a9e\u3067\u3059\uff09\nLibuv\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u53e4\u3044\u3053\u3068\u306b\u3088\u308b\u554f\u984c\u3067\u3059\u3002H2O\u306flibuv 1.0\u3068\u4e92\u63db\u6027\u306e\u3042\u308b\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u5fc5\u8981\u3068\u3057\u3066\u3044\u307e\u3059\u3002libuv 1.0\u7cfb\u5217\u306e\u6700\u65b0RC\u306f https://github.com/joyent/libuv/releases \u304b\u3089\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61769798/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61770007", "body": "@xiangzhai :+1:\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61770007/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61777687", "body": "added a note to README.md in a71bba3.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61777687/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61777816", "body": "I'd rather keep this issue open with the _question_ tag so that others facing the same problem could reach the answer.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61777816/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61881644", "body": "Thank you for pointing that out.  Fixed.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61881644/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61881798", "body": ":+1:\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61881798/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61886589", "body": "Thank you for pointing that out.\n\nCommits 06faa76 and fed987a should have fixed the problem.\n\nIf you still find any problem, please let me know (I used to work on FreeBSD a lot and I love the platform).\n\nThank you in advance.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61886589/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61913945", "body": "The leftovers are:\n- does not check the `exclusive` flag\n- `PRIORITY` frames are ignored\n- the prioritizing logic does not follow the guidelines in the spec\n  - though the implemented logic is better in letting the web browser's rendering earlier\n- the implementation might not be optimal (if the number of weight levels being used becomes larger)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61913945/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61914917", "body": "@mingodad May I close the issue as I think the problem has been fixed?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61914917/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61917118", "body": "Thank you for the fix, the clarification, and the contribution as a whole.  Did some tweaks and merged to master.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61917118/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62094791", "body": "@igrigorik Thank you for your comment and suggestions.  It was great to hear your presentation / discuss the issues regarding HTTP2 at the HTTP/2 Conference.\n\n> at the moment, both Chrome and FF are only using the weight field -- does H20 respect that? \n\nYou are right.  At the moment, H2O only respects the `weight` within the `HEADERS` frame. It should also be noted that the server does not distribute the bandwidth between the streams by their `weight` values.  Instead, it gives 100% bandwidth to the oldest and most highly weighted stream (if data is available on such stream).\n\nMy understanding is that this is the most web-browser-friendly way of sending data (in terms of early rendering) at the moment.  It may change as browsers start implementing DAG dependency, but IMO it might be worthwhile to keep the current implementation as a separate option, since\u00a0it would suite the needs of some users (e.g. for game developers wanting to do batched downloads in prioritized groups, as you have mentioned).\n\nRegarding PUSH, H2O does not (yet) have support for PUSH.  But once we implement one, having such kind of interface for prioritization sounds great.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62094791/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62367816", "body": "Thank you for the PR.  IMO the proposed function is a must, and I am looking forward to merging the code into master.  OTOH there is a massive refactor of `lib/proxy.c` going on in the kazuho/expr/proxy-keepalive branch, so I would first like to address things not related to the file at this moment and then decide how we should proceed.\n\nSo below are the suggestions / questions.\n- adding proto as an argument to h2o_socket_connect seems LGTM\n  - please implement the libuv-side as well\n- the `unix:` URL parser\n  - the function should be integrated into `h2o_parse_url`\n  - and the callers of `h2o_parse_url` should validate the scheme\n  - path of the unix socket should be returned as `host`\n  - what is the syntax of the unix: scheme?\n  - please write a brief document within the source code where the parsing logic is defined\n  - using regex or something\n  - for example, without any documentation it is unclear if `:` can be omitted or not\n  - IMO `:` (and `/`) should be omittable, when path is `/`\n  - please add tests to the `test_parse_url` function\n  - they can be run by `make test`\n- please extend examples/socket-client.c to support unix sockets, so that it would be possible to test the functionality by using the example\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62367816/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62458274", "body": "Agreed.  There would be several ways to implement such a benchmark.\n\nIIRC h2load (part of @tatsuhiro-t 's nghttp2) has a mode that reads a list of URLs (with weights and presumably dependencies) from a file and sends the requests.  If the command could be extended to\n- support adding junks between the URLs listed in the file\n- obtain URLs from the fetched content as they are downloaded\n\nthen we could use the command to implement such a benchmark independent from the development of the web browsers.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62458274/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62459175", "body": "Well it's already there.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62459175/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62459658", "body": "- SSL false start\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62459658/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62505777", "body": "done in commit ab9a725\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62505777/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63008573", "body": "Support for chunked encoding within the server implementation has been landed in master at commit 06cfffe.  The leftover is to add it to the reverse proxy side.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63008573/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63118332", "body": "Note: the chunked decoder implementation at the moment discards trailing headers.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63118332/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63163553", "body": "Thank you for noticing it.  Will merge this anyways and see if it is really a bug or was just a timeout on travis.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63163553/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63163677", "body": "Test passed. https://travis-ci.org/h2o/h2o/builds/41075107\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63163677/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63190806", "body": "Hopefully the commit above would help us diagnose the problem if it ever happens again.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63190806/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63223098", "body": "Reproduced in https://travis-ci.org/h2o/h2o/builds/41161386 Seems that Starlet did not go down with SIGTERM.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63223098/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63275556", "body": "Header values can be logged as of f820a97\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63275556/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63934860", "body": "The question is whether if we need to implement dynamic TLS record sizing, considering the fact that the overhead of limiting TLS record size to 1,400 bytes is around 2% (overhead per TLS record is (at minimum) 26 bytes in case of SHA1 or 29 bytes in case of current implementation when using 128-bit block cipher in CBC mode).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63934860/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/64748292", "body": "Thank you for the fix!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/64748292/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/64756297", "body": "Thank you for looking into the issue.\n\nAlthough you have closed the issue, I think your changes make sense, and I might merge it to master.\n\nOTOH, I agree that it would be better to use H2O as a submodule (rather than an install library) since the IMO the API isn't stable yet.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/64756297/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/64939908", "body": "Thank you for spending your time with H2O.\n\nIMO H2O is not yet ready for production.  The HTTP/1 implementation is fairly stable (actually, the codebase is already used in production), but the other parts still lack some functions (e.g. timeout of HTTP/2 connections).\n\nIf all goes well, there will be a official release in a week or two.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/64939908/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65029218", "body": "H2O supports two types of event loops.  One is evloop (the embedded event loop) which is used by the standalone server, and the other is libuv which is the default of libh2o.\n\nFor the standalone server, I am not interested in providing such wrapper; I would like to avoid creating many threads for running blocking syscalls since IMO they would hurt performance.\n\nOTOH for libh2o (backed by libuv), I agree that there is such a need.  I am not sure if libuv itself provides such feature, but it would be possible to write such a wrapper by using `uv_async`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65029218/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65031926", "body": "Although there is no such thing at the moment, it is not difficult to create a subrequest handler by yourself.\n\nWhat you need to do is define your own connection class (a struct that has `h2o_conn_t` as the first member), and the necessary functions.  `h2o_loopback_conn_t` defined in lib/t/test.h and lib/t/test.c would be a good example.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65031926/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65033435", "body": "It should be.\n\nTo disable HTTP2, please set `h2o_globalconf_t::http1_upgrade_to_http2` to `0` (default is `1`), and _not_ define the NPN / ALPN protocol specifiers for HTTP2 (as done in [examples/libh2o/simple.c line 203](https://github.com/h2o/h2o/blob/master/examples/libh2o/simple.c#L203)).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65033435/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65033937", "body": "Thank you for noticing the issue.  I have not yet had time to reproduce the issue, but apparently the code does not set `self->client` to NULL after cancelling the upstream response in case of abrupt close (https://github.com/h2o/h2o/blob/1e1d399b64503d73714c65da6e984fb64fc99f62/lib/proxy.c#L112).\n\nI will fix the issue laterwards as well as adding a test case.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65033937/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65180858", "body": "relates to #57 \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65180858/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65181132", "body": "We should either\n- always build libh2o and let `make install` always install the library (as proposed in #57)\n  - this in turn makes the dependency to libuv mandatory\n- only install libh2o when libuv was found\n\nMy preference is the latter, since I anticipate that the majority of the users would use h2o as a standalone server.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65181132/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65183713", "body": "@methane \nI agree that symlinking yoml.h and picohttpparser.h into `include/h2o` and installing the files is the way to go, considering the fact that their implementations are statically linked to libh2o.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65183713/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65190140", "body": "For simplicity, I would suggest using `#include <>` in all the places to include the header files that need to be installed.  And set the include path accordingly for each case.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65190140/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65357260", "body": "Is my understanding correct that this PR is still WIP?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65357260/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65361386", "body": "@methane Ah, sorry!\n\nAs shown below, trying to use the installed headers seem to fail.\n\n```\n$ cd build/osx\n$ rm -rf *\n$ CMAKE_INCLUDE_PATH=/usr/local/openssl-1.0.2/include CMAKE_LIBRARY_PATH=/usr/local/openssl-1.0.2/lib cmake -DCMAKE_C_COMPILER=/usr/local/bin/qrintf-gcc -DCMAKE_INSTALL_PREFIX=`pwd`/dist ../..\n(snip)\n$ make test install\n(snip)\n$ clang -I dist/include ../../examples/libh2o/simple.c \nIn file included from ../../examples/libh2o/simple.c:30:\ndist/include/h2o.h:39:10: fatal error: 'picohttpparser.h' file not found\n#include \"picohttpparser.h\"\n         ^\n1 error generated.\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65361386/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65361963", "body": "IMO there are two ways to solve the problem.\n1. move `deps/*` to `deps/h2o/` and adjust the `#include`s.\n2. do not include the files under `deps/` from the files in `include/`, and instead `typedef` the structs that are used from `deps` in `h2o.h`\n\nI am at this moment inclined to the second approach considering the fact that they are _bundled external libraries_.  IMO bundled external libraries should not be exposed to the user.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65361963/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/66576194", "body": "Thank you for noticing the issue.\n\nThe most likely cause is that H2O does not (yet) rewrite the `Location` header sent by an upstream server (the other possibility was that it sending a wrong `Host` header, but by the test added in 4d51757 it has been asserted that such bug does not exist).\n\nI will look into implementing code that rewrites the `Location` header.\n\nEDIT: Unfortunately the issue will not resolve even if the rewriting of the header gets implemented.  As can be seen in [this gist](https://gist.github.com/kazuho/87a295c51f314b031082), googledrive.com seems to redirect `http` requests to `https`; the reverse proxy of H2O does not support `https`.  Supporting `https` in reverse proxy is IMO a low priority issue since it would not necessary in most cases.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/66576194/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/66723339", "body": "> In this case, I would suggest to rename the issue to address the HTTPS support for the proxy. I understand that this is a low priority but I would be happy to see this somewhere in the future. \n\nThank you for the suggestion.  Changed the title as well as creating #65.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/66723339/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/67122986", "body": "Thank you for the proposal.\n\nI rather hesitate to adding helper functions for web-application development to H2O since IMO in most cases tightly coupling the application logic to a specific httpd implementation is not the ideal approach.  I believe that somebody should create a simple layer for C / C++ that abstracts the various httpds, like [WSGI](http://wsgi.readthedocs.org/en/latest/) (Python) or [PSGI](http://plackperl.org/) (Perl).\n\nIt would be better to develop things like query parser against such httpd-independent specification rather than against the interface provided by H2O.  The problem is that I do not know of any such specification targetting C/C++.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/67122986/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/67303900", "body": "Thank you for the suggestion.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/67303900/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/67753837", "body": "The feature may be implemented as a opitonal flag within `h2o_socket_t`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/67753837/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/67753854", "body": "Closing the issue as everything is working fine for couple of time.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/67753854/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/67757065", "body": ":+1: \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/67757065/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68083886", "body": "Thank you for reporting the issue.  I have successfully reproduced the problem.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68083886/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68085024", "body": "The problem is in Apache Bench.\n\nThe tool does not implement the HTTP specification correctly; it fails to detect the `content-length` header all in lowercase letters as H2O sends (see https://github.com/apache/httpd/blob/trunk/support/ab.c#L1581).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68085024/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68085063", "body": "Changed H2O to send the essential headers with the first letters uppercased.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68085063/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68195245", "body": "Thank you for the suggestion.\n\nLibucl looks like an interesting library.  But for the moment I would like to stick on using YAML since it is more well known.  Using a well-known format helps people start using H2O, and also IMO would decrease the cost of supporting users.  It would also be easier to write converters that convert the configuration to YAML.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68195245/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68195357", "body": "> cowardly refusing to run as root; you can use the `user` directive to set the running user\n\nIf you are to invoke h2o as a root user, then you would need to set the `user` directive at the root level of the configuration file (the other option is invoke  `h2o` as a non-root user).\n\n> where in h2o.conf do you add the user as i get\n> \n> > failed to parse configuration file:/usr/local/h2o/h2o.conf:line 3:mapping values are not allowed in\n\nThis seems like a YAML format error.  Please either: a) post the entire configuration file you are trying to use, b) try some of the YAML validators online to check if the configuration file is correct (as a YAML file), c) refer to the [YAML specification](http://www.yaml.org/).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68195357/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68195437", "body": "> Meanwhile how hard would be for h2o to have a spdy3 compatibility mode to benefit from it right now ?\n\nI have never read the specification and have no concrete idea, but IMHO it should not be _that_ hard (the http2 protocol implementation of H2O is around 3,000 LOC, spdy3 impl. would not differ much).\n\nOTOH I am not sure if it is worth working on considering the fact that the web browsers that support SPDY3 is sooner or later going to switch to HTTP/2 (within months maybe).\n\n> I did some tests on a machine with 8 cores and it seems that it doesn't scale beyound 2 threads.\n\nIt is apparently due to the limitations of Apache Bench.  Apache Bench is a single-threaded benchmark program, it is simply incapable of benchmarking a multi-threaded (or multi-process) server.  I would sugesst using other tools (e.g. [wrk](https://github.com/wg/wrk)) for taking benchmarks of H2O running multiple threads.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68195437/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68195466", "body": "Thank you for the suggestion.  It sounds like a good idea.\n\nI am considering of adding a directive to _include_ portions of the configuration file in the near future.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68195466/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68195503", "body": "Thank you for the fixes!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68195503/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68200079", "body": "Thank you for providing the background.  The tool looks interesting.  Hopefully H2O can be integrated the stack once we add support for including configuration files.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68200079/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68200414", "body": "Regarding the familiarity to the users, you could also argue the otherwise; it is true that some may be used to the syntax of Nginx' configuration file than YAML, it is also true that some may be more familiar with YAML.  Besides that, it would not ease migration from Nginx to H2O even if we used libucl, since the configuration directives do not map one by one.\n\nSo generally speaking I do not see any merit of choosing libucl over YAML, considering the fact that IMO YAML is more widely used, and also has a specification.  I am not saying that libucl is not a good offer, I am just being conservative.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68200414/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68200617", "body": "The default number of maximum concurrent connections is limited to 1,024.\n\n```\n$ h2o --help\n(snip)\n  max-connections: [g]\n    max connections (default: 1024)\n```\n\nPlease adjust the configuration to run benchmarks exceeding the default maximum.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68200617/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68200653", "body": "Thank you for noticing the issue.\n\n> 192.168.0.yyy - - [27/Dec/2014:15:00:48 +0000] \"HEAD /nginx-logo.png HTTP/1.1\" 404 9 \"-\" \"curl/7.19.7 (x86_64-redhat-linux-gnu) libcurl/7.19.7 NSS/3.15.3 zlib/1.2.3 libidn/1.18 libssh2/1.4.2\"\n\nAs of now, the file handler of H2O does not recognize the `HEAD` method, incorrectly returning 404.  I will fix the issue in the upcoming releases.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68200653/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68230676", "body": "Thank you for the fix!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68230676/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68230685", "body": "Thank you for the fix!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68230685/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68230950", "body": "Thank you for noticing the issue.  Fixed it the other way round to allow people use OpenSSL prior to 1.0.1.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68230950/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68308130", "body": "We are still at early stage and do not provide binary builds.  I am not sure we would ever provide them at all.\nOTOH I do not see any particular reason that prevents H2O from running on ARM (esp. AArch64).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68308130/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68314510", "body": "I am not familiar with Python or WSGI, but my suggestions regarding how it should be bound to H2O is as below.\n\n> What to do about the GIL? It looks like H2O uses a threaded model vs. preforking?\n\nThe answer might depend on against which of the two products of H2O (or both) you want to implement the WSGI handler.\n\nlibh2o is an event-driven implementation of HTTP/1, HTTP/2.  It does not call fork(2) or pthread functions by itself, the user of the library is responsible for implementing them.\n\nh2o (the standalone server) is a event-driven & is thread based.  Use of pthreads is mandatory for a high-performance reverse proxy with support for persistent connections to upstream (e.g. application servers).\n\nAnyways the two are both event-driven in the sense that multiple HTTP connections are handled by a single thread via callbacks, and the fact might make it difficult to connect it to an existing WSGI-based application (IIRC it's a synchronous interface) without using either inter-process calls (or inter-thread calls).\n\n> Should handlers like these be contributed directly to H2O or live in a separate project?\n\nAs a separate project.  In case your interest is creating a WSGI server that runs as part of the h2o standalone server, we are interested in adding 3rd-party modules support (#89), so that such things can be nicely integrated into the server.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68314510/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68314693", "body": "> 1. Can h2o also define a static OpenSSL version that is not the system OpenSSL version ? How ?\n\nIt should be possible.  The procedure would be to build OpenSSL with static libs only, and then let CMake use it.  The CMake directives to use are: CMAKE_INCLUDE_PATH and CMAKE_LIBRARY_PATH.\n\nIIRC something like `cmake -DCMAKE_INCLUDE_PATH=/my-own-openssl/include -DCMAKE_LIBRARY_PATH=/my-own-openssl/lib` would do the job.\n\n> 1. Is there any finer grain control of SSL cipher suite preferences like using Mozilla's recommended SSL cipher suite preferences https://wiki.mozilla.org/Security/Server_Side_TLS#Intermediate_compatibility_.28default.29 ?\n\nNo, for the time being. (note: FWIW, user-agents with HTTP/2 support are required to prefer ciphersuites with forward-secrecy & AEAD, making this kind of explicit settings unnecessary).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68314693/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68315426", "body": "Server::Starter is a set of superdaemon program (named `start_server`) and a support library written in Perl, for hot-deploying TCP servers.  Suggested reads are:\n- [presentation slides](http://www.slideshare.net/kazuho/server-starter-a-superdaemon-to-hotdeploy-server-programs)\n- [man page of `start_server` command](https://metacpan.org/pod/distribution/Server-Starter/start_server)\n\nH2O implements the support-library-side in C by itself.  So if you want to run H2O that bounds to `0.0.0.0:80` under Server::Starter, the invocation command would look like:\n\n```\n$ start_server --port=0.0.0.0:80 -- h2o -c h2o.conf\n```\n\nThe bind address specified within h2o.conf should match exactly that is defined as part of the argument to `start_server`, e.g. in the case above, h2o.conf should contain:\n\n```\nlisten:\n  host: 0.0.0.0\n  port: 80\n```\n\nNote that since Server::Starter does not yet support IPv6, it is mandatory to specify the `host` directive with an IPv4 address in h2o.conf.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68315426/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68315542", "body": "Regarding how to install Server::Starter (in case you are not familiar to Perl), the easiest way might be to first install [cpanm](http://search.cpan.org/dist/App-cpanminus/lib/App/cpanminus.pm) and then use it to install Server::Starter.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68315542/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68325473", "body": "Thank you for reporting the issue.  I believe that the problem has been fixed in the commit above.\n\nIt seems like that I would need to add a regression test for C++.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68325473/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68329098", "body": "@jbergstroem I would like to keep this issue open (it's a good question after all) so that others can reach it easily (and have tagged this as FAQ).\n\n@centminmod Agreed.  Creating a wrapper is a good idea.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68329098/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68329161", "body": "Closing the issue since IMO it should have been fixed.  Please reopen if the problem still persists.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68329161/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68329305", "body": "Closing the issue.  A dedicated `#error` is reported if libuv is too old (#67).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68329305/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68404685", "body": "@centminmod Thank you for the clarification.  Understood.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68404685/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68411111", "body": "@centminmod \n\nThe `--port` arguments passed to start_server and the `listen` directives in h2o.conf should match (and only IPv4 is supported by the former while the latter by default tries to bind to both IPv4 and IPv6 addresses unless `host` is specified).\n\nSo if the invocation command is `start_server --port=0.0.0.0:8080` then there _all_ the `listen` directives in h2o.conf should be:\n\n```\nlisten:\n    host: 0.0.0.0\n    port: 8080\n```\n\nThe directive may appear more than once in different host-based contexts.  They may also have their `ssl` property set using different key/certificate pairs for each host.\n\n> with the complexity, might be easier to bundle with h2o it's own init.d/systemd compatibility startup scripts\n\nAgreed.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68411111/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68415260", "body": "@centminmod \n\n> Does that mean the change i would need made for my example h2o.conf would be changing \"alternate.127.0.0.1.xip.io:8081\" to \"0.0.0.0:8081\" ?\n\nNo.  The keys of the `host` mapping is used for matching the `Host:` header of HTTP/1 (or the `:authority:` header of HTTP/2).\n\nIt is the `listen` directive that controls to which ports the server binds.  In case of `examples/h2o/h2o.conf`, tweaks like https://gist.github.com/kazuho/7c634fce977b13c55a98/revisions should be made.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68415260/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68498070", "body": "> - How does libh2o handle huge request bodies?\n\nIn the protocol implementations the request body is buffered using `h2o_buffer_t`.  The structure uses `malloc(3)` for small chunks, fallbacks to temporary-file-backed `mmap(2)` if the requested allocation size becomes equal to or greater than `h2o_socket_buffer_mmap_settings.threshold` (default is 32MB).\n\nThe protocol implementations return `413 Request Entity Too Large` error if the size of the request body is greater than `h2o_globalconf_t::max_request_entity_size`.\n\n> - Is it possible to stream request bodies? That is, the handler is invoked without entity being set.\n\nNo.  The handler is invoked only after all the request body arrives.  At the time the body is avaiable to the user through `h2o_req_t::entity`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68498070/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68498422", "body": "Merged to master in 66cda73, but needs polish up as discussed in #84.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68498422/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68503066", "body": "That's a good question!  My interests are:\n- challenges both in performance and usability should be done regarding HTTP/2; H2O would be a good platform for the purpose\n- current server-side architecture (running three-tiered servers: HA load-balancer, proxy/buffer, application server) is overly complex, and H2O could be used as a tool to simplify them\n- provide the components of the H2O standalone server as libh2o so that they could be used for other purposes\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68503066/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68621545", "body": "My bad.  Fixed the issue / added test that covers the behaviour of max-connections.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68621545/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68649381", "body": "H2O now recognizes `cipher-suite` property within the `ssl` section.  The format of the property is equiv. to the [SSLCipherSuite](http://httpd.apache.org/docs/2.4/mod/mod_ssl.html#sslciphersuite) directive of Apache HTTP server.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68649381/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68785868", "body": "Wow!  It is great to hear that you for working on the binding, and thank you for noticing the issue.\n\nThe client implementation is rather incomplete (and internal), so it might not be better to expose the current interface to the users.  The implementation lacks some key features as a full-fledged client - it does not support TLS nor HTTP/2.  The main reason for writing http1client.[ch] was that there was a need for fast HTTP/1 client implementation that can be used from the reverse proxy module of H2O (lib/proxy.c).\n\nWe might eventually need to implement a more complete client implementation with a different interface, and the interface might share more structures with the server implementation (although I am not sure how far it would be possible to share them; for example `h2o_req_t` owns a memory pool while http1client refers to a memory pool - this is because http1client is responsible for sending requests to upstream _as part of_ handling a request within proxy.c).\n\nThe other aspect would be testability and code reuse.  As I see, the source files of H2O can be categorized into the following groups.\n- libraries\n  - memory, string, socket, timeout, ...\n  - header file for each library exists in include/h2o\n- the core\n  - depends on the libraries\n  - defined in context.c, headers.c, request.c, ...\n  - declarations are in h2o.h\n- server-side protocol implementations\n  - depends on the core\n  - http1, http2\n- the standalone server\n  - src/main.c\n\nWhen redesigning the HTTP client, it would be preferable to move some structures / functions to library level (and keep the client implementation at the library level) rather than depending on the core from the client.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68785868/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68987846", "body": "Thank you for the PR.\n\nWould it be possible to include libh2o in the default target only if libuv is installed?  The reason I ask is because the library is not required for building the standalone server.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68987846/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68988198", "body": "For the time being, following four CAs are being tested.  Are there any other to test?\n\nTested CAs:\n- comodo\n- cybertrust\n- verisign\n- thawte\n\nCorresponding code is here: https://github.com/h2o/h2o/blob/kazuho/ocsp/t/90live-fetch-ocsp-response.t#L9\n\nNote: GlobalSign has been excluded from the test as the OCSP server returns 403 Forbidden (see [log](https://gist.github.com/kazuho/61555d5a624ac4556183)).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68988198/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69050493", "body": "Added godaddy as suggested by https://twitter.com/hirose31/status/552738874833661952\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69050493/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69055044", "body": "Merged to master.  Thank you for the PR.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69055044/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69289047", "body": "I now consider this issue as low priority due to following reasons:\n- for TLS-based connections lingering close at TCP level is unnecessary, since the TLS implementation (e.g. OpenSSL) is required to perform graceful shutdown over TCP whenever possible\n- for HTTP/1 over TCP lingering close is only necessary if the client sends multiple requests in pipeline (but they seldomly do [ref](http://en.wikipedia.org/wiki/HTTP_pipelining#Implementation_in_web_browsers))\n- for HTTP/2 over TCP lingering is necessary since it is an asynchronous protocol; however most web browsers would only support HTTP/2 over TLS\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69289047/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69301129", "body": "I would strongly suggest using libuv (and the libraries that are built on top of libuv).\n\nIt is true that the embedded event loop of H2O is faster than libuv.  But for things like an application server connecting to a database, it would not cause a real difference IMO.  Jumping on a bigger bandwagon in this respect would be better choice than trying to write bindings using the embedded event loop.  It is also worth noting that libuv has much much more stable API, better documentation than the embedded event loop of H2O.\n\nOTOH, I think having a bridge within H2O that helps running _synchronous_ (not async) handlers in C would be a good idea, so that people could combine the assets of existing libraries (that block) with H2O.  But personally I do not have time to work on it right now.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69301129/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69472512", "body": "@bagder Thank you for the info.  Starting to implement dependency support on H2O.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69472512/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69472834", "body": "Great!  With working implementations and related docs it is so much easier for me to implement dependency-based prioritization.  Kudos to Mozilla and @tatsuhiro-t for leading the works.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69472834/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69535373", "body": "Thank you for the suggestion.\n\nRegarding the question IMO the best part to look at is `.travis.yml`, as it contains the setup commands that are run by the CI server (as thus is _guaranteed_ to be correct).  It would be great if you could look into the file.\n\nI have added a link from README to `.travis.yml`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69535373/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69536608", "body": "Thank you for the PR.\n\nPlease rewrite other parts of that use `_share.count` to use the sychronised operations, or the numbers might become incorrect.\n\nRegarding the benchmark number,s I am afraid they are not due to the change, since the code path is only used by the reverse proxy module.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69536608/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69648139", "body": "Thank you for the PR.\n\nWould you mind creating a function within serverutil.h / serverutil.c that return the number of CPU cores, and call the function from the initializer of `config_t config` [here](https://github.com/h2o/h2o/blob/06e923664497ee1d85d1e6d3752d295f8e251a06/src/main.c#L1073).\n\nIMO the method to obtain the number of CPU cores should be abstracted into a separate function at the method differs between platforms.\n\nEDIT. Regarding the type of the value to store the number of CPU cores, I think we should switch to using `size_t`, i.e. the return type of the function should be `size_t`, as well as `config_t::num_threads`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69648139/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69651056", "body": "Thank you for the work.  Merged to master.\n\nGenerally speaking I would be happy if you do not squash on your behalf as it would help us recall how we changed the code as the discussion went on.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69651056/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69656687", "body": "@nickdesaulniers ah my bad.\n\n> Either it should not be made static\n\nPlease go for it.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69656687/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69689682", "body": "Thank you for the changes.\n\nGoing to merge to master with some nitpicks / will look into the test failures.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69689682/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69697838", "body": "Thank you for the work!  It's now merged to master.\n\nFYI there was a race condition [here](https://github.com/h2o/h2o/blob/56b65cc1cb2c429fb7bba37dbc2e1b5d4c18aedb/lib/handler/proxy.c#L329) which was fixed in fc0f7f2.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69697838/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69709730", "body": "Wow!  Looks promising!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69709730/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69869786", "body": "The steps I took are:\n1. the travis log said that the [H2O died with signal 11](https://travis-ci.org/h2o/h2o/builds/46607227#L2753), i.e. SEGV\n2. using valgrind, but it did not help in this particular case ([log](https://travis-ci.org/h2o/h2o/builds/46812569))\n3. so I switch to using catchsegv, and in one of the tests run on TravisCI an assertion failure was reported, but cachsegv was unable to print the backtrace ([log](https://travis-ci.org/h2o/h2o/builds/46813259#L1284))\n4. afterwards I modified the code to track the caller of the assertion failure, and found out the cause\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69869786/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69880026", "body": "Setting the keys of the `hosts` part to `localhost:8080` and `localhost:8081` should fix the problem.  In your case, curl is sending `Host: localhost:8081`, and since there is no definition for that _host_, the first context is being used.\n\nThat said, I consider the current behavior to be a bug in H2O that should be fixed in future releases, the server should not return content of a host context that do not bind to the same address.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69880026/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69880383", "body": "Personally I use the following version that has been [added to Homebrew just yesterday](https://github.com/Homebrew/homebrew/pull/35777).\n\n```\n$ clang-format --version\nclang-format version 3.6.0 (tags/google/testing/2014-12-03)\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69880383/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69992133", "body": "Thank you for the PR.  LGTM.\n\nThe test failures in t/50reverse-proxy.t seems is happening in the master branch as well (it may be or may not be a multi-threading issue).  I am looking into it.\n\nBTW, did you use some kind of tool to detect dead stores?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69992133/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70019261", "body": "@nickdesaulniers \n\n> http://llvm.org/bugs/show_bug.cgi?id=22228\n> Looks like we can remove the increments to argv and argc. http://linux.die.net/man/3/optind\n\nI wonder if we should _fix_ the code in these kind of cases, since as Jordan says, it is a standard idiom to update `argc` and `argv` after collecting the arguments.  Removing the updates may make the analyzer silent, but might complicate things when we try to add code that uses the arguments afterwards.\n\nThe changes proposed in #106 includes similar pattern.  https://github.com/nickdesaulniers/h2o/commit/407b3727c5ccdf097f9f00a1e38e01e98682d23f#diff-1 removes a _stores-data-and-update-destination_ idiom.  I was fine in the proposed changes in #106 since the dead stores removed in the commits were at the end of the functions, but it might be good to reconsider making such changes.\n\nIs it possible to instruct the analyzer not do report dead stores (since it would be a pain to work on the report with such false positives)?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70019261/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70032595", "body": "In a5e692c cherry-picked the changes to file.c (they were meaningless statements).\n\nI am sorry but I will not merge the changes to frame.c, as the reported dead stores are the results of a consistent coding pattern that should better be kept as they are (as discussed in https://github.com/h2o/h2o/issues/107#issuecomment-70032870).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70032595/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70032870", "body": "> I think running the checker with -disable-checker deadcode.DeadStores.\n\nThank you for determining the parameter.  I have updated the corresponding parameter in the Xcode project file.\n\nI think we'd better go with disabling the feature (instead of modifying the code) for the following reasons:\n- dead store is not an error\n- it does not have negative performance impact (if the binary is optimized)\n- consistent coding pattern is a good practice\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70032870/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70044354", "body": "Thank you for the PR.\n\n`h2o_mem_alloc` never returns `NULL`, as it calls `h2o_fatal` (which calls `abort(3)`) in case memory allocation fails.\n\nAdding `__attribute__((noreturn)__` to the declaration (which should only be set for GCC and compatible compilers) of `h2o_fatal` might solve the problem.\n\nEDIT: I am not sure why the static analyzer reports this as an issue; declaration of `abort(3)` should have the noreturn attribute set, and the analyzer, upon traversing through the call graph, should have noticed it.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70044354/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70207994", "body": "> should h2o_mem_alloc also be marked as returns_nonnull as well?\n\nSounds fine to me.  It would be great if you could use preprocessor macros so that use of the attribute will not cause compile errors / warnings on other compilers / older versions of GCC.\n\nIt might be worth to consider creating a `#define` named `H2O_FUNCATTR_RETURNS_NONNULL` that is either empty or `__attribute__((returns_nonnull))` depending on the compiler.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70207994/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70309433", "body": "The leftovers at this point are:\n- reprioritize an already prioritized stream when receiving HEADERS\n- reprioritize when receiving a PRIORITY frame (as of now the priority never changes after initially assigned)\n- proportionally distribute the priority of the closed frame to its dependents (per first paragraph of draft-16 5.3.4)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70309433/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70384572", "body": "Dependency-based prioritization is now supported by H2O with the merge of the PR above.  IMO it would be sufficient to support Firefox.\n\nAs of c48089c (on master) there are some leftovers (or behavior inconsistent to the HTTP2 spec.):\n- only the streams with highest priority are being sent (in round-robin)\n  - spec. says all the streams should be allocated resource proportional to their weights\n- does not distribute (instead preserves) the priority of the raised streams when the dependency is being closed\n- there is no limit for the number of idle prioritized streams\n\nRegarding the topic of the issue, the scheduler is not pluggable but it would be easy to replace them at compile time, as:\n- the interface and the default implementation is pretty independent; it does not depend on the protocol layer or the H2O core\n  - [include/h2o/http2/scheduler.h](https://github.com/h2o/h2o/blob/c48089c0b3c0bdb2a4c4508d98bb342b9fcffec4/include/h2o/http2/scheduler.h), [lib/http2/scheduler.c](https://github.com/h2o/h2o/blob/c48089c0b3c0bdb2a4c4508d98bb342b9fcffec4/lib/http2/scheduler.c)\n- has its own unit tests in [t/00unit/lib/http2/scheduler.c](https://github.com/h2o/h2o/blob/c48089c0b3c0bdb2a4c4508d98bb342b9fcffec4/t/00unit/lib/http2/scheduler.c)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70384572/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70440233", "body": "@mback2k @bagder \nThank you for the PR and the advises.  I am fine to merge the PR once the issues get fixed.\n\nEDIT: This is not a must, but it would be great if you could add tests (adding test-cases to t/00unit/lib/handler/file.c might be easier unless you are familiar to Perl).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70440233/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/7862843", "body": "@linuxscooter it seems that your `CMakeLists.txt` is corrupt.  There isn't any such line in the [original file](https://github.com/kazuho/h2o/blob/master/CMakeLists.txt#L5).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/7862843/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/8473102", "body": "Thank you for the comment.  I missed the section.  Will remove any references to alloca.h.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/8473102/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/9272662", "body": "Man pages of both linux and OSX states that including unistd.h is sufficient for using `_SC_NPROCESSORS_ONLN`.  So after including the file, we can use the `#ifdef` to determine if we could use `getconf(_SC_NPROCESSORS_ONLN)` to obtain the number of CPU cores available.  If not, we try to use `sysctl` with flags `CTL_HW` and `HW_AVAILCPU`, that are defined in sysctl.h on *BSD systems.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9272662/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/9334341", "body": "@jonigata @herumi I'd like to optimize these memcmps, as at least gcc-4.9.1 (x86-64) does not seem to inline-expand them.  It would be great if you could provide help. Any suggestions?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9334341/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/9338841", "body": "@maksqwe Thank you for the suggestion.  The prob. is that glibc's memcmp (which is called in case of using `-fno-builtin-memcmp`) is not optimal in this case.\n\nIt would be possible to optimize the operation by using the fact that two out of three arguments are constants in these cases.  For example, `mecmp(name, \"if-modified-sinc\", 16)` can be optimized to two loads into a 128-bit SIMD register, one comparison, and one conditional branch.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9338841/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/9730949", "body": "The function registers a _redirect handler_ to given `pathconf`.  By calling `h2o_create_handler` the function creates a handler associated to `pathconf`, and then sets up the callbacks and other attributes.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9730949/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/9730953", "body": "The struct defines the _redirect handler_.  The first element of a handler should always be `h2o_handler_t`, following attributes are used only by each handler.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9730953/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/9730960", "body": "The callback is called when disposing the handler object.  It should release all the resources held by the attributes (if any).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9730960/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/9730971", "body": "This is the callback that handles the requests (it is registered by the `h2o_redirect_register` function, see below).\n\nIn case of the redirect handler, the function builds the destination URL, and sends a response using `h2o_send_redirect` function.  Please read the internals of `h2o_send_redirect` to find out how to send other types of responses.  Or if you want to stream the response (i.e. push more content as some are sent to the cilent, instead of building the entire response at once), please take a look at `lib/handler/file.c` or `lib/handler/proxy.c`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9730971/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/9730975", "body": "New source files should be added to the makefile.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9730975/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/9730984", "body": "A new handler (that is usable from the standalone server) typically exports three symbols; an abstract type that represents the handler, a function that registers the handler, and a function that registers the configuration directives for the handler.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9730984/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/9730990", "body": "The function registers the configuration directives recognized by the handler (in this case, only one directive named `redirect` is recognized, which is handled by the `on_config` callback).\n\nThe handler of the directive is limited to path level (by `H2O_CONFIGURATOR_FLAG_PATH`).  Other flags could be used for convenience; for example the `H2O_CONFIGURATOR_FLAG_EXPECT_SCALAR` flag can be used if the expected type of the argument to the directive is scalar only.  If the flag is used, the callback function need not check the type of the configuration variable; an appropriate configuration error will be emitted by the core if the type is incorrect.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9730990/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/9731020", "body": "The configurator of the handler should be registered to the standalone server.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9731020/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/11515370", "body": "What happens if vec.entries[i].len is above 65535?  Such case may happen if the length of a single header value exceeds the value.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/11515370/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/12099799", "body": "Thanks fixed.  Still working on the PR.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/12099799/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/12704498", "body": "Thank you for the suggestion.  Changed so in bb7de02.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/12704498/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/12957764", "body": "Thank you for the suggestion.  Reverted with clarification comments in 3c6f6ec.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/12957764/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/14267299", "body": "Wow! Thank you for noticing that.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/14267299/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/14406619", "body": "Thank you for your comment.\n\nWe will update the Changes in master branch before we release 1.6 series.\n\nNote: master branch has already received new features since the release of 1.5, and that is why the work has been split into v1.5.x (maintenance branch) and master.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/14406619/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/15058086", "body": "Thank you for noticing the issue.  Fixed in 6dd6f66.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/15058086/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/17607549", "body": "Please do not include `http1_` in the name, since the status codes sent over HTTP2 are also counted.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/17607549/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/17607559", "body": "Please use  `H2O_` prefix for a macro defined in a header file.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/17607559/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/17607618", "body": "Please change the names of the properties to match the ones added to `h2o_context_t`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/17607618/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/17607637", "body": "I would appreciate it if the names of the errors were also updated to match those defined in `h2o_context_t` and `errors_status_ctx_t`. (This is not a MUST; we could leave them as-is if it has already become difficult for you to change the names).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/17607637/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/17712128", "body": "Thank you for the suggestion.\n\nUse of a urandom seems like an overkill to me.  In other words, we should either use a good random number generator that does not involve a syscall (e.g. arc4random), implement our own (possibly by calling OpenSSL), or continue using `rand()` as a fallback.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/17712128/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/18310447", "body": "How about changing the type of 2nd argument from `char ** const dst` to `conts char *dst`?\n\nI believe the caller can update the pointer by itself by doing `dst -= rewind;`.\n\nThe reason I suggest this is If we pass the address of the pointer (and if `handle_special_paths` is not inlined), then the caller might suffer from performance regression due to aliasing.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/18310447/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/18310459", "body": "How about declaring `size_t rewind` here as well as initializing it to`2`? I believe this is the only block we are using the variable.\n\nOr you could retain the original address of the destination, adjust dst, then subtract the original from the adjusted value. That way, you won't need to be careful in adjusting two variables (dst and rewind) in sync in various parts of the code.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/18310459/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}], "review_comments": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31695588", "body": "- please create an anonymous struct like `struct { ... } ranged;` for containing the properties necessary for handling ranged requests\n- please use `size_t` for storing indices (my understanding is that `range_count`, `current_range`, `finished_range` all fit into the criteria)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31695588/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31695828", "body": "For the purpose of adding the _end-of-multipart_ marker, I would suggest allocating a new buffer from memory pool to store the marker, and pass it to `h2o_send()` at once with the last content (i.e. the second argument to the function should contain two iovecs, first one containing the content, and the second one containing the _end-of-multipart_ marker, and the third argument should be set to _2_ instead of _1_).\n\nBy doing that way the code would become simpler, and you would no longer to adjust `bytesleft`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31695828/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31696090", "body": "Please extract the logic of parsing a number to a dedicated function, and place it next to `h2o_strtosize` in lib/common/string.c.\n\nI would be happy if the name and behavior of the function was modeled similar to `h2o_strtosize` with the extension that the end position of the string can be obtained.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31696090/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31696149", "body": "Please move the definitions to h2o/memory.h with changing there names to `H2O_LIKELY` and `H2O_UNLIKELY`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31696149/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31696198", "body": "`bytes=` header must accept whitespaces after `,` (see RFC 7230 section 7)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31696198/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31696289", "body": "simply doing `if (range_value->len < 6 || memcmp(range_value->base, \"bytes=\", 6) != 0)` might be sufficient\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31696289/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31765340", "body": "> TBO I don't fully understand how `do_procceed()` work when file is larger than `buf`, though I just followed that function and write `do_multirange_proceed()`. What is the process after non-finished sending, i.e. when leave the proceed function after calling h2o_send with `is_finished` 0? Sorry for not fully understanding the workflow, I tried my best...\n\nThere is nothing for you to apologize.  I highly appreciate your contribution!\n\nWhen `is_finished` is set to zero, the protocol handlers call the `proceed` callback of the generator when data passed in via `h2o_send` has been sent to the client.  This phase is repeated until the generator calls `h2o_send` with `is_finished` set to 1.\n\nIn other words, you should change the value of `generator->super.proceed` from `do_proceed` to `do_multipart_proceed` in case of a multi-part response (sorry I did not notice the issue when I read your code).\n\nRegarding the issue bet. push and pull generators, the former is the default one which should be supported by all generators.  Pull generator is an _optimization_ which can be used only when the underlying procotol handlers / output streams provide support for the feature.  For example, [the chunked encoder only provides the pull interface](https://github.com/h2o/h2o/blob/00c44dbb3eb49a73d6222a8df77090804b736a3b/lib/handler/chunked.c#L89) (notice that only the `do_send` callback is registered, `start_pull` remains NULL).\n\nSo for the PR to work correctly you must implement the pushing generator appropriately, whereas the pulling generator being something that can be worked on as an improvement.  That is why I suggested concentrating on the pushing generator for the time being.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31765340/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31975870", "body": "The function seems to fail in parsing the following patterns:\n- `bytes=1-3 5-10` (IMO should be considered invalid per spec)\n- `bytes=1-\\t,5-10` (IMO should return two ranges)\n\nTo me it seems like that it is possible to fix the issues by making the logic simpler by doing the following:\n- logic that skips `[ \\t]*,[ \\t]*` should exist only at the top of the do-while block\n  - current code does some checks at the top, and others within the logic that extracts a single range\n- rest of the do-while block should concentrate on extracting a single range, until it reaches EOF or an unknown character\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31975870/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31976131", "body": "`do_multirange_full` function seems to generate incorrect output.  If I build and run the server and send a request with multiple ranges, the response includes two end-of-multipart lines (see https://gist.github.com/kazuho/e69eaebfb87bd3fa2577).\n\nThe issue is not caught by the unit-tests, since the loopback handler of the test library only provides support for push-based generators.\n\nAs I suggested in one of my previous comments, implementing the pulling generator is optional, and I believe for the time being it is better to remove the pulling generator.  If you agree, you can remove the code by applying [this git diff](https://gist.github.com/kazuho/e636eac01496eb3ea517).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31976131/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31976268", "body": "please generate `end_marker` when it is used, within `do_multirange_proceed`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31976268/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31976371", "body": "Could the definition be more expressive (instead of using comments)?\n\nIt would be great if you could write like `(sizeof(\"\\r\\n--\") - 1 + BOUNDARY_SIZE + sizeof(\"\\r\\nContent-Range: bytes=-/\\r\\nContent-Type: \\r\\n\\r\\n\") - 1)` so that it would be easier to understand.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31976371/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31976699", "body": "This is kind of a nitpick, but I suggest to make the code simpler by doing the following:\n- instead of adjusting the value of `*range_cur`, use `self->bytesleft` to store the number of remaining bytes to be sent within the range, and use `self->bytesleft == 0` to detect if it is necessary to emit the boundary (instead of using `self->finished_range`)\n  - this has a nice side-effect that the variable is used the same way as with non-multirange responses\n\nTogether with the other comments, I believe we can remove to properties (`finished_range` and `end_maker_buf`) from `st_h2o_sendfile_generator_t`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31976699/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31977031", "body": "How about declaring a `vec` as `h2o_iovec_t [2]`, and always using it (with `vecarrsize` set to `1` or `2`) instead of using `vec`, `vecarr` and calling `h2o_mem_alloc_pool`?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31977031/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31977326", "body": "Please close the response if `lseek` fails, in the same way as when `read` fails.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31977326/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31981233", "body": "Thank you for checking the spec.  I agree with your comments.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31981233/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31984606", "body": "Please change the meaning of the last variable (`ret`) from _the number of ranges found, or error code if it fails_ to _the number of ranges found, if the function succeeds in parsing the input_.\n\nI believe that the design of the function has been borrowed from the functions of picohttpparser.  But in the case of this function we do not need to distinguish parse errors and empty input (or incomplete input).\n\nThe caller of the function can (and does) simply ignore the result if the function returns `NULL`, so changing the meaning of the last argument as suggested will not have any side effects.  OTOH it would simplify the design of the function.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31984606/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31984719", "body": "Please assert `buf != buf_end` somewhere before here, or we might face buffer overrun (for example when the `range_value` is `{\"bytes=\", 6}`).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31984719/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31985282", "body": "Please change the name of `ows_skipped` to something like `needs_comma` to reflect the meaning of the flag.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31985282/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31985357", "body": "Please use else-ifs and flags instead of gotos in this case to simplify the code path.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31985357/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31985659", "body": "Please use `SIZE_MAX` instead of `-1` when assigning ~0 to `size_t`.\n\nI would also suggest removing variable `good_range`, ad using `range_start != SIZE_MAX` for determining if the parser has succeeded in extracting a valid range.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31985659/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31985826", "body": "I believe you do not need to check if `'-'` exists at the end of a single range (which is BTW accessing the buffer without boundary checking) if you unconditionally set `ows_skipped` (suggested to be renamed to `needs_comma`) unconditionally at the end of the do-while loop.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31985826/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431405", "body": "Call to `cloexec_pipe` (or an equivalent function) is missing.\n\nI presume that this is the reason why you are seeing timeout errors.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431405/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431461", "body": "Please move the includes and defines (e.g. `AI_ADDRCONFIG`) mandatory to use the functions provided by hostinfo.h to hostinfo.h, instead of repeating the definitions in each source file.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431461/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431556", "body": "For setting the nonblocking flag, please create a wrapper function for setting the nonblock flag in `h2o/include/socket.h` (marked as static the same way as other functions to be inlined are), and call the function from other places.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431556/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431661", "body": "For simplicity please do the following:\n- change the invocations of `writev` casting the second argument to `struct iovec *` to casting to `void *`\n- change the type of the second argument in the definition of `writev` for WIN32 to `h2o_iovec_t *`\n- remove the definition of `struct iovec`\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431661/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431688", "body": "Is there any reason to prefix (or suffix) the names with `socket`?\n\nIMO it would be preferable to continue using names like `read`, `errno`, `close`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431688/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431753", "body": "`sys/select.h` is part of POSIX (http://pubs.opengroup.org/onlinepubs/009696899/basedefs/sys/select.h.html) and therefore does not need to be surrounded by `#if`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431753/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431787", "body": "If there is no guarantee that tv_sec is of type `time_t`, IMO you should copy the value instead of enforcing a pointer typecast.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431787/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431911", "body": "Why do you set hostname?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431911/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431928", "body": "Can we move the call to the `main` function?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431928/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33432194", "body": "Sorry, I was confused.  Please leave the code as is.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33432194/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33432231", "body": "Understood.\n\nIf that is the case, please rename `writev` to `writev_socket`, and add `#define writev_socket(fd, iov, iovcnt) writev((fd), (void *)(iov), iovcnt)` on the Unix-side.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33432231/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33464311", "body": "> In cloexec to setup fds[0] and fds[1] on windows we have to create the socket before hand\n> This means we need to know if it is tcp or udp a stream etc beforehand which I don't think we know at this point ?\n> This is done in the set_cloexec function\n\nIn the unix-side, fds[0] and fds[1] are initialized by calling `cloexec_pipe` (which in turn calls `pipe(2)`).  So on the Windows-side, the descriptors should be initialized as well, before setting them to non-blocking mode.\n\nThe file descriptors being created are used for signalling between the threads, and the threads listen to the sockets using the event loop.  So I think on Windows you would need to create a pair of TCP sockets connected to each other under my understanding that the HANDLEs created by `CreatePipe` cannot be passed to `select`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33464311/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33464796", "body": "> libuv seemed like the easiest one as it already supports windows and mingw-w64.\n> Your thoughts ?\n\nThe H2O standalone server only supports the embedded event loop (evloop).  Libuv binding exists for users of libh2o (since it is a popular event loop that is used, with rich documentation and other protocol bindings that application developers can use).\n\nI agree that porting the libuv-side would be faster, but if your intention is to make the H2O standalone server runnable on Windows, you would need to port evloop (and it seems like that you have already done that to some extent!).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33464796/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33467718", "body": "> Yes I did this yesterday evening using the socket function and making it a stream socket with ipv4 support and tcp but it didn't change much in that the in ev-loop mode example-httpclient hangs (still stuck in the loop)\n\nTo which part of the callbacks does the client proceed?  exmaples/libh2o/http1client.c defines a number of callbacks that are called one by one.  `on_connect` is called first, then `on_head`, and `on_body`.  You could also set breakpoints to (or emit logs in) the callback functions within socketpool.c or http1client.c to determine which callbacks are called, and which are not.\n\nThat would help you analyze the cause of the issue.\n\n> Should I focus on the evloop version first or the libuv ?\n\nThat depends on what you want to do.\n\nIf your intention is to use libh2o, then you should better concentrate on libh2o and the examples under examples/libh2o.  OTOH if your intention is porting the standalone server to Windows, I would suggest concentrating on evloop and then working on the libuv-side.\n\nPersonally I did not expect somebody to start porting the standalone server to Windows, and am fascinated by how far you have achieved so far.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33467718/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33465442", "body": "Names defined in public headers must be prefixed with `h2o_` (or in this case `h2o_mruby_`).\nPlease either prefix the names, or move the definitions to somewhere within the source files.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33465442/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33465766", "body": "You do not need to duplicate the string here, since it is guaranteed that the data in `yoml_t` will not be freed until the configuration completes.\n\nI suggest to stop calling `h2o_strdup` here (since if you do so you would need to free it somewhere else, which does not seem to be done), and instead do the duplication within `h2o_mruby_register`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33465766/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35285306", "body": "The correct way would be to set `content_length` to `SIZE_MAX` regardless of the value, and let the chunked filter encode the outputs of the gzip filter.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35285306/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35285699", "body": "IMO there is no need to tweak window bits or memory level.  There is no need to define a custom callback for zalloc and zfree (the callbacks should be left NULL so that zlib would use the default ones).\n\nAll you need to do is delay the call to `deflateInit` (you do not need the flexibility provided by `deflateInit2`) until the first octet is received in `send_gzip`, and if `is_final` flag is set, call `deflateEnd` right after calling `deflate`.\n\nIf we implement the feature as such, the number of deflate contexts would be one-per-thread for small-sized responses, meaning that the impact on memory footprint would be minimal (and that is why you do not need to tweak window size or memory level for small responses).  It can also be said that allocating a fixed size of memory for every deflate context will actually be faster than allocating different sizes of blocks depending on the size of the response considering how `malloc` is implemented (in short, they have some kind of pool).  And in case the size of the content is large, window size and memory level cannot (should not) be reduced.  Therefore, there is no need to _tune_ the values (or the memory allocation functions).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35285699/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35285887", "body": "What you need to do here is:\n- allocate outbufs if it is not allocated yet, or reuse the outbufs\n- emit compressed data to outbufs, and pass it to the next stream (you may need to grow the outbufs while performing compression)\n\nIt is guaranteed that send_gzip will not be called until all the data sent to the next filter is sent to the client; therefore you can simply reuse the buffer when `send_gzip` is called again.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35285887/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35285902", "body": "Yes.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35285902/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35644932", "body": "You should not call `h2o_mem_alloc_pool` for every invocation of `send_gzip`.\n\nInstead, you should keep the pointers to the memory block allocated by `h2o_mem_alloc_pool`, and reuse the block when `send_gzip` is invoked more than once (for a single response).\n\nThis is because:\n- memory allocated by `h2o_mem_alloc_pool` using `req->pool` is not freed until the request object is discarded\n- when `send_gzip` or any other `do_send` callback is invoked there is a guarantee that all the data that has previously passed to downstream is already sent to the client; in other words, you can reuse the buffer \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35644932/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35760281", "body": "Sorry I misread your code.  It _is_ doing what it should do!  Sorry.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35760281/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/44239893", "body": "please include all headers regardless of whether if the request is a websocket handshake.  Application servers may use the information provided by the headers (e.g. x-forwarded-for) to determine if it should allow opening a websocket connection.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/44239893/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/44239937", "body": "Let's rename this file (and websocket_proxy.h) to tunnel.c (and .h), and let them concentrate on tunneling the data.\nIMO it can be used for other purposes as well.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/44239937/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/44240077", "body": "As part of changing the purpose of the file to handle L4 tunneling (instead of websocket proxying), please move this function (and `h2o_websocket_proxy_hs_success`) to lib/core/proxy.c, and instead expose a function that starts tunneling between two sockets.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/44240077/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/52250748", "body": "Isn't it more natural to expose port 80 / 443?\n\nIf that is the case, you should also remove `USER` from Dockerfile and use `user` directive in `h2o.conf`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/52250748/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/51379595", "body": "Memory allocated for `h2o_socket_t *` must be released by one of the event loop handlers when their states get updated (e.g. at https://github.com/h2o/h2o/blob/5e828100f261bc9952cbf8031fbfb1ef05286591/lib/common/socket/evloop/epoll.c.h#L47).\n\nIf you are seeing a leak for `queue->async.read` being reported, then I believe it should be fixed by making the application run the event loop once more.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/51379595/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/60622942", "body": "Please add `| H2O_CONFIGURATOR_FLAG_EXPECT_SCALAR` to the flags of the two directives, so that configuration error would be displayed before calling the callbacks if a sequence or a mapping is specified as the values.\n\nPlease also add `| H2O_CONFIGURATOR_FLAG_DEFERRED` to `display-server-name` to guarantee that the callback will be called _after_ `server-name` is handled.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/60622942/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/60623463", "body": "Together with https://github.com/h2o/h2o/pull/877/commits/75a3c723799dbf618f27ecbc1bc30ab2813756db#r60622942, you can simply use `h2o_strdup(NULL, node->data.scalar, SIZE_MAX)` as the server name.\n\nAnd doing so makes me happy because I do not need to worry if support for the `m` specifier (introduced in POSIX.1-2008) is supported on various platforms :-)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/60623463/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/60623654", "body": "Can the name be changed to `send-server-name`?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/60623654/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/62120997", "body": "Please change the name to `h2o_socket_get_fd`.  I would like to have all the socket APIs have `h2o_socket_` as the prefix.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/62120997/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/62121260", "body": "How about definiding the external function directly in evloop.c.h and in uv-binding.c.h, instead of having two layers (i.e. h2o_get_sock_fd and do_get_sock_fd)?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/62121260/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/62237096", "body": "Maybe `req` should be `self->src_req`?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/62237096/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63498013", "body": "@shohex Definitely! Thanks for noticing that.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63498013/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64156613", "body": "Let's change `tokens` to a signed value (possibly `ssize_t` or `int64_t`, see https://github.com/h2o/h2o/pull/917/files#r64156791), and send immediately if current value of `tokens` is greater than zero.  I believe it would be safer to first send some data and then throttle, rather than to first throttle and then send.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64156613/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64156704", "body": "`add_token` should be called at constant pace while the filter is open.  In other words, I believe you should:\n- call `h2o_timeout_link` in `on_setup_stream` (when the filter is opened), and in `add_token` (when the timeout gets fired)\n- call `h2o_timeout_unlink` in `real_send` if `on_send` has received `is_final`\n- call `h2o_timeout_unlink` (if timeout is linked) in `on_stop`\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64156704/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64156791", "body": "We might need to take care of overflow here, especially in case `tokens` is a 32-bit value.\nFor example in case the bitrate is 10MB/sec and `tokens` is a 32-bit value, and if the upstream is stalling, `tokens` would overflow in 409 seconds.\n\nOne easy fix to the issue would be to change `tokens` to a 64-bit type.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64156791/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64160174", "body": "You can store the number of vectors being sent in `bufs.size` and remove `inbufcnt`, while referring to `bufs.capacity` to determine if the buffer should be expanded.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64160174/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64674909", "body": "I think you can replace this _if_ block with a single call to `h2o_vector_reserve(&req->pool, &self->state.bufs, inbufcnt)` and also remove the definition of `expand_buf`.\n\n`h2o_vector_reserve` expands the number of slots in `entries`, and sets the number of slots available to `capacity`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64674909/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64675628", "body": "Please add `use Time::HiRes qw(time);` to the top of the file so that `time` would return a floating point number.\n\nWith the change, I think you can increase the value of `x-traffic` to somewhere around 100000 to save time spent in running the test, thanks to more accurate measurement.\n\nOther than that, the test looks fine.  Thank you for your effort.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64675628/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63348890", "body": "How about having a single type that optionally defines `per_thread_cb`, instead of having two distinct types.\n\nFor example, we could define three callbacks: `init`, `per_thread`, `final`, with the first two being optional callbacks. `final` should either a) gather the information obtained by calls to `per_thread` (that updates the struct costructed by `init`), or b) simply return the information available in a global storage (in this case, `init` and `per_thread` can be set to NULL).\n\nAlso, you cannot allocate memory from `req->pool` in a different thread (than the request belongs to).  Therefore, you should not pass `src_req` to `alloc_context_cb` (and considering the fact that the status handler is rarely called, I think it is not mandatory to use memory pools in the handler).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63348890/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63348994", "body": "Please rename the struct to `struct st_h2o_status_handler_t` (since others have `st_` prefix and `_t` suffix).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63348994/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63351201", "body": "Please refrain from using GCC extensions, since it will make porting H2O difficult.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63351201/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63351622", "body": "Let's move HTTP/2 protocol errors inside `h2o_context_t::http2`.  And we can simply access the error array for HTTP2 using an index, since HTTP/2 errors are defined starting from 1 in the spec.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63351622/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63353872", "body": "Re logging of status codes.\n\nMy understanding is that the intention is not to log the status codes in general, but is to log the errors that originated within H2O.  That means that the source of the error and the logic that updates the counter can be tightly coupled, and IMO we should better couple them instead of passing the number as a value and then using switch-case to determine the slot for two reasons: 1) speed 2) ease of maintenance.\n\nThere could be various ways to couple them, but my two cents go to the following approach.\n1. rename `h2o_send_error` to `h2o_send_error_generic` (or something)\n2. rewrite invocations of `h2o_send_error` taking constant status codes to `h2o_send_errorXXX`, where XXX is the status code.\n3. define all the `h2o_send_errorXXX` functions using macro expansion.  The functions should increment the corresponding counters and then call `h2o_send_error_generic`\n\nHow does it sound?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63353872/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63354636", "body": "Should `noreqs` better be renamed to `stats-only`?  I assume that is what you want.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63354636/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63461209", "body": "Thank you for the changes.  The commit looks good.\n\nSome additional comments from me are as follows.  How do they sound?\n1. instead of updating the counters in `h2o_send_error_deferred`, rename the function to `h2o_send_error_generic_deferred` that does not do the update, and instead modify the counters at the location that calls the deferred function\n2. with 1 being done, we can remove h2o_context_report_http1_error\n3.  remove E_HTTP4xx or E_HTTP5xx now that we have all the error codes that updates the counter hard-coded\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63461209/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63463318", "body": "I believe you do not need to retain a pointer to h2o_globalconf_t.  It can be reached by accessing `h2o_context_t::globalconf`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63463318/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63463545", "body": "How about calling `h2o_contains_token` within `on_req_json` for each of the status handlers, instead of building a list of selected names using this function?\n\nAlso, I would suggest using `,` as the separactor instead of using `|` (note that `|` is a reserved character in the URI syntax).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63463545/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63463687", "body": "Thank you for the update.\n\nI like the current approach (using a positive list).  Left in-line comments regarding the details of the implementation.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63463687/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63465056", "body": "How about moving the definitions of `H2O_HTTP2_ERROR_*` in http2_internal.h here, instead of trying to define a separate enum?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63465056/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63465083", "body": "Should we better use uint64_t?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63465083/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64183224", "body": "Should we better invoke `h2o_send_error_XXX` in the callers of `entity_read_send_error` to collect the error codes?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64183224/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64186687", "body": "Do we need to log read / write errors?\n\nIf so, I would suggest separating the structures that count the HTTP/2 error codes and the internal errors (read / write errors), rather than adding a privately-defined slot to the list of HTTP/2 error codes.\n\nRead / write errors could be logged more directly (for example by incrementing the counters directly like `++ctx->http2.events.read_closed`).  And also, the code and the structure for counting the HTTP/2 protocol-level errors could be renamed to better reflect the purpose.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64186687/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64187650", "body": "Unless there is a specific reason, I believe we should not allow `init` callback to fail.\n\nThey should be implemented to always succeed (and that makes the code that calls the handlers simpler), and in case there is a chance of a init callback to fail, then the status handler should retain the error within the handler and emit an error message as part of the JSON when its `final` callback is called.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64187650/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64187881", "body": "Please change the names to `H2O_STATUS_ERROR_XXX`\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64187881/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64187947", "body": "The type should be changed to `uint64_t` as well.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64187947/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64188090", "body": "Please surround the name with `st_XXX_t`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64188090/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64188256", "body": "Please surround the struct with `st_XXX_t`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/64188256/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65019989", "body": "Please rename the errors to `status-errors`, as discussed in https://github.com/h2o/h2o/pull/893#commitcomment-17607549.\n\nI believe that is the only change required to getting this merged.  Thank you!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65019989/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65254626", "body": "Should we better change the operator to `<` since the variable defines the minimum size that gets compressed?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65254626/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65254930", "body": "Would you mind changing the name of the configuration directive (as well as the functions) from using `min` to `minimum`?\n\nI ask this because we already have a property named `minimum-version` in the SSL configurator, and I am afraid people might get confused between the use of _min_ and _minimum_.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65254930/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65470194", "body": "Is there any reason not to use arc4random on other platforms using ARC4 as the RNG?  I believe ARC4 is still better than `rand()`.\n\nIf you think we should better use `arc4random` on all BSD-based platforms, please update the conditional macro to `#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__NetBSD__) || defined(__OpenBSD__)`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65470194/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65470229", "body": "Aren't the functions (e.g. `rand`, `arc4random`) defined in stdlib.h?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65470229/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65470468", "body": "Could you please change the seed to `time(NULL) ^ getpid()` (and that means that we should include unistd.h as well)?\n\nThe reason I suggest this is because the ticket updater defined in src/ssl.c uses `sleep(rand())` to avoid collision between the server processes, and therefore it is desirable to have different random number sequence for servers that get spawned at the same moment.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65470468/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65470611", "body": "Do you mind if the copyright gets written as `Copyright (c) 2016 David CARLIER`?\n\nWe generally do not request transfer of copyright when accepting a PR.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65470611/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65484190", "body": "Thank you for the answer.\n\nConsidering how we use the random numbers, I think the speed of RC4 wouldn't be an issue for us.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65484190/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65484267", "body": "Ah.  Files under `include/h2o/` should be usable without including `h2o.h`.  Sorry for the confusion.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65484267/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65485225", "body": "Should be `srand(time(NULL) ^ getpid())`? I anticipate that's why travis is failing.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65485225/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70753295", "body": "How about renaming `escape` to `use_path_normalized` or something to better indicate that it is a selection between `path` and `path_normalized`?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70753295/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70753569", "body": "How about using `req->path` instead of `req->input.path` and also removing the check of `req->res_is_delegated` in the if statement above?\n\nThat way, I assume we can use the unnormalized path for both before and after delegation (note: I believe the proxy handler should use the unnormalized path independent to how the URL is given (e.g. via an HTTP request or via a X-Reproxy-URL header)).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70753569/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70881110", "body": "Please use `h2o_iovec_init` for constructing `h2o_iovec_t` to check that it is initialized correctly at compile time.\n\nCompound initialization in C (i.e. `(struct foo){...}`) allows omission of following members, however in case of `h2o_iovec_t` we _must_ initialize all the properties.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70881110/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70881790", "body": "Did you mean `free(norm_indexes)`?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70881790/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70882024", "body": "Also, please test the values of `norm_indexes[0]` (I believe it contains a valid value).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70882024/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71324110", "body": "Do you think it would be a good idea to define this logic erasing `./` as a macro and use it at the tail of the function for handling `.` at the end of the function?\n\nI believe same thing could also be done for between the handling of `../` and `..` at the end of the function.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71324110/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70724704", "body": "How about  changeing arguments of `decode_string` to `h2o_mem_pool_t *pool, const uint8_t **src, const uint8_t *src_end, int is_header_name, const char **err_desc)`?\n\nBy changing as such, I believe the code would become simpler since you can do all the checks in `decode_string` function without using `H2O_HUFF_ENCODED` flag.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70724704/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70724813", "body": "How about using HTTP response level error notification for invalid header names as well?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70724813/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70726439", "body": "I would appreciate it if you could refrain from using `stdbool.h`.\n\nWe allow the header files of H2O to be included from C++ (which means that `bool` might be a C++ type), and therefore my preference is to not use `bool` in our code (but instead use `int` or `char` for the purpose) to avoid confusion.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70726439/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70726676", "body": "Do we need to have this checked here? My understanding is that it is done in `h2o_hpack_parse_headers`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70726676/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71006289", "body": "Do we need to distinguish between `H2O_HTTP2_ERROR_INVALID_HEADER_NAME` and `H2O_HTTP2_ERROR_INVALID_HEADER_VALUE`?\n\nIf not, let's merge them into a single error code. The detail can be found in `*err_desc` anyways.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71006289/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71006515", "body": "Please uppercase `h`. Every word in the reason phrase is generally uppercased.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71006515/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71007278", "body": "How about implementing the check using a single big `if (is_header_name) { ... } else { ... }` block? IMO doing so would improve readability as well as reduce the number of conditional branches.\n\nAlso, I think you would need to test the length of the header name before evaluating `ret->base[0]` (and return an invalid header\u00a0error if the length is zero).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71007278/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71007428", "body": "The discussion on the huffman-encoded side applies to these blocks as well.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71007428/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71325566", "body": "I think we do not need to retain the value, since if a soft error has occurred can be found by checking the value of `err_desc`, and in such case the error code would always be `H2O_HTTP2_ERROR_INVALID_HEADER_CHAR`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71325566/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71326200", "body": "In relation to https://github.com/h2o/h2o/pull/974/files#r71325566 I think there's no need to introduce `ret`. When reaching the bottom the function, the return code would either be `0` or `H2O_HTTP2_ERROR_INVALID_HEADER_CHAR` depending on if `*err_desc` is NULL.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71326200/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71327641", "body": "In current implementation it seems that you might mis-record errors for headers following an invalid header.\n\nPlease correct me if I am wrong (I am leaving this comment without actually running the code), but I would appreicate it if you could cover such scenario in the test case regardless of if my observation is correct or not.\n\nAssuming that the issue exists, I think you would need to create a local value for `err_desc` initialized to NULL, and pass pointer to the created value when calling `decode_header`. And I believe that `h2o_hpack_parse_headers` should return the first soft error observed (in case no other error happens).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71327641/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71328038", "body": "I think you could use test the value of `*err_desc` to determine the code that should be returned by this function.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71328038/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71763946", "body": "I think you would also need to adjust the return code as well.\n\nPersonally, I do not mind if this path was slow and/or written in two path (I'm not suggesting that this should be two path, I am just trying to say that there's no need to take care about speed), since it's an error path, and since it is not the _slowest_ path (I anticipate that HPACK decoder is slower). In other words, this path doesn't get frequently executed, nor is it an attractive target of a DoS attack.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71763946/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71764562", "body": "This looks like a constant if. I assume you were in hurry :-)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71764562/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71824565", "body": "Ah, you are right. Sorry for the fuss.\n\nI think the confusion came from the fact that the name of the function (`contains_invalid_field_name_char`) pretty much asserts that it is a function that returns a boolean value (note that `contains_invaild_field_value_char` works that way). However, `contains_invalid_field_name_char` is actually returning if the validation should be stopped.\n\nI would appreciate it if you could adjust the name (or possibly the signature of the function as well) to avoid the confusion.\n\nPersonally, I would think of changing the function to `const char *validate_header_name(const char *, size_t)` that returns `NULL` if validation succeeds, or an error string if it fails. After obtaining the error string, you could do a pointer comparison to see if it is a hard error or a soft error.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71824565/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73261112", "body": "How about invoking the callback regardless of if an attack was detected?\n\nI believe it would be better to do in each callback check the `detected` flag and perform appropriate action (return 399, 403, etc.), since doing so would reduce the code paths that needs to be taken care of when writing a custom callback.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73261112/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73280152", "body": "Sorry, one more thing.\n\nLet's pass in `env` possibly as the first argument to the callback, so that a Rack handler can be called from within.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73280152/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74855667", "body": "2.1!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74855667/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73813329", "body": "Is my understanding that `satisfy?` is called for every request? If so, please move the call to `instance_eval` to somewhere during the initialization phase.\n\nTo generalize, I think we should refrain from calling slow functions (e.g. `instance_eval`) while processing each request.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73813329/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73813437", "body": "Would it be possible to merge `ACLHandler` and `ACLBlock` into one class?\n\nThe reason I ask is because `ACLHandler#call` invoking the proc returned by `ACLHandler#_to_handler` for every request looks like a waste of CPU cycles (and because I cannot see why we need such indirection).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73813437/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73813748", "body": "Assuming that the only difference between `mruby_config.rb` and `mruby_test_config.rb` is the addition of `iij/mruby-mtest`, how about adding the library to `mruby_config.rb` instead of introducing a new build of mruby?\n\nOr another approach would be to keep `mruby_config.rb` as-is and call `require` to load `mruby-mtest` when running the unit tests (note: we already have https://github.com/h2o/h2o/tree/master/deps/mruby-require as a dependency).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73813748/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73813860", "body": "Considering the fact that building H2O without mruby support is a legitimate option, It would be great if you could emit a more polite message when the tests need to be skipped.\n\nMaybe you should run the code below (which can be found in other tests), and then check the existence of `mruby` binary (in which case, you should emit a hard error considering the fact that the server is built _with_ mruby support).\n\n```\nplan skip_all => 'mruby support is off'\n    unless server_features()->{mruby};\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73813860/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73813948", "body": "Maybe rename to `respond` (verb)?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73813948/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73814567", "body": "Thank you for implementing the check in the way I suggested in our discussion.\n\nI am sorry to say this, but after reading this, I think we should better let the mruby script _set_ an optional callback for validating the Rack handler, instead of having a hard-coded check implemented in the C side. WDYT?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73814567/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74529311", "body": "Please use `misc/dump-github-repository.pl` to dump mruby-mtest into `misc/mruby-mtest`. Run the perl script without arguments to find out how to use the program.\n\nThe reason we should do so is because tarballs created by GitHub will not include submodules; files required for building and testing H2O should never be a git-submodule.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74529311/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74530203", "body": "Doesn't this assignment cause the _last_ access-control directive to be registered to both `@acl` and `@returned`?\n\nGeneralizing the issue, it is unclear to me why we'd want to return values from each directive (e.g. `allow`, `deny`). If there's a need to do so, please explain why (and also create a test case covering such use-case). If there's no need, we should stop returning values from the directives and delete `@returned`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74530203/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74872120", "body": "Just one more thing...\n\nHow about doing all of the following?\n1. renaming h2o.rb to bootstrap.rb\n2. require and include the acl code _from_ bootstrap.rb\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74872120/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75060390", "body": "Can we expect adequate information emitted to the log in case either requiring preloads.rb or doing the requires in preloads.rb fails?\n\nIf the answer is yes, I think we can merge this PR right away.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75060390/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74534065", "body": "Is this change relevant to the PR?\n(and I believe we should use `text/plain` considering the fact that it can be displayed using web browsers...)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74534065/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74534739", "body": "All `inline` functions must be also defined as `static`.\n\nAlso, I would suggest refraining from creating bridges (i.e. a function that just calls another function), since it makes the code-base unnecessary complex. Our general preference goes to keeping the code-base compact and precise, rather than minimizing impact of each PR.\n\nIn this case, I would suggest changing `static inline struct st_h2o_hpack_header_table_entry_t *header_table_get(...)` to `h2o_hpack_eader_table_entry_t *h2o_hpack_header_table_get(...)`. Even without `inline` attribute, compilers are allowed to (and will) inline-expand functions defined in the same source file as the caller.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74534739/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74535077", "body": "s/coma/comma/g?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74535077/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74535127", "body": "I would appreciate it if we could use memory less aggressively. In the current implementation, `OUTPUT` allocates 2KB chunk, and that means that we would consume at max 2*(100+100)=400KB of memory here.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74535127/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74535240", "body": "Please use `%.*s` and specify the lengths of the values using `->len` for both `name` and `value`.\n\nAlso, please consider the case in which the name (or value) is very long. Current approach of allocating a fixed amount of memory would not work well.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74535240/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74693806", "body": "You cannot do this.\n\n`h2o_token_t` is an object that be compared by checking their address. To achieve such property, a string contained by a token MUST be interned (i.e. only one `h2o_token_t` should exist within the entire program for each string). Trying to define a token in each source file collides with the requirement.\n\nYou should instead use `h2o_add_header_by_str` for registering a header that is (either guaranteed or might) not be a token.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74693806/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74693812", "body": "Use of `size_t` is preferred unless you need to use negative values to represent error conditions.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74693812/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74693849", "body": "I believe `conn->state == H2O_HTTP2_CONN_STATE_HALF_CLOSED` would be sufficient to see if a GOAWAY frame has been sent. Please refer to the comments on `h2o_http2_conn_state_t`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74693849/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74693894", "body": "I'd suggest making this a function (instead of macro), considering the fact that the arguments are evaluated more than once, and because this is not performance-critical.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74693894/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74693896", "body": "Let's also make this a function, so that it would be easier to maintain.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74693896/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74694031", "body": "State of a pulled stream changes to `half-closed (remote)` as soon as a HEADER or CONTINUATION frame with the `END_STREAM` flag being set is received by the server.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74694031/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74855929", "body": "Please move the prototype to http2_internal.h, since the function is going to be referred to via callback from outside of the http2 stack.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74855929/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74856231", "body": "Please rename the struct back to `h2o_http2_debug_state_t`, since the structure is dependent to HTTP/2 (as per defined by the I-D, right?). And same goes for the callback name.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74856231/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74856639", "body": "Please completely revert the changes made to lib/core/token_table.h (and lib/http2/hpack_static_table.h), so that the file would be left unchanged upon PR merger.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74856639/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74856988", "body": "How about defining this as a configuration directive that takes a scalar argument of `minimum`, `hpack`? Doing that way, we can eliminate the complexity of handling a mapping.\n\nThe handler would be _off_ in case the the configuration directive is not used.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74856988/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74857037", "body": "Simply returning -1 (so that the next generator would handle the request) might be sufficient.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74857037/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74857431", "body": "Please use `__attribute__((format(printf, xxx, yyy)))` extension to detect errors in format specifiers. Examples can be found in the headers of H2O, and I assume documentation can be found on gcc.gnu.org.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74857431/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74857568", "body": "Please use `va_copy`. Applying `va_start` more than once against one `va_list` is not permitted (IIRC the behavior is undefined).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74857568/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74857819", "body": "Let's call h2o_vector_reserve in `append_line` instead of trying to determine the correct length of the output here.\n\nThis is not a performance sensitive handler, and minimizing the risks of having issues should be given higher priority than optimization.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74857819/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74872470", "body": "maybe add `static`?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74872470/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74873074", "body": "> `state->json.entries[state->json.size - 1].len > 0`\n\nI'm not sure what this check is trying to accomplish.\n\nIf there is a chance that `append_line` inserts a chunk of zero characters, I would suggest fixing `append_line` to _not_ do such a thing, since it is a waste of space.\nIf there is a guarantee that `append_line` always emits more than one character, then we do not need this check (or if that is an obligation of `append_line`, then you should assert that within the function, not here).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74873074/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74873149", "body": "Renaming this function to `append_block` or `append_chunk` might be a good idea considering the fact that this function is never used to append a _line_ (and same goes for `append_header_table_lines`).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74873149/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74877459", "body": "Please include system headers first and then project-specific headers.\n\nThis is necessary since we _might_ want to override some system-defined headers.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74877459/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74883638", "body": "If you want a boolean, please use `unsigned : 1` that takes either 0 or 1. `int :1` takes two either 0 or -1.\n\nOr simply using `int` or `unsigned` without `:nnn` would be sufficient in this case, considering the fact that the size of the struct would be indifferent and that we wouldn't have many instances of this struct.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74883638/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74887064", "body": "I assume you can change `!comma_removed` to `i == 0` (and thereby eliminate `comma_removed`)?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74887064/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74887280", "body": "It might be preferable to do the following instead so as not to leave trailing spaces.\n\n```\nchunks->entries[chunk->size - 1].base += 1;\nchunk->entries[chunk->size - 1].len -= 1;\n```\n\nIt _might_ be better to define the logic as a separate function, since you would want to do the same at other parts of the code as well.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74887280/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74888513", "body": "P.S. the other method you can use is to have comma appended to every element and then remove the last comma, or rewrite the first comma to { or [.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74888513/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75064100", "body": "Assuming that all the structs used inside the function is defined in the headers, would it be possible to change this function to a static inline function declared and defined in http2_internal.h?\n\nPlease refer to other inline functions defined in http2_internal.h to how to define a global function as inline (in essence, declare as `static` and, define as `inline`).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75064100/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75064324", "body": "Please do not insert a comment taking a line within a if statement (without using a block), since it is counterintuitive.\n\nYou should write the comment either _above_ the `if` keyword or surround the comment and the statement that is executed if `if` evaluates to true using `{}`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75064324/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75082868", "body": "wrong filename? :-)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75082868/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75082984", "body": "unnecessary blank line here?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75082984/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75256208", "body": "Maybe you need to zero-clear the allocated memory; i.e. `memset(ctx->storage.entries + ctx->storage.size, 0, (*key + 1 - ctx->strorage.size) * sizeof(ctx->storage.entries[0]);`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75256208/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75256327", "body": "How about _not_ passing `h2o_context_t`, considering the fact that it would already be partially destructed when the callback gets called?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75256327/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75256594", "body": "How about defining the type as `H2O_VECTOR(h2o_context_storage_item_t)`?\n\nI believe there is no reason to separately allocate each item. Using a flat struct (opposed to list of pointers) would reduce number of allocation and CPU cycles spent for accessing the values.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75256594/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75256948", "body": "Also, please pass-in the `data` pointer as the first argument instead of `h2o_context_storage_item_t`.\n\nThat's the design generally found in H2O (and in C, IIRC).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75256948/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75258475", "body": "The code might become more concise if you change the signature of `h2_context_get_storage_index` to `void **h2o_context_get_storage(h2o_context_t *ctx, size_t *key, void (*dispose_cb)(void *))`, letting the function return the address of the slot (instead of an index) as well as setting the dispose callback at the same time.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75258475/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75258594", "body": "As a general rule, I would suggest defining static function above the point of use to merge the definition with declaration.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75258594/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75258761", "body": "Can you please elaborate why any change to boostrap.rb is necessary in this PR?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75258761/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75409469", "body": "How about resetting `@@handler_validators` before evaluating the mruby script?\n\nYou could either do it by adding a method to H2O for the purpose and calling it, or you could bring the code in bootstrap.rb into mruby.c and also reset `@@handler_validators` directly in C as well.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75409469/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75417212", "body": "Maybe we should better call the dispose function without checking the value of `item.data` (since the dispose function is setup before `data` is set up).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75417212/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75417295", "body": "This is kind of a nitpick but maybe you would want to do `h2o_context_storage_item_t *item = ctx->storage.entries + i` to avoid copy.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75417295/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75615357", "body": "Maybe you need to free `shared_ctx`?\n\nAlso, it might be a good idea to rename the function to `dispose_shared_context`, since it disposes the context created by `create_shared_context`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75615357/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75615586", "body": "Maybe it would be better to introduce a `reset` method to `H2O::ConfigurationContext` and call it, instead of having duplicate logic here and at t/00unit.mmruby/acl.rb.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75615586/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75615641", "body": "Considering the fact that you have a method named `add_...hooks`, it might be better to rename the method to `call_..._hooks`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75615641/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75749754", "body": "is exactly equal~~s~~ to\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75749754/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75749976", "body": "It might be polite to use one of the reserved domain names for examples (i.e. those defined in https://tools.ietf.org/html/rfc2606 and other docs).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75749976/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75751705", "body": "`Every ACL method can be accompanied by a condition block, which should return boolean value.` \u304b\u306a\u3068\u601d\u3044\u307e\u3059\u3002\u307e\u305f\u3001`If condition block is missing` (\u3053\u308c\u306f `If a condition block is omitted` \u304b\u306a) \u306f\u3001\u6b21\u306e\u6bb5\u843d\u306e condition block \u304c\u3042\u3063\u305f\u5834\u5408\u306e\u300c\u3042\u3068\u306b\u300d\u8a18\u8f09\u3059\u3079\u304d\u304b\u306a\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75751705/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75752470", "body": "\u6b21\u306e\u6587\u304c\u3001\u5168\u3066\u306e\u30d5\u30a3\u30eb\u30bf\u304c\u30de\u30c3\u30c1\u3057\u306a\u3051\u308c\u3070\u3001\u3068\u3044\u3046\u6761\u4ef6\u306b\u3064\u3044\u3066\u8ff0\u3079\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u306e\u6587\u306f\u3001\u6700\u521d\u306b\u30de\u30c3\u30c1\u3057\u305f\u30d5\u30a3\u30eb\u30bf\u304c\u3001\u3068\u3044\u3046\u6761\u4ef6\u306b\u3064\u3044\u3066\u66f8\u304f\u3079\u304d\u306a\u3088\u3046\u306b\u601d\u3044\u307e\u3059\u3002\n`The filter defined by the method that first matched the accompanying condition gets applied (e.g. ...).` \u3067\u3057\u3087\u3046\u304b\u3002\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75752470/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75752683", "body": "`If none of the conditions matches the request` \u304b\u3057\u3089\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75752683/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75753152", "body": "\u7701\u7565\u3055\u308c\u3066\u3044\u308b\u4e3b\u8a9e\u306f \"The directive\" \u306a\u306e\u3067\u3001\u8ff0\u8a9e\u306f\u4e09\u4eba\u79f0\u5358\u6570\u3067\u3002\u3064\u307e\u308a Adds a filter which delegates...\n\n\u4ed6\u306e\u3068\u3053\u308d\u3082\u540c\u69d8\u3067\u3059\u3002\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75753152/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75753457", "body": "`In a condition block` \uff08\u3053\u3046\u3044\u3046\u5834\u5408\u3001\u5358\u6570\u306e\u307b\u3046\u304c\u4e00\u822c\u7684\u3060\u3068\u601d\u3044\u307e\u3059\uff09\n`which return particular properties of the request as string values` \u304b\u306a\u3041\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75753457/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75753549", "body": "in _a_ condition block\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75753549/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75753643", "body": "s/use X-Forwarded-For header/returns the value of X-Forwarded_For header/?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75753643/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75753927", "body": "s/Requied/Required/\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75753927/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75754197", "body": "Several restrictions are introduced to avoid misconfiguration when using <code>all</code> method. \u3068\u304b\u3067\u3057\u3087\u3046\u304b\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75754197/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75754468", "body": "the handler returned by the configuration directive must be the one returned by the acl method \u3068\u304b\u3067\u3057\u3087\u3046\u304b\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75754468/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75754527", "body": "s/abort/refuse to launch/ \u3067\u3057\u3087\u3046\u304b\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75754527/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75754787", "body": "s/are violating/violate/\ns/the server will abort/the server will refuse to start up/\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75754787/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75754820", "body": "s/ too//\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75754820/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75755885", "body": "\u5f15\u6570\u3072\u3068\u3064\u3072\u3068\u3064\u3092 li \u306b\u3059\u308b\u3053\u3068\u306f\u826f\u3044\u3068\u601d\u3046\u306e\u3067\u3059\u304c\u3001\u5404\u5f15\u6570\u306e\u8aac\u660e\u304c ul \u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u306f\u304a\u304b\u3057\u3044\u3088\u3046\u306b\u601d\u3044\u307e\u3059\u3002\n\u5f15\u6570\u7fa4\u5168\u4f53\u3092 dl \u3068\u3057\u3001\u5f15\u6570\u540d\u3092 dt \u8aac\u660e\u3092 dd \u3067\u66f8\u304f\u3068\u3044\u3046\u306e\u306f\u3069\u3046\u3067\u3057\u3087\u3046\uff08\u4ed6\u3067\u3082\u305d\u3046\u3057\u3066\u3044\u308b\u306e\u3067\uff09\u3002\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75755885/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75756125", "body": "\uff08\u7279\u306b\u76f4\u524d\u306e\u6587\u304c\u7d42\u308f\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u306e\uff09\u7b87\u6761\u66f8\u304d\u306b\u304a\u3044\u3066\u306f\u3001\u6587\u3067\u306f\u306a\u304f\u53e5\u3042\u308b\u3044\u306f\u7bc0\u3067\u3042\u308b\u3068\u3044\u3046\u8003\u3048\u65b9\u304b\u3089\u3001\u5c0f\u6587\u5b57\u3067\u59cb\u3081\u308b\u306e\u304c\u4e00\u822c\u7684\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75756125/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75791121", "body": "s/make it easy/makes it easy/\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75791121/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75791194", "body": "\u76f4\u524d\u306e\u6587\u3067 below \u3063\u3066\u6307\u5b9a\u3057\u3066\u308b\u304b\u3089\u3001\u3053\u3053\u3067 above \u3068\u518d\u5ea6\u9650\u5b9a\u3059\u308b\u5fc5\u8981\u306f\u306a\u3044\u304b\u3082\u3002\n\ns/the handler you got/the handler you get/\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75791194/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75791234", "body": "desc \u306f\u6587\u306a\u3093\u3060\u304b\u3089\uff08\u5192\u982d\u304c\u5927\u6587\u5b57\uff09\u3001\u6587\u672b\u306b\u30d4\u30ea\u30aa\u30c9\u3064\u3051\u3066\u304f\u3060\u3055\u3044\u3002\u4ee5\u4e0b\u3082\u540c\u69d8\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75791234/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75791253", "body": "s/Requied/Required/\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75791253/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74719976", "body": "I doubt if passing in a pointer to a pointer to `yoml_t` is a good idea. I believe that the filter callback should update the contents of `yoml_t` instead of altering the address. The reason is as follows.\n\nIn current model, configurators do not _own_ the nodes. In other words, configurators do not call `yoml_free` upon exit.\n\nBut if you are going to allow an update of pointer to `yoml_t` (by passing `yoml_t **`), then every caller of the filter function would need to do some extra work so that it would call `yoml_free` taking the updated pointer as an argument.\n\nMy understanding is that this is not done at the moment, and also that we would not want to such thing.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74719976/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74720005", "body": "Please use `h2o_mem_realloc` instead, so that we can consistently handle memory allocation failures.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74720005/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74720051", "body": "Maybe copying as a struct (i.e. `(*node)->data.mapping.elements[i + j] = include->data.mapping.elements[j];`) and then adjusting the refcounts would simplify the code.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74720051/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74720107", "body": "Can you please adjust the code so that the file and line number that included the file would become part of the error message?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74720107/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75745875", "body": "I do not think you would need this check (and that the `resolve_tag` function in `src/main.c` should increment the refcount before returning the node that is being passed in).\n\nI believe that the callback for tag resolution should return a node with its `_refcnt` incremented, if it decides to return the same node, since it would essentially mean that the callback is _duplicating_ the node being passed in.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75745875/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75746289", "body": "Please retain (i.g. increment `_refcnt`) when storing the node to the cache (and also release it when the cache is disposed of), to guarantee that all nodes stored in the cache are valid.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75746289/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75956269", "body": "Yes!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75956269/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74531287", "body": "You might want to convert either of `delta_sec` or `1000*1000L` to `int64_t` before multiplication, so that the operation would be done in 64-bit on ILP32.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74531287/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74531631", "body": "How about moving `diff_timeval` and `timeval_is_null` into include/h2o/time_.h as  `h2o_timeval_subtract` and `h2o_timeval_is_null`?\n\nWe should promote static functions found in multiple source files (in this case `lib/core/logconf.c`) to globals.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74531631/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74531861", "body": "Is my understanding correct that the logic of calculating these numbers is a duplication of that found in `lib/core/logconf.c`?\n\nAssuming that it is correct, how about creating inline functions in `h2o.h` that returns various durations (or a _null_ in some form), and use them from both logconf.c and durations.c?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74531861/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74532112", "body": "I _think_ you should create a large `#if JEMALLOC_STATS` surrounding the calls to `malloc_stats_print` and `mallctl` instead of relying on the compiler to strip code paths that never gets executed. Otherwise, linkers might report missing symbol errors when the source file is compiled with optimization turned off.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74532112/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75796571", "body": "s/substract/subtract/?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75796571/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75801132", "body": ">  in french, the word is \"soustraction\"\n\nOh! And I've just learned that sous-chef means sub-chef!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75801132/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75801591", "body": "How about merging the two functions as `int h2o_time_compute_##name(struct st_h2o_req_t *req, int64_t *delta_usec)`, and use the function from both logconf.c and durations.c?\n\nGenerally speaking, I think we should better refrain from introducing functions for just returning different types. Also, I think that the return value should be whether if the function succeeded.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75801591/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75953082", "body": "Could you please change `if (JEMALLOC_STATS) { ... }` to `#if JEMALLOC_STATS ... #endif`? The reason I suggested [this](https://github.com/h2o/h2o/pull/1017#discussion_r74532112) is since there is not guarantee that a compiler strips non-reachable code (i.e. the block inside `if (0) { }`). In such case, reference to `malloc_stats_print` would cause a link-time error.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75953082/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75953679", "body": "Thank you for the clarification.\n\nI appreciate your concern about performance.\n\nI think that in case we emit a log line it is highly likely that there are other stringifications will be performed as well (e.g. IP address, status code, content length, etc.), and that the impact of an extra multiply+divide would be negligible.\n\nOr I am open to changing the signature to `int h2o_time_compute_##name(struct st_h2o_req_t *req, struct timeval *delta_tv)` if it seems more adequate to you.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75953679/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75957295", "body": "\u7d30\u304b\u306a\u8aac\u660e\u306f\u5f8c\u306b\u3042\u308b\u306e\u3060\u304b\u3089\u3001desc \u306b\u306f \"A directive to turn on the HTTP/2 Implementation Debug State.\" \u3068\u306e\u307f\u66f8\u3044\u305f\u307b\u3046\u304c\u3088\u308a\u30b7\u30f3\u30d7\u30eb\u306b\u306a\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75957295/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75976311", "body": "I have three concerns.\n- please move the definition to `h2o/memory.h`, since that is the file tha currently has these kind of very basic macros\n- shouldn't the size of the array be calculated as `2*!!(condition) - 1` instead?\n  - current formula evaluates to 1 if `condition` is 0, and to 0 if `condition` is 1\n-  it might be better to replace `condition` with `!__builtin_constant_p(condition) || (condition)`, so that \n  `H2O_BUILD_ASSERT` gets silently skipped in case the condition is a non-constant\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75976311/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75976676", "body": "I believe this should be defined as below or as a inline function to preserve operator precedence regardless of how the function is used.\n\n`#define h2o_http2_encode_rst_stream_frame(buf, stream_id, errnum) h2o_http2__encode_rst_stream_frame(buf, stream_id, (H2O_BUILD_ASSERT((errnum) > 0), errnum))`\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75976676/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75976820", "body": "Please rename the function to `h2o_http2__encode_rst_stream_frame`. An extra `_` after the module name is the way we use to mark internal functions.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75976820/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76145050", "body": "You should never leave some properties (e.g. `anchor`) uninitialized. This would lead to undefined behavior when the value is used (e.g. in `yoml_free`). And regarding _what_ to set, it might be a good idea to inherit `filename`, `line`, and `column` from the original node.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76145050/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76170837", "body": "I'd suggest doing first initializing the all properties of `map` then set the necessary columns to avoid issues when a new property gets added and for the ease of reading; i.e.:\n\n``` c\n*map = (yoml_t){YOML_TYPE_MAPPING};\nif (node->filename != NULL)\n    map->filename = h2o_strdup(node->filename).base;\n...\n```\n\nNote also that you should use `h2o_strdup` in place of `strdup` for the same reasons we use `h2o_mem_alloc` in place of `malloc`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76170837/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76201243", "body": "You would not need to set `0` or `NULL` now that all the members of `*map` following the type are default-initialized (i.e. set to zero or NULL depending on their types).\n\nIn other words, you can omit `map->data.mapping.size = 0;` and can also change `map->filename = ... ? ... : NULL` to `if (node->filename != NULL) map->filename = h2o_strdup...;`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76201243/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75584179", "body": "Please use typedef as well as adding `_t` prefix, following the patterns found in other parts of the code (e.g. https://github.com/h2o/h2o/blob/master/include/h2o/http2_internal.h#L138).\n\nAlso, how about omitting `_stream` from the typename and the states, considering the fact that the function that sends this code is named `h2o_send`? Note that the concept of _stream_ is specific to HTTP/2.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75584179/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75584249", "body": "How about doing either of the following?\n- change the test to `state != H2O_SEND_STATE_IN_PROGRESS`\n- introduce is_in_progress function instead of is_final function, and call the function\n\nThe reason I suggest this is because having a is_final function that tests if the state is either final or reset is counterintuitive, and also because doing a logical in this hot path is something I'd be happy to avoid.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75584249/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75584289", "body": "With the introduction of the tri-state value, I think we can leave the function as `static`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75584289/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75793008", "body": "Could you please consider introducing `h2o_send_state_is_in_progress` instead of `is_final`?\n\nThe reason I ask is because current name is confusing; the function is named `is_final` even though it returns true if the state is either final _or error_.\n\nI might have not been clear enough about this point in https://github.com/h2o/h2o/pull/1031#discussion_r75584249, sorry for the confusion.\n\nPS. And thank you for changing all the parts of the code to tri-state (as well as renaming the variable to avoid confusion). I highly appreciate that.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75793008/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75793236", "body": "It might be easier to change `int is_eos;` to `h2o_send_state_t ststate;`, and assign values directly to the state as we did for `is_eos` prior to this PR (see https://github.com/h2o/h2o/blob/b1faa94/lib/core/proxy.c#L277-L284).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75793236/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75793650", "body": "~~I think you would need to set `req->http1_is_persistent` to zero to avoid the connection from being used in case of sending an incomplete chunked response.~~ (the issue can be addressed https://github.com/h2o/h2o/pull/1031/files#r75793874)\n\nAlso, we might want to emit \"\\r\\n1\\r\\n\" (a non-zero chunk size) but without following data in this case, taking https://github.com/h2o/h2o/pull/1031#issuecomment-241485544 into consideration.\n\nThe same applies to the below `if` as well.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75793650/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75793874", "body": "Please set `req->http1_is_persistent` to zero in case an error state is returned (since it is generally an indication that the generator failed to build a complete response).\n\nThis also applies to `finalostream_send`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75793874/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75795535", "body": "I believe you would need to set `send_rst_stream_on_close` to true in case `h2o_pull` returns `H2O_SEND_STATE_ERROR`, otherwise no frame that closes the stream would be sent.\n\nAn alternative approach would be to pass the send_state as an argument to `encode_data_header_and_consume_window`, and encode the `RST_STREAM` frame within the function. I _think_ that would make the code little more concise (and in this case, you can get rid of [this if statement](https://github.com/h2o/h2o/pull/1031/files#diff-14f5483efd1083adf6f6280d209207b4R344), since we are using `encode_data_header_and_cosume_window` for sending a zero-byte `DATA` frame with the `END_STREAM` flag set; the function can just send a `RST_STREAM` frame instead in case of an error).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75795535/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76150382", "body": "I believe we no longer need this `if` thanks to the refactoring.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76150382/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76183909", "body": "I believe `is_eos` can be omitted, since the three states under which this function gets invoked are covered by `send_state`.\n\nPS. and this might be related [the pull issue](https://github.com/h2o/h2o/pull/1031#issuecomment-242268878).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76183909/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76184091", "body": "You might want to:\n- use a scalar for holding the filehandle, i.e. `open my $nghttp, ...`\n- use three-argument open, i.e. `open my $nghttp, \"-|\", \"nghttp...`\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76184091/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76356690", "body": "> `send_state == H2O_SEND_STATE_FINAL`\n\nDo we need this check?\n\nPlease correct me if I'm wrong, bit to me it seems that we should not let `encode_data_header_and_consume_window` send neither `END_STREAM` or `RST_STREAM` until all pending data gets sent (i.e. when `bufcnt` becomes zero and send state is not in-progress).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76356690/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76357033", "body": "Thank you for making the changes to file.c.\n\nI assume we do not need this check, since:\n- we should return an error if we reached an EOF before reading the expected number of bytes (the number which has already been indicated to the client through the `content-length` header)\n- `do_pull` never gets called if `bytesleft == 0` (there's a guard in `do_send_file` for the first invocation, and for succeeding calls, the function returns `H2O_SEND_STATE_FINAL` once bytesleft becomes zero)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76357033/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76466276", "body": "Change to `Including Files`?\n\nSorry if my suggestion to add a _using_ section has led to this choice of wording.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76466276/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76466334", "body": "s/Since/Starting from/ might be better considering that we are going to release 2.1.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76466334/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}]}, "worenga": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1557", "title": "How does the h2 stream scheduler work", "body": "I am trying to find any documentation/specification, that describes how the stream scheduler in h2o is working.\r\nI've looked at the implementation but it hard to understand (for a newcomer), when you do not know what the purpose of the code is.\r\nIs there any document that describes the scheduling logic (on a high level?)", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1557/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1284", "title": "Cross Origin Server Push", "body": "Given a certificate that contains Subject Alternative Names for two domains A and B,\r\nIs it possible to push resources for domain B for a request from domain A with h2o?\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1284/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "d-Pixie": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1552", "title": "OS X High sierra from Homebrew - preloads.rb not found.", "body": "Hi, I can't find any information regarding this error anywhere so I'm opening a ticket for it.\r\n\r\nI just installed h2o via Homebrew, `brew install h2o`, and am trying a minimal example:\r\n```yaml\r\n# h2o.yaml\r\nlisten:\r\n  port: 8080\r\nuser: nobody\r\nhosts:\r\n  \"myhost.example.com\":\r\n    paths:\r\n      \"/\":\r\n        mruby.handler: |\r\n          Proc.new do |env|\r\n            [200, {'content-type' => 'text/plain'}, [\"Hello world\\n\"]]\r\n          end\r\naccess-log: ./log/h2o-access.log\r\nerror-log: ./log/h2o-error.log\r\npid-file: ./tmp/pids/h2o.pid\r\n```\r\nStraight from the docs ...\r\nWhen I try `sudo h2o -m worker -c ./h2o.yaml` in the root of my app I get: \r\n```text\r\nfile \"/usr/local/Cellar/h2o/2.2.4/share/h2o/mruby/preloads.rb\" not found. Did you forget to run `make install` ?Abort trap: 6\r\n```\r\n\r\nI verified that the file exists:\r\n```text\r\n$ cat /usr/local/Cellar/h2o/2.2.4/share/h2o/mruby/preloads.rb\r\nrequire \"bootstrap.rb\"\r\nrequire \"acl.rb\"\r\ninclude H2O::ACL\r\n```\r\nI have also tried cating the file as noboby:\r\n```text\r\nsudo -u nobody cat /usr/local/Cellar/h2o/2.2.4/share/h2o/mruby/preloads.rb\r\nrequire \"bootstrap.rb\"\r\nrequire \"acl.rb\"\r\ninclude H2O::ACL\r\n```\r\nAnd running the server with `user: root` in the config.\r\n\r\nI'm out of ideas here. Any idea what is going on?", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1552/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "Jxck": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1550", "title": "logging handler", "body": "I wrote mruby handler for formatting/controlling access log.\r\nbut I need to add mruby-handler-file directive to every tons of path: in h2o conf.\r\n\r\nit seems better to allow adding handler to access log directive, and apply every request/response under that scope.\r\n\r\nusecase:\r\n- adding all request header into acccesslog\r\n- formatting values into json/ltsv etc via handler\r\n- routing/rotating log file from handler", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1550/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1417", "title": "[proposal] Server Timing API", "body": "Server Timing API are under standardization process.\r\n\r\nhttps://w3c.github.io/server-timing/\r\n\r\nthe point of this spec defines `Server-Timing` Header\r\nwhich shows time spend on server.\r\n(querying db, processing on app server, and total time during server side etc)\r\n\r\n```\r\n> GET /resource HTTP/1.1\r\n> Host: example.com\r\n\r\n< HTTP/1.1 200 OK\r\n< Server-Timing: miss, db=53, app=47.2;\r\n< Server-Timing: customView, dc;atl\r\n< Trailer: Server-Timing\r\n< (... snip response body ...)\r\n< Server-Timing: total=123.4\r\n```\r\n\r\nin blink, [intent to development](https://groups.google.com/a/chromium.org/forum/#!msg/blink-dev/y3qwr490Fc4/boGoo41-BwAJ)\r\nother browsers are no-signal now.\r\n\r\nin Feedback point of view, experimental implementation of this feature in H2O helps standardization process.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1417/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "GuacheSuede": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1540", "title": "Quick Question: If PICO is the HTTP/1 Parser, what is the HTTP/2's parser ?", "body": "", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1540/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1213", "title": "Simpler Non SSL with Routing example", "body": "The current simple.c is very complex for a new individual to the framework, could someone offer to create a simpler example with routing/params/serving files etc ?", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1213/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "unisqu": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1539", "title": "Can someone teach me how to run a c script inside h2o?", "body": "Can someone teach me how to run a c script inside h2o?\r\n\r\nAppreciate this.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1539/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1529", "title": "How to implement C template style generation like C++ cpoll_cppsp?", "body": "1. How do I code in C to write functions / features etc for this web server?\r\n2. Is there a templating system I can use? e.g. ULib / cpoll_cppsp\r\n3. Can I use C++ too? I don't mind using C all the way", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1529/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "dmitri--": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1525", "title": "socket leaks with prematurely disconnected HTTP/1 clients", "body": "in short: if a HTTP/1 client disconnects too early, server will miss UV_EOF notification on that socket and will leave it half-open.\r\n\r\nIt appears that http1.c stops reading the socket even before calling on_req handler -- it explicitly calls uv_read_stop(), therefore should socket gets disconnected on the client side, there is no way for the server to recognize this situation.\r\n\r\nlong story:\r\nI have a handler installed in on_req callback. This handler can't respond immediately. It responds as soon as it can and this may take several seconds. I implemented this handler in asynchronous way, so if it can't respond immediately, it just quits on_req. When it gets notification about data availability, it breaks the uv loop using uv_async object, then in the uv_async object's callback it first calls h2o_start_response(), then repeats async operation with h2o_send()  calls until all the data is returned. It works perfectly well with HTTP/2 clients (for instance h2load). But, if I use HTTP/1 client (for exeample GET or curl) and kill the client with SIGINT before the data is arrived, the socket leaks in libh2o.\r\n\r\nI'm not sure why h2o needs to stop reading HTTP/1 clients. I tried to comment out h2o_socket_read_stop call in http1.c and this simple change fixed the problem -- now as soon as client breaks, server gets notification and calls generator's stop callback -- same way as in HTTP/2 case.\r\n\r\nSteps to reproduce:\r\n* in examples/libh2o/simple.c comment out all lines in chunked_test() function\r\n* make lib-examples\r\n* run examples-simple\r\n* run `GET \"http://127.0.0.1:7890/chunked-test\"`\r\n* kill GET with SIGINT\r\n* check `netstat -naop | grep ^tcp | grep -F 7890` output\r\n\r\nExpected behavour:\r\nonly one (LISTENING) socket is expected in last command output\r\n\r\nObserved behaviour:\r\nthere are 3 sockets -- LISTENING, FIN_WAIT2 and CLOSE_WAIT for more than one minute.\r\n\r\nPlatform:\r\nlinux 3.1\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1525/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1268", "title": "per-connection context", "body": "What I need is a quick access to context associated each server connection in on_req() handler. In libuv's  uv_connection_cb() callback I can allocate enough memory to keep both uv_tcp_t and my context. Unfortunately, I didn't find neither a way to associate this context with libh2o \"socket\" h2o_socket_t nor a way to access uv_tcp_t that I allocated earlier and that's stored in uv.stream member of st_h2o_uv_socket_t. Is there any way to have per-connection context accessible in on_req() handler at all?\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1268/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1257", "title": "recycled memory blocks are never freed producing long memory leak report", "body": "H2O maintains per-thread list of \"recycled\" memory blocks in `static __thread h2o_mem_recycle_t mempool_allocator`. Unfortunately, these blocks are never released to the system. They are limited -- only 16 blocks (hardcoded value)  are allowed per thread. So it's not a big deal from the server perspectives. But still this is a huge problem for developers who need to track their own memory leaks, for example in their on_req/on_proceed etc handlers. It's because `h2o_mem_recycle_t`-related leaks appear with many many different (read arbitrary) call-stacks, they are almost always there, and it's hard to suppress them all in Valgrind or not possible to suppress at all in case of gcc's sanitize=leak. It's impossible to distinguish memory leaks produced by libh2o with \"recycled\" lists from the other potential memory leaks, including 3rd party code invoked in on_req/on_proceed etc callbacks.\r\nI think it makes sense to provide a new API function that will release all such outstanding \"recycled\" memory blocks and would make memory leak report empty by default.\r\nMy initial version is rather trivial but it works good for me:\r\n\r\n```\r\ndiff --git a/include/h2o/memory.h b/include/h2o/memory.h\r\nindex 696b296..16cadfd 100644\r\n--- a/include/h2o/memory.h\r\n+++ b/include/h2o/memory.h\r\n@@ -86,6 +86,8 @@ typedef struct st_h2o_mem_recycle_t {\r\n     size_t max;\r\n     size_t cnt;\r\n     struct st_h2o_mem_recycle_chunk_t *_link;\r\n+    struct st_h2o_mem_recycle_t *_next;\r\n+    char   registered;\r\n } h2o_mem_recycle_t;\r\n \r\n struct st_h2o_mem_pool_shared_entry_t {\r\n@@ -160,6 +162,11 @@ extern void *(*h2o_mem__set_secure)(void *, int, size_t);\r\n #define h2o_fatal(msg) h2o__fatal(__FILE__ \":\" H2O_TO_STR(__LINE__) \":\" msg)\r\n H2O_NORETURN void h2o__fatal(const char *msg);\r\n \r\n+/** \r\n+ * releases blocks remained in h2o_mem_recycle_t\r\n+ */\r\n+void h2o_mem_dispose_recycled_allocators();\r\n+\r\n /**\r\n  * constructor for h2o_iovec_t\r\n  */\r\ndiff --git a/lib/common/memory.c b/lib/common/memory.c\r\nindex 194c64c..1462409 100644\r\n--- a/lib/common/memory.c\r\n+++ b/lib/common/memory.c\r\n@@ -64,6 +64,30 @@ struct st_h2o_mem_pool_shared_ref_t {\r\n \r\n void *(*h2o_mem__set_secure)(void *, int, size_t) = memset;\r\n \r\n+static h2o_mem_recycle_t* recycle_allocator_list;\r\n+\r\n+static void h2o_mem_recycle_register(h2o_mem_recycle_t* allocator) {\r\n+    assert(!allocator->registered);\r\n+    allocator->registered = 1;\r\n+    while (1) {\r\n+        allocator->_next = recycle_allocator_list;\r\n+        if (__sync_bool_compare_and_swap(&recycle_allocator_list, allocator->_next, allocator))\r\n+            break;\r\n+    }\r\n+}\r\n+\r\n+void h2o_mem_dispose_recycled_allocators() {\r\n+    while (recycle_allocator_list) {\r\n+        while (recycle_allocator_list->_link) {\r\n+            struct st_h2o_mem_recycle_chunk_t *chunk = recycle_allocator_list->_link;\r\n+            recycle_allocator_list->_link = chunk->next;\r\n+            free(chunk);\r\n+        }\r\n+        recycle_allocator_list->registered = 0;\r\n+        recycle_allocator_list = recycle_allocator_list->_next;\r\n+    }\r\n+}\r\n+\r\n static __thread h2o_mem_recycle_t mempool_allocator = {16};\r\n \r\n void h2o__fatal(const char *msg)\r\n@@ -75,8 +99,11 @@ void h2o__fatal(const char *msg)\r\n void *h2o_mem_alloc_recycle(h2o_mem_recycle_t *allocator, size_t sz)\r\n {\r\n     struct st_h2o_mem_recycle_chunk_t *chunk;\r\n-    if (allocator->cnt == 0)\r\n+    if (allocator->cnt == 0) {\r\n+        if (!allocator->registered)\r\n+            h2o_mem_recycle_register(allocator);\r\n         return h2o_mem_alloc(sz);\r\n+    }\r\n     /* detach and return the pooled pointer */\r\n     chunk = allocator->_link;\r\n     assert(chunk != NULL);\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1257/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1256", "title": "leaks in examples/libh2o/simple.c", "body": "Seems, this example is very simple so all the resource housekeeping left over. If it's the purpose, that's okay. On the other hand, I think it makes sense to make it leak-free so it would be easier to check if H2O itself has leaks. Changes are not complicated. Feel free to merge:\r\n\r\n```\r\ndiff --git a/examples/libh2o/simple.c b/examples/libh2o/simple.c\r\nindex 282da51..dec6efb 100644\r\n--- a/examples/libh2o/simple.c\r\n+++ b/examples/libh2o/simple.c\r\n@@ -93,6 +93,9 @@ static h2o_globalconf_t config;\r\n static h2o_context_t ctx;\r\n static h2o_multithread_receiver_t libmemcached_receiver;\r\n static h2o_accept_ctx_t accept_ctx;\r\n+#if H2O_USE_LIBUV\r\n+static uv_tcp_t listener;\r\n+#endif\r\n \r\n #if H2O_USE_LIBUV\r\n \r\n@@ -118,7 +121,6 @@ static void on_accept(uv_stream_t *listener, int status)\r\n \r\n static int create_listener(void)\r\n {\r\n-    static uv_tcp_t listener;\r\n     struct sockaddr_in addr;\r\n     int r;\r\n \r\n@@ -215,6 +217,12 @@ static int setup_ssl(const char *cert_file, const char *key_file)\r\n     return 0;\r\n }\r\n \r\n+#if H2O_USE_LIBUV\r\n+static void on_sigint(uv_signal_t *req, int signum) {\r\n+    uv_stop(ctx.loop);\r\n+}\r\n+#endif\r\n+\r\n int main(int argc, char **argv)\r\n {\r\n     h2o_hostconf_t *hostconf;\r\n@@ -230,6 +238,7 @@ int main(int argc, char **argv)\r\n \r\n #if H2O_USE_LIBUV\r\n     uv_loop_t loop;\r\n+    uv_signal_t sigint;\r\n     uv_loop_init(&loop);\r\n     h2o_context_init(&ctx, &loop, &config);\r\n #else\r\n@@ -253,7 +262,18 @@ int main(int argc, char **argv)\r\n     }\r\n \r\n #if H2O_USE_LIBUV\r\n+    uv_signal_init(ctx.loop, &sigint);\r\n+    uv_signal_start(&sigint, on_sigint, SIGINT);\r\n+\r\n+    uv_run(ctx.loop, UV_RUN_DEFAULT); /* main loop */\r\n+\r\n+    uv_signal_stop(&sigint);\r\n+    uv_close((uv_handle_t *)&sigint, NULL);\r\n+    uv_close((uv_handle_t *)&listener, NULL);\r\n+    h2o_context_dispose(&ctx);\r\n+    h2o_config_dispose(&config);\r\n     uv_run(ctx.loop, UV_RUN_DEFAULT);\r\n+    uv_loop_close(ctx.loop);\r\n #else\r\n     while (h2o_evloop_run(ctx.loop, INT32_MAX) == 0)\r\n         ;\r\n\r\n```\r\nThese changes add SIGINT handler so it's very simple to break the loop by pressing Ctrl-C in console or by sending this signal using `kill`. Also they add all these *_stop, *_close, *_dispose calls.\r\nI compile the sample with gcc's linker option: \"-fsanitize=leak\" and check the output after the server shutdown. This way I discovered #1255.\r\nHope it's useful for somebody else too.\r\nPerhaps it makes sense to add something like that into standard tests to make sure no leaks are introduced.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1256/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "yannick": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1520", "title": "it should be possible to include data from environment variables into the config", "body": "wip implementation see https://github.com/h2o/h2o/pull/1524", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1520/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1501", "title": "session resumption partly not working", "body": "resuming a session from a saved openss s_client works. \r\nhowever the server sends new tickets and browsers then use that one, this means that if e.g. session_store redis is used a lot of tickets get created. \r\nfurther more with redis store, tickets are not used again if h2o is restarted. \r\n\r\ntested on macos high sierra with https://github.com/h2o/h2o/commit/6b1f65cc1fe3ba5d7b0f7b04114791c072094252 linked against openssl@1.1/1.1.0g\r\n\r\nthis might all be expected behavior due to how openssl works, however it unclear to me why the session is deleted here: https://github.com/h2o/h2o/blob/b44c03f2429ed8ad2e151ab74648ae9cba5b8607/lib/common/socket.c#L1246\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1501/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1473", "title": "enhancements for mruby development", "body": "following features would be extremely useful to allow development of apps/configurations in mruby:\r\n\r\n- - execute mruby files/handlers from command line in a \"one shot\" approach, but still fire up the eventloop to make external calls. this would help testing\r\n\r\n- -  re-load the code of specific handlers from outside and/or inside. this could be done via e.g. a specific, new HTTP method (RELOAD) in development mode\r\n\r\n- -  re-load the complete vm, so that externally loaded code is re-triggered. you could then reload handler code via http calls\r\n \r\n\r\n- - execute/embed mrb compiled mruby files. also expose mrbc. together with the ability to execute ritevm code this could allow for an h2o \"app store\" where addons could be easily added. via 399 and/or rack middlerware this would then allow for services such as logins, ddos protection, rate limiting etc...\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1473/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1455", "title": "flexible metrics / expose metrics in prometheus format", "body": "the current json export of metrics is a great first step, however for a modern production setup its not really sufficient. \r\n  \r\nproblems with current implementation:\r\n\r\n- is mainly that the percentiles are not really useful in such a system as they cant be aggregated over a number of servers. configurable buckets would be better\r\n\r\n- not all status codes/requests are available.\r\n- HTTP methods are not distinguished\r\n\r\n- almost no documentation, its unclear what the units, timespans and algorithms behind it are.\r\n\r\n(- timings are actually not working / incorrect for mruby handlers )\r\n\r\nin an ideal case also following features would be possible\r\n- per handler/domain stats\r\n- access, creation updates to stats from mruby\r\n\r\nprometheus is the de facto standard format for exposing such metrics. \r\nand i propose that a redesigned version of the metrics interface additionally delivers the prometheus format natively.\r\nsee also https://prometheus.io/docs/instrumenting/writing_clientlibs/ \r\nhttps://prometheus.io/docs/instrumenting/exposition_formats/\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1455/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1420", "title": "redis session resumption: select db + AUTH", "body": "redis session resumption does not allow to select DB + AUTH calls", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1420/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1419", "title": "redis session resumption:  missing documentation", "body": "#1087 introduces session resumption but the feature is not documented. ", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1419/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1363", "title": "production grade config example", "body": "in the examples directory there should be a more advanced example application that showcases a few things:\r\n\r\n- [ ] production grade TLS settings\r\n- [ ] advanced logging \r\n- [ ] load balancing and header replacement / delete headers\r\n- [ ] possibly also a few cool mruby tricks ", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1363/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1232", "title": "events and duration are undocumented", "body": "\r\nbesides the duration handler gives back always 0", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1232/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1139", "title": "add kafka as logging destination", "body": "its being implemented here: https://github.com/tamediadigital/h2o/pull/7\r\ncurrent status: works (depends on librdkafka/master), needs cleanup and docs, some features missing\r\n\r\nquestions:\r\n- is there a chance that we can get this in? kafka is the de-facto standard of a distributed commit log.\r\n- do we need to pull in [librdkafka sources](https://github.com/edenhill/librdkafka) ?\r\n- any other hints on how it should behave, what docs are needed? ", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1139/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1018", "title": "add application context for timer callbacks", "body": "from what i understand its currently not possible to add a context to timers so they can be embedded into objects. \ncurrently the only way to do it seems like comparing the `st_h2o_timeout_entry_t` within the callback, but thats not optimal. or do i miss anything?\n\nwould a patch be accepted that adds a `void* ctx` so libh2o applications can keep context?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1018/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/993", "title": "recommended way to add mruby gems", "body": "what is the recommended way to add more mruby gems?\nespecially in regards to dynamically link to libraries such as leveldb \n\nand is there a way to update mruby itself? \ncould this be made a git submodule so it can be switched?\n\nwhat i did and what worked:\n- replace the mruby dir with a fresh checkout of https://github.com/mruby/mruby \n- edit  `misc/mruby_config.rb` (e.g. add `conf.gem :github => 'take-cheeze/mruby-leveldb'`\n- add `EXTRA_LIBS` to cmake command, e.g. `-DEXTRA_LIBS=\"-lhiredis -lleveldb -lsqlite3\"`\n\nbut this seems a bit tedious. \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/993/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/944", "title": "getting and updating pool memory range", "body": "i would like to have a garbage collector scan the pool ranges for references.\nis it possible to get the locations and sizes?\n\nif this is possibly i could allocate data just pass references without the fear that they are \ncollected before a request ends\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/944/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/1484", "title": "WIP document mruby redis feature", "body": "its a bit opinionated example that shows other things, but i think since grasping the redis interface is so simple it is ok", "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/1364", "title": "[WiP] log to kafka", "body": "this PR lets you optionally include librdkafka at build time and\r\nthen makes it possible to log directly to kafka.\r\nit supports configurable partitioning, kafka timestamps and all kafka options.\r\nKafka Key, Message and Partitioning string can be configured with all standard h2o log strings.\r\n\r\ntodo:\r\n- [ ] build instructions\r\n- [ ] config documentation\r\n- [ ] remove newline at the end of the kafka message\r\n- [ ] configurable escaping\r\n\r\nuse an external openssl, e.g.:\r\n`cmake -DWITH_BUNDLED_SSL=off -DWITH_MRUBY=ON -DWITH_RDKAFKA=ON -LAHT -DOPENSSL_ROOT_DIR=/usr/local/Cellar/openssl@1.1/1.1.0f ..`", "author_association": "CONTRIBUTOR"}], "issue_comments": [], "commit_comments": [], "review_comments": []}, "voiddeveloper": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1505", "title": "When is qrintf used?", "body": "https://www.slideshare.net/kazuho/h2o-20141103pptx\r\n\r\n\r\nThe developer says that 'h2o server' is fast using qrintf as I see ppt.\r\n\r\nsprintf parses at runtime,\r\nqrintf parses at compile time.\r\nSo qrintf is fast.\r\nConceptually, I understand.\r\nWhen do you use it?\r\nOnly when returning ip4 address as string?\r\n\r\nThen I do not understand.\r\nIs not the web server already run-time after compilation?\r\n\r\n\r\nIn other words, my question is\r\nWhen is qrintf used?\r\nAnd\r\nWhy is qrintf fast?\r\n\r\nThere are two.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1505/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1497", "title": "Why is h2o so fast?", "body": "I am learning why h2o is fast.\r\n1. What does \"Unlike most parsers, it is stateless and does not allocate memory by itself. All it does is accept pointer to buffer and the output structure, and setups the pointers in the latter to point at the necessary portions of the buffer.\" mean?\r\n\r\nWhen I read ppt or read git's \"read me\" it says \"fast\" because it is \"Unlike most parsers, it is stateless and does not allocate memory by itself. All it does is accept pointer to buffer and the output structure, and setups the pointers in the latter to point at the necessary portions of the buffer.\"\r\nI do not understand what it means. I would be grateful if you explain in detail.\r\n\r\nI would really appreciate it if you let me know.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1497/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1488", "title": "Please tell me how to install php7, ubuntu 16.04", "body": "I installed h2o.\r\nbut php7 is not installed.\r\nI can't interact with the server. :-(\r\nPlease help me.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1488/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "concatime": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1496", "title": "\"LibreSSL 2.4.x support has also ended.\"", "body": "Since November 6, the old 2.4.x is deprecated. We need to update to 2.6.3, or actually consider unbundling it, reference to #1461.\r\nI would love to provide a commit, but It seems that you rely on a proper .tar.gz file instead of downloading it.\r\n[Source](//ftp.openbsd.org/pub/OpenBSD/LibreSSL/libressl-2.6.3-relnotes.txt).", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1496/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "thisprogrammer1": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1487", "title": "Phalcon\u304c\u6b63\u3057\u304f\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3057\u307e\u305b\u3093\u3002", "body": "http://blog.kazuhooku.com/2015/06/h2ophpmodrewrite.html\r\n\u3084\r\nhttps://qiita.com/thisprogrammer/items/b750c0eb56bbab9defcf\r\n\u3092\u53c2\u8003\u306bH2O\u3092\u8a2d\u5b9a\u3057\u305f\u306e\u3067\u3059\u304cPhalcon\u306e\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u304c\u3046\u307e\u304f\u884c\u304d\u307e\u305b\u3093\u3002\r\n\r\nApache\u3067\u306f\u3046\u307e\u304f\u884c\u304f\u306e\u3067Phalcon\u3067\u306f\u306a\u304fH2O\u306e\u554f\u984c\u306e\u3088\u3046\u306a\u6c17\u304c\u3057\u307e\u3059\u3002\r\n\u5177\u4f53\u7684\u306b\u306f\r\n```php\r\n/**\r\n * Add your routes here\r\n */\r\n\r\n$app->get('/', function () {\r\n    \r\n    echo $this['view']->render('index');\r\n});\r\n\r\n$app->get('/test', function () {\r\n    echo \"test\";\r\n    //echo $this['view']->render('index');\r\n});\r\n/**\r\n * Not found handler\r\n */\r\n$app->notFound(function () use($app) {\r\n    $app->response->setStatusCode(404, \"Not Found\")->sendHeaders();\r\n    echo $app['view']->render('404');\r\n});\r\n```\r\n\u306e/\u306e\u90e8\u5206\u306f\u52d5\u304f\u306e\u3067\u3059\u304c\u3001/test\u3068notFound()\u304c\u52d5\u304b\u306a\u3044\u611f\u3058\u3067\u3059\u3002\r\n\r\n\u5229\u7528\u3057\u3066\u3044\u308bH2O\u306f\r\nhttps://github.com/tatsushid/h2o-rpm\r\n\u3088\u308ayum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u3082\u306e\u3067\u3059\u3002\r\n\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3044\u305f\u3057\u307e\u3059\u3002\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1487/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "csmk": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1486", "title": "How to enable chacha20-poly1305 with TLS 1.3 (draft-18)?", "body": "Hi,\r\n\r\nWith the landing of https://github.com/h2o/h2o/pull/1485, how one would enable it? Is there any flag/settings for `cipher-suite:`?\r\n\r\nOn my side, SSL Labs is only detecting `TLS_AES_128_GCM_SHA256`. Could be a limitation on their part? \ud83e\udd14 \r\n\r\nEdit: looking [further](https://github.com/h2o/picotls/blob/fd180162a4f6eac509e172cd381983ef22d8fd5d/include/picotls/openssl.h#L31), if my understanding is correct, it will only work with OpenSSL 1.1.0+ and won't work with LibreSSL?", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1486/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1351", "title": "Please, consider the install of executable programs into libexecdir", "body": "I tried to [PR](https://github.com/gentoo/gentoo/pull/5015) an ebuild to Gentoo's main tree, but one of the developers [mentioned](https://github.com/gentoo/gentoo/pull/5015#discussion_r125169495) that scripts aren't allowed in `/usr/share`.\r\n\r\nAfter a quick research, I found that the [GNU Coding Standards](https://www.gnu.org/prep/standards/html_node/Directory-Variables.html) says:\r\n\r\n> **libexecdir**\r\n>\r\n> The directory for installing executable programs to be run by other programs rather than by users. This directory should normally be /usr/local/libexec, but write it as $(exec_prefix)/libexec. (If you are using Autoconf, write it as \u2018@libexecdir@\u2019.)\r\n>\r\n> The definition of \u2018libexecdir\u2019 is the same for all packages, so you should install your data in a subdirectory thereof. Most packages install their data under $(libexecdir)_/package-name/_, possibly within additional subdirectories thereof, such as $(libexecdir)_/package-name/machine/version_.\r\n\r\nI made a initial patch, so if the proposal is accepted I can do a proper PR later.\r\n\r\n```diff\r\n--- a/CMakeLists.txt\r\n+++ b/CMakeLists.txt\r\n@@ -509,13 +509,13 @@\r\n     INSTALL(FILES \"${CMAKE_BINARY_DIR}/libh2o-evloop.pc\" DESTINATION ${CMAKE_INSTALL_LIBDIR}/pkgconfig)\r\n ENDIF ()\r\n \r\n-INSTALL(PROGRAMS share/h2o/annotate-backtrace-symbols share/h2o/fastcgi-cgi share/h2o/fetch-ocsp-response share/h2o/kill-on-close share/h2o/setuidgid share/h2o/start_server DESTINATION ${CMAKE_INSTALL_DATAROOTDIR}/h2o)\r\n+INSTALL(PROGRAMS share/h2o/annotate-backtrace-symbols share/h2o/fastcgi-cgi share/h2o/fetch-ocsp-response share/h2o/kill-on-close share/h2o/setuidgid share/h2o/start_server DESTINATION ${CMAKE_INSTALL_LIBEXECDIR}/h2o)\r\n INSTALL(FILES share/h2o/ca-bundle.crt DESTINATION ${CMAKE_INSTALL_DATAROOTDIR}/h2o)\r\n INSTALL(FILES share/h2o/status/index.html DESTINATION ${CMAKE_INSTALL_DATAROOTDIR}/h2o/status)\r\n INSTALL(DIRECTORY doc/ DESTINATION ${CMAKE_INSTALL_DATAROOTDIR}/doc/h2o PATTERN \"Makefile\" EXCLUDE PATTERN \"README.md\" EXCLUDE)\r\n INSTALL(DIRECTORY examples/ DESTINATION ${CMAKE_INSTALL_DATAROOTDIR}/doc/h2o/examples)\r\n IF (WITH_MRUBY)\r\n-    INSTALL(DIRECTORY share/h2o/mruby DESTINATION ${CMAKE_INSTALL_DATAROOTDIR}/h2o)\r\n+    INSTALL(DIRECTORY share/h2o/mruby DESTINATION ${CMAKE_INSTALL_LIBEXECDIR}/h2o)\r\n ENDIF (WITH_MRUBY)\r\n \r\n # tests\r\n--- a/lib/handler/mruby.c\r\n+++ b/lib/handler/mruby.c\r\n@@ -73,17 +73,17 @@\r\n         root = H2O_TO_STR(H2O_ROOT);\r\n     mrb_gv_set(mrb, mrb_intern_lit(mrb, \"$H2O_ROOT\"), mrb_str_new(mrb, root, strlen(root)));\r\n \r\n-    h2o_mruby_eval_expr(mrb, \"$LOAD_PATH << \\\"#{$H2O_ROOT}/share/h2o/mruby\\\"\");\r\n+    h2o_mruby_eval_expr(mrb, \"$LOAD_PATH << \\\"#{$H2O_ROOT}/libexec/h2o/mruby\\\"\");\r\n     h2o_mruby_assert(mrb);\r\n \r\n     /* require core modules and include built-in libraries */\r\n-    h2o_mruby_eval_expr(mrb, \"require \\\"#{$H2O_ROOT}/share/h2o/mruby/preloads.rb\\\"\");\r\n+    h2o_mruby_eval_expr(mrb, \"require \\\"#{$H2O_ROOT}/libexec/h2o/mruby/preloads.rb\\\"\");\r\n     if (mrb->exc != NULL) {\r\n         if (mrb_obj_is_instance_of(mrb, mrb_obj_value(mrb->exc), mrb_class_get(mrb, \"LoadError\"))) {\r\n             fprintf(stderr, \"file \\\"%s/%s\\\" not found. Did you forget to run `make install` ?\", root,\r\n-                    \"share/h2o/mruby/preloads.rb\");\r\n+                    \"libexec/h2o/mruby/preloads.rb\");\r\n         } else {\r\n-            fprintf(stderr, \"an error occurred while loading %s/%s: %s\", root, \"share/h2o/mruby/preloads.rb\", RSTRING_PTR(mrb_inspect(mrb, mrb_obj_value(mrb->exc))));\r\n+            fprintf(stderr, \"an error occurred while loading %s/%s: %s\", root, \"libexec/h2o/mruby/preloads.rb\", RSTRING_PTR(mrb_inspect(mrb, mrb_obj_value(mrb->exc))));\r\n         }\r\n         abort();\r\n     }\r\n--- a/lib/handler/configurator/fastcgi.c\r\n+++ b/lib/handler/configurator/fastcgi.c\r\n@@ -284,12 +284,12 @@\r\n \r\n     { /* build args */\r\n         size_t i = 0;\r\n-        argv[i++] = kill_on_close_cmd_path = h2o_configurator_get_cmd_path(\"share/h2o/kill-on-close\");\r\n+        argv[i++] = kill_on_close_cmd_path = h2o_configurator_get_cmd_path(\"libexec/h2o/kill-on-close\");\r\n         argv[i++] = \"--rm\";\r\n         argv[i++] = dirname;\r\n         argv[i++] = \"--\";\r\n         if (spawn_user != NULL) {\r\n-            argv[i++] = setuidgid_cmd_path = h2o_configurator_get_cmd_path(\"share/h2o/setuidgid\");\r\n+            argv[i++] = setuidgid_cmd_path = h2o_configurator_get_cmd_path(\"libexec/h2o/setuidgid\");\r\n             argv[i++] = spawn_user;\r\n         }\r\n         argv[i++] = \"/bin/sh\";\r\n--- a/src/main.c\r\n+++ b/src/main.c\r\n@@ -186,7 +186,7 @@\r\n     0,                                      /* shutdown_requested */\r\n     H2O_BARRIER_INITIALIZER(SIZE_MAX),      /* startup_sync_barrier */\r\n     {{0}},                                  /* state */\r\n-    \"share/h2o/annotate-backtrace-symbols\", /* crash_handler */\r\n+    \"libexec/h2o/annotate-backtrace-symbols\", /* crash_handler */\r\n     0,                                      /* crash_handler_wait_pipe_close */\r\n };\r\n \r\n@@ -773,7 +773,7 @@\r\n #endif\r\n     pthread_mutex_init(&ssl_config->ocsp_stapling.response.mutex, NULL);\r\n     ssl_config->ocsp_stapling.cmd =\r\n-        ocsp_update_cmd != NULL ? h2o_strdup(NULL, ocsp_update_cmd->data.scalar, SIZE_MAX).base : \"share/h2o/fetch-ocsp-response\";\r\n+        ocsp_update_cmd != NULL ? h2o_strdup(NULL, ocsp_update_cmd->data.scalar, SIZE_MAX).base : \"libexec/h2o/fetch-ocsp-response\";\r\n     if (ocsp_update_interval != 0) {\r\n         switch (conf.run_mode) {\r\n         case RUN_MODE_WORKER:\r\n@@ -1669,7 +1669,7 @@\r\n     size_t i;\r\n \r\n     h2o_vector_reserve(NULL, &args, 1);\r\n-    args.entries[args.size++] = h2o_configurator_get_cmd_path(\"share/h2o/start_server\");\r\n+    args.entries[args.size++] = h2o_configurator_get_cmd_path(\"libexec/h2o/start_server\");\r\n \r\n     /* error-log and pid-file are the directives that are handled by server-starter */\r\n     if (conf.pid_file != NULL) {\r\n```", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1351/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/532", "title": "H2O ebuild for Gentoo/Funtoo Linux", "body": "Hello,\n\nBecause Gentoo's main repository doesn't yet have an official ebuild for H2O, I'm now maintaining and hosting a H2O ebuild in my _[overlay](https://wiki.gentoo.org/wiki/Overlay)_ that have been approved recently in [Gentoo overlay list](https://overlays.gentoo.org/).\n\nGentoo and Funtoo users, please, visit my overlay repository for instructions on how to use it: https://github.com/csmk/frabjous\n\nCheers\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/532/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "utrenkner": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1472", "title": "(h2o), uid 80: exited on signal 6", "body": "Just a question: I sometimes get a lot of these in the kernel log messages on FreeBSD and HardenedBSD systesm running h2o.\r\n```\r\npid 56341 (h2o), uid 80: exited on signal 6\r\n```\r\nIs this to be expected? Why does it exit so often? \r\n\r\nNote, there is nothing to be found in the h2o error log and neither in the php-fpm.log.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1472/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/926", "title": "Congrats to 2.0.0", "body": "h2o is a really fine piece of software and getting better all the time.\n\nMany thanks to all those who contributed to this new major release! Especially, of course, to @kazuho !\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/926/reactions", "total_count": 11, "+1": 0, "-1": 0, "laugh": 0, "hooray": 11, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/869", "title": "Built with mruby fails since 1.7.x on FreeBSD 9.3", "body": "As I accidentally updated my local 1.6.3 version with the latest FreeBSD package (1.7.1), I lost support for mruby (the standard package comes without mruby). Thus, I wanted to built it myself, but got this error:\n\n```\n===>  Building for h2o-1.7.1\nScanning dependencies of target mruby\n(in /var/ports/usr/ports/www/h2o/work/h2o-1.7.1/deps/mruby)\nchecking for struct stat.st_birthtimespec in sys/stat.h... rake aborted!\nThe compiler failed to generate an executable file.\nYou have to install development tools first.\nRakefile:26:in `load'\n```\n\nI tried various revisions: The problem exists since 1.7.x (I tried 1.7.0, 1.7.1 via FreeBSD ports and also the very latest Github sources). I can still build 1.6.3 with mruby. So what tools am I missing here? And should their existence be checked earlier?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/869/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/859", "title": "Script to compress static files", "body": "[As promised earlier](https://github.com/h2o/h2o/pull/802#issuecomment-188174772), I have written a little shell script to help with the compression. Version 0.1 is now available (BSD licensed) under https://github.com/utrenkner/csa\n\nWhat the script(s) do: You can let it run through any directory tree to search for compressible files. It will then attempt to create compressed copies using gzip/zopfli and brotli. Only if the result is smaller, will it be kept (NB: I once used an image compression script which in some cases created larger files than the original - this I wanted to avoid by all means!).\n\nIn order to not recreate the same compressed file over and over again, the script sets the mtime of the compressed files to that of the original file. It can thus check if the original has changed since (different mtime). The scripts can thus be used as in a cron job without too much overhead (only new assets are compressed).\n\nOptionally, you can also configure Yuicompressor to first minify .js and .css files (the WordPress theme we use comes with many non-minified files, so this makes a lot of sense in our case). However, the original file is never changed - perhaps there was a reason for it, e.g. to have both, the original file and a minified version. But any decent browser will be served the .gz or even .br version - which was minified beforehand. Again, with the Yuicompressor, the script checks that the minified file is in fact smaller than the original. In some cases (e.g. jquery) this is not the case and the original is used.\n\nCaveat: The 0.1 version was tested only on FreeBSD. I will make tests on GNU/Linux to ensure it works there, too. But you are more than welcome to test, too, and to contribute patches. Thanks!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/859/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/784", "title": "mruby handler for Wordfence Falcon Cache", "body": "I have created an mruby handler to use h2o + mruby with Wordfence's Falcon Cache. The code should be easily adaptable to other WordPress caches, such es WP Rocket.\n\nThe code is BSD-licensed and I would really love to receive comments and/or patches: https://github.com/utrenkner/wfcache-mruby/blob/master/wfcache.rb\n\nEnjoy.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/784/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 1, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/740", "title": "Rewrite... again, sorry!", "body": "It seems there are quite a few users who are looking for how to rewrite URLs in h2o. mruby makes it possible, but is not clear how. I quickly explain my latest challenge:\n\nOn our server, we have to map query strings to actual files on the server; and these may include blank spaces (or %20 when URL-encoded). For example:\nexample.com/search?item=something%20and%somethingelse should get the file\nexample.com/search/something_and_somethingelse\n\nI read the [mruby examples for h2o](https://h2o.examp1e.net/configure/mruby_directives.html) and the [Rack specs](http://www.rubydoc.info/github/rack/rack/master/file/SPEC), but I do not quite understand what I need to write to tell h2o to use a different path. I can read the PATH_INFO and QUERY_STRING environment variables, but how do I communicate the new values back to the h2o server (\"look here instead of there\")?\n\nOn a related note, I found a seemingly well-known gem called \"[rack-rewrite](https://github.com/jtrupiano/rack-rewrite)\". And I was wondering, if this might help me with my rewrite rules, and how such a gem could be combined with my h2o server. Do you have an example somewhere?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/740/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "tnt": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1470", "title": "Automated configuration with ansible, puppet or the like", "body": "I hope I am overlooking something. I don't see any decent way to automatedly modify the configuration. In particular to add virtuall hosts.\r\n\r\nIn apache, nginx, and lighttpd one can add/remove virtual hosts (and other configuration) by simply adding/deleting a file, i.e. without touching any of the existing config files. This is quiet easy to do. But modifying YAML files seems rather tedious and error-prone to me...", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1470/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "reshadi": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1439", "title": "dynamic value for proxy.reverse.url based on headers", "body": "Hello,\r\nI'm evaluating the h2o for a new project. It seems like a very interesting and promising project. thanks for your contributions!\r\n\r\nI'm wondering if it is possible to have the value of proxy.reverse.url be picked up from a custom request header.\r\n\r\nAt first I though I can use mruby and read the custom header update the host header or store it somewhere and return a 399, but then couldn't figure out how to read the value in the proxy.reverse.url.\r\n\r\nanother option I considered is using the  http_request() in the mruby. But I'm not sure what are the performance implications of this in terms of keep alive, etc. \r\n\r\nIs there any way to achieve this?\r\n\r\nUsecase:\r\nI have a bunch of servers that contact various backend servers (a large set and regularly changing). Instead of each server directly connecting to those backends, I want them to go through an intermediate h2o server. The client will set the host header to the address of the h2o server, and have a x-host header for the actual backend server name.\r\nThen inside of the h2o server, I need to set the proxy.reverse.url to the value of the x-host header.\r\n\r\nThanks.\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1439/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "mattparlane": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1421", "title": "Old servers hang around after graceful restart", "body": "I am running an h2o server with many hostnames (currently about 4,500), and using Let's Encrypt to generate and renew certs. I am writing the YAML configuration file and then gracefully restarting the server by running\r\n\r\n```\r\nkill -HUP `cat /var/run/h2o.pid`\r\n```\r\n\r\nI am finding that the old server sometimes hangs around indefinitely, and they pile up, consuming memory. Here's `ps afx` after the server has been running for about 12 hours:\r\n\r\n```\r\n   11 ?        S      0:00 perl -x /usr/local/share/h2o/start_server --pid-file=/var/run/h2o.pid --port=0.0.0.0:443 --port=[::]:443 -- /usr/local/bin/h2o -c /etc/h2o.conf\r\n 3228 ?        Sl     1:49  \\_ /usr/local/bin/h2o -c /etc/h2o.conf\r\n 3229 ?        Sl     0:10  |   \\_ /usr/local/bin/h2o -c /etc/h2o.conf\r\n 3232 ?        S      0:00  |   \\_ perl -x /usr/local/share/h2o/annotate-backtrace-symbols\r\n 4634 ?        Sl     0:11  \\_ /usr/local/bin/h2o -c /etc/h2o.conf\r\n 4635 ?        Sl     0:01      \\_ /usr/local/bin/h2o -c /etc/h2o.conf\r\n 4638 ?        S      0:00      \\_ perl -x /usr/local/share/h2o/annotate-backtrace-symbols\r\n```\r\n\r\nHere is part of a log file showing that pid 3228 keeps being TERM'd, but it keeps hanging around.\r\n\r\nhttps://gist.github.com/mattparlane/e94b36eeceea548c45b5cf17a8f01cc9\r\n\r\nAny ideas? Can I give you any more information? Thanks!", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1421/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/987", "title": "Many mruby handlers takes a lot of memory", "body": "I'm not sure if this is a bug or not, but I thought I'd ask to see if it's the expected behaviour.\n\nI'm running 2.0.1 in a Docker container, and it's using a lot of memory, about 4GB. It seems to be because I am using many virtual hosts (currently 507) and have an mruby handler set up for each of them. I'm using Let's Encrypt and generating the config file automatically.\n\nHere's a screenshot of `top`:\n\n![screen shot 2016-07-15 at 1 54 25 pm](https://cloud.githubusercontent.com/assets/176572/16861339/d0933442-4a93-11e6-87c3-23a039eaa1d0.png)\n\nand here's `ps afx` so you can see exactly which one of the processes is using the memory.\n\n![screen shot 2016-07-15 at 1 56 14 pm](https://cloud.githubusercontent.com/assets/176572/16861349/effd79aa-4a93-11e6-8fbb-f0601991bb69.png)\n\nHere's the h2o.conf file -- it's very long, but each of the host sections is exactly the same so you can just look at the first one:\n\nhttps://gist.github.com/mattparlane/6d1c40017849da2cdc398422681fcf94\n\nWithout the mruby handler memory usage drops to around 35KB.\n\nThe memory usage doesn't appear to grow over time, it starts at around 4GB even before any requests come in, and it stays there. \n\nIf that's expected then I can live with it. Thanks!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/987/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "guimard": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1415", "title": "FastCGI support for access control", "body": "Hi all,\r\nI'm developer of [LemonLDAP::NG](https://lemonldap-ng.org) WebSSO system. To support H2O, is it possible to add a FastCGI support to delegate access control to an external process ? Nginx use this with [ngx_http_auth_request module](http://nginx.org/en/docs/http/ngx_http_auth_request_module.html).\r\nRegards,\r\nXavier", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1415/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "JungWooLee1": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1404", "title": "Does the H2o server support mpeg-dash streaming or rtmp??", "body": "I was just a little curious. ", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1404/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "paulmenzel": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1397", "title": "New H2O release", "body": "Almost four months have passed since the release of H2O 2.2.2. A lot of commits have been added to the master branch since then. It\u2019d be great if there was a new release, so that people following releases can profit from it.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1397/reactions", "total_count": 7, "+1": 7, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "eddy-ojb": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1396", "title": "h2o ValueError: No metric tpr", "body": "Hi,\r\n\r\nWhen trying to acquire the recall score using e.g.\r\n\r\nrf_model.recall()\r\n\r\nI get the error: h2o ValueError: No metric tpr\r\n\r\nI can get other metrics, such as the accuracy, AUC, precision and F1 but no recall...\r\nThis is presumably a bug since F1 is a function of recall.\r\n\r\nI am running the h2o version 'h2o-3.15.0.3990'.\r\n\r\nI followed the h2o tutorial:\r\n\r\nhttps://github.com/h2oai/h2o-tutorials/blob/master/training/h2o_algos/src/py/decision_tree_ensembles.ipynb\r\n\r\nand with using my own dataset, I get the error described above.\r\n\r\nAny help?\r\n\r\nAlso, how does one plot a precision / recall curve using h2o?\r\n\r\nThank you in advance\r\n\r\nEd\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1396/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "KenanSulayman": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1392", "title": "Unspecific deadlock after persistent use", "body": "Hey,\r\n\r\nat [PsychonautWiki](https://psychonautwiki.org) h2o is used at the beginning of a long chain of services. Recently, after rolling out a new deployment of the server platform, the service randomly started hanging and became unresponsive. \r\n\r\nI immediately looked at HHVM, a PHP runtime by Facebook, and was certain that it was the cause of the issue. One and a half week in, nothing I did to HHVM fixed the issue at hand.\r\n\r\nI then proceeded recording every web-request to determine wether a targeted DoS is causing downtime. To my surprise, there was no outlier; in fact, the requests continuously decrease in the timeframe the server \"deadlocks.\"\r\n\r\n![2017-08-07 12 52 26](https://user-images.githubusercontent.com/280212/29023752-4d892044-7b6f-11e7-8d07-79a93229cfa8.jpg)\r\n\r\nWithin 5 minutes, the average request latency increases fivefold.\r\n\r\nLooking at the downstream latencies shows no relevant increase:\r\n\r\n![bildschirmfoto 2017-08-07 um 13 03 05](https://user-images.githubusercontent.com/280212/29024138-de31a048-7b70-11e7-984e-96b22a53db8b.png)\r\n\r\nThe latency of h2o increased exponentially over the course of five minutes; while the downstream services stayed below 50ms at any point. H2O simply doesn't accept more requests -- the *actual* throughput is the same.\r\n\r\nOur temporary fix is somewhat crude, but helps working around downtime:\r\n - balance traffic to h2o using HAProxy\r\n - use multiple h2o backends for HAProxy\r\n - unregister from HAProxy, reroll (restart) and register again, every h2o backend (container); every 60 minutes\r\n\r\nSo far we have not seen another downtime.\r\n\r\nThat is, I would be happy to look into ways to actually debug this issue.\r\n\r\n-- Kenan", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1392/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "peymanrah": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1388", "title": "h2o ROC curve does now work", "body": "I have ran the code present at https://github.com/h2oai/h2o-tutorials/blob/master/tutorials/glrm/glrm-tutorial.md in R version 3.3.2 and want to plot the ROC curve of the model by running the code below but it gives me an error. Any help is much appreciated. \r\n\r\n#------code (dl.orig is the deep learner model)\r\n\r\norig.perf = h2o.performance(dl_orig, test)\r\nplot(orig.perf, type = \"roc\")         # Plot ROC curve\r\n\r\n#---response \r\n\r\nError in as.double(y) : \r\n  cannot coerce type 'S4' to vector of type 'double'", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1388/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "xm74": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1371", "title": "Broken fastcgi.spawn?", "body": "I'm trying to setup Mailman 2.1 list server with H2O but without success. Mailman installation contains few CGI binaries in _cgi-bin_ subdirectories and one named _listinfo_ generates main index file so I use / path redirection. Here is my config.\r\n```\r\n    \"my.server:80\"\r\n        listen:\r\n            port: 80\r\n        paths:\r\n            \"/\":\r\n                redirect:\r\n                    status: 301\r\n                    url: https://my.server/\r\n    \"my.server:443\"\r\n        listen:\r\n            port: 443\r\n            ssl: *default_ssl\r\n        paths:\r\n            \"/\":\r\n                file.dir: /usr/local/mailman\r\n                redirect:\r\n                    url: /cgi-bin/listinfo\r\n                    internal: YES\r\n                    status: 307\r\n            \"/cgi-bin\":\r\n                fastcgi.spawn:\r\n                    command: \"exec /usr/local/share/h2o/fastcgi-cgi\"\r\n            \"/icons\":\r\n                file.dir: /usr/local/mailman/icons\r\n            \"/pipermail\":\r\n                file.dir: /usr/local/mailman/archives/public\r\n```\r\nWhen I trying to connect with I got 503 after 30 sec. timeout.\r\n```\r\nroot@beta:/usr/local/mailman # curl -IL http://my.server\r\nHTTP/1.1 301 Redirected\r\nDate: Sun, 16 Jul 2017 21:29:02 GMT\r\nConnection: keep-alive\r\nServer: h2o/2.2.2\r\nlocation: https://my.server/\r\ncontent-type: text/html; charset=utf-8\r\n\r\nHTTP/2 503\r\nserver: h2o/2.2.2\r\ndate: Sun, 16 Jul 2017 21:29:32 GMT\r\ncontent-type: text/plain; charset=utf-8\r\ncontent-length: 21\r\n```\r\nI also tried to call Mailman's binary directly in **fastcgi.spawn** directive using\r\n```\r\ncommand: \"exec /usr/local/mailman/cgi-bin/listinfo\"\r\n```\r\n but with the same negative result.\r\nIs it bug or I'm doing something wrong?", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1371/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1301", "title": "Can't add headers in host and path levels with .php", "body": "See a strange H2O 2.2.2 behavior under FreeBSD. If site using PHP file as index than there is no possibility to add headers at host level. In other case when site usin index.html all works fine. PHP processing goes via file.custom-handler\r\n> ...\r\nfile.custom-handler:\r\n    extension: \".php\"\r\n    fastcgi.connect:\r\n        host: 127.0.0.1\r\n        port: 9000\r\n        type: tcp\r\n...\r\n\r\nHere is two sites. First don't using PHP index, and second does.\r\n>    \"first:443\":\r\n        header.add: \"Strict-Transport-Security: max-age=15768000; includeSubDomains; preload\"\r\n        listen:\r\n            port: 443\r\n            ssl:\r\n                 certificate-file: /usr/local/etc/letsencrypt/live/first/fullchain.pem\r\n                 key-file: /usr/local/etc/letsencrypt/live/first/privkey.pem\r\n        paths:\r\n            \"/\":\r\n                file.dir: /usr/local/www/first\r\n    \"second:443\":\r\n        header.add: \"Strict-Transport-Security: max-age=15768000; includeSubDomains; preload\"\r\n        listen:\r\n            port: 443\r\n            ssl:\r\n                 certificate-file: /usr/local/etc/letsencrypt/live/second/fullchain.pem\r\n                 key-file: /usr/local/etc/letsencrypt/live/second/privkey.pem\r\n        paths:\r\n            \"/\":\r\n                file.dir: /usr/local/www/second\r\n\r\nAnswers:\r\n>--- curl -I https://first\r\nHTTP/2 200\r\nserver: h2o/2.2.2\r\ndate: Sun, 14 May 2017 22:39:37 GMT\r\ncontent-type: text/html\r\nlast-modified: Mon, 11 Jul 2016 17:55:34 GMT\r\netag: \"5783dd96-38bd\"\r\nvary: accept-encoding\r\naccept-ranges: bytes\r\nstrict-transport-security: max-age=15768000; includeSubDomains; preload\r\ncontent-length: 14525\r\n--- curl -I https://second\r\nHTTP/2 200\r\nserver: h2o/2.2.2\r\ndate: Sun, 14 May 2017 22:39:14 GMT\r\nx-powered-by: PHP/5.6.30\r\nset-cookie: second_sessid=ea46d7ad1cb3766feb70e741efb59e9b; path=/; secure; HttpOnly\r\nexpires: Sun, 14 May 2017 22:39:14 GMT\r\nlast-modified: Sun, 14 May 2017 22:39:14 GMT\r\ncache-control: private, no-cache, no-store, must-revalidate, post-check=0, pre-check=0\r\npragma: no-cache\r\nx-dns-prefetch-control: off\r\nx-frame-options: sameorigin\r\ncontent-language: en\r\ncontent-type: text/html; charset=UTF-8\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1301/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "narenkn": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1370", "title": "Error while running http1client in commit 94e5bf3", "body": "Hi,\r\n  I'm trying to build : h2o/examples/libh2o/http1client.c\r\n\r\nwith command :\r\ngcc -g -DUSE_HTTPS=0 -DH2O_USE_LIBUV=0 -DUSE_MEMCACHED=0 -DCTEST=0 -DH2O_ROOT=/home/abcd/learn/h2o -I ../include -I ../../wslay/install/include -L . -L ../../wslay/install/lib -I ../../redis-3.2.9/deps/hiredis -I ../../h2o/install/include -L ../../h2o/install/lib http1client.c -lh2o-evloop -lssl -lcrypto -lz -lpthread -o http1client\r\n\r\nBuild is passing. However I was not able to use the client with external websites like\r\n\r\n---\r\n./http1client http://www.google.co.in\r\nstarting..\r\nfailed to connect to host\r\n----\r\n\r\nwhereas I was able to use the cilent to connect to self-hosted server (same machine)... \r\n\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1370/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "makiyamaju": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1356", "title": "The code of the added mruby library does not work", "body": "Hello\r\nI am trying to add a mruby library to h2o and run it.\r\nI added a library to deps under h2o and wrote the code in mruby's handler file but it does not work.\r\nFor example, if you add mruby-os and run the code OS.machine, it becomes Internal Server Error. It works on mirb.\r\nIs there anything else to do except put the library in deps?\r\nThe environment is Virtualbox + centos 7.3.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1356/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "alxdnlnko": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1352", "title": "Serve different files for http/1 and http/2", "body": "Hi! I saw the mention of `SERVER_PROTOCOL` variable in #782: \r\n> At the moment, it is impossible for a mruby handler to determine the version of the HTTP protocol being used. I think we should provide access to SERVER_PROTOCOL (defined in RFC 3875).\r\n\r\nAny updates on this? I have an idea to serve a bundled app for http/1 clients and unbundled app with server push for http/2 clients. How can I do this? Is it a good idea at all?", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1352/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "kishorenc": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1349", "title": "How to enable gzipped response in libh2o?", "body": "I'm using the `libh2o` library, and I would like to know how I can enable `gzip` compression for responses. This [libh2o example](https://github.com/h2o/h2o/blob/master/examples/libh2o/simple.c) is great, but it does not cover that.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1349/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1259", "title": "Defining a catch-all handler using h2o_create_handler", "body": "I'm using h2o as a HTTP server library. I've got a simple example running, which uses the `h2o_create_handler` function to map handlers to paths. \r\n\r\nHowever, I'm not able to figure out how to define a catch-all, i.e. `*` handler that fires when the other defined handlers don't match the given path. Is that possible? Currently, the `404` response just returns `not found`. I would like to customize this response with by using a catch-all handler.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1259/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1171", "title": "Target libh2o-evloop is not built when OpenSSL is not found", "body": "On a brand new Ubuntu image, after installing just cmake, zlib and build-essential, when I run the following commands, `libh2o-evloop` is not being built at all:\r\n\r\n```\r\n$ cmake -DWITH_BUNDLED_SSL=on .\r\n$ make\r\n$ sudo make install\r\n```\r\nI took a look at `CMakeLists.txt` and it seems like that target is being [explicitly excluded](https://github.com/h2o/h2o/blob/master/CMakeLists.txt#L379) when OpenSSL is not found. Why is that so?", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1171/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "bax-": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1342", "title": "hybrid mode (ECDSA + RSA certs)", "body": "Is it at this moment possible to provide two certificates for one domain (ECDSA and RSA)?\r\nIf not, is this a planned feature?", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1342/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1262", "title": "config for Z-Push", "body": "I tried to set up a config for a branch of Z-Push but wasn't successful.\r\nhttps://github.com/fmbiete/Z-Push-contrib/issues/263\r\nDid anyone have luck here or has a tip on what I might have been missing?", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1262/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/818", "title": "ciphers inherited when cert files match?", "body": "This is a part of my config:\n\n```\n \"push.example.com:80\":\n    paths:\n      \"/\":\n        redirect:\n          status: 301\n          url: https://push.example.com/\n  \"push.example.com:443\":\n    header.setifempty: \"strict-transport-security: max-age=15768000; includesubdomains; preload\"\n    access-log: /var/log/h2o/push.bastianbeutttel.com.log\n    listen:\n      host: 10.0.0.2\n      port: 443\n      ssl: &ssl_push\n        dh-file: *dh-file\n        cipher-preference: *cipher-preference\n        cipher-suite: ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-CHACHA20-POLY1305:EDH+aRSA+AES256:EECDH+aRSA+AES256:!SSLv3\n        certificate-file: /usr/local/etc/ssl/certs/tools.example.com/fullchain.pem\n        key-file:         /usr/local/etc/ssl/certs/tools.example.com/privkey.pem\n    listen:\n      host: XX:XX:XX:XX:XX\n      port: 443\n      ssl: *ssl_push\n    paths:\n      \"/\":\n        proxy.reverse.url: \"http://10.0.0.12/\"\n      \"/.well-known/acme-challenge\": *acme\n\n  \"tools.example.com:80\":\n    paths:\n      \"/\":\n        redirect:\n          status: 301\n          url: https://tools.example.com/\n  \"tools.example.com:443\":\n    header.setifempty: \"strict-transport-security: max-age=15768000; includesubdomains; preload\"\n    access-log: /var/log/h2o/tools.bastianbeutttel.com.log\n    listen:\n      host: 10.0.0.2\n      port: 443\n      ssl: &ssl_tools\n        dh-file: *dh-file\n        cipher-preference: *cipher-preference\n        cipher-suite: *cipher-suite\n        certificate-file: /usr/local/etc/ssl/certs/tools.example.com/fullchain.pem\n        key-file:         /usr/local/etc/ssl/certs/tools.example.com/privkey.pem\n    listen:\n      host: XX:XX:XX:XX:XX\n      port: 443\n      ssl: *ssl_tools\n    paths:\n      \"/\":\n        proxy.reverse.url: \"http://10.0.0.10/\"\n      \"/.well-known/acme-challenge\": *acme\n```\n\nthe second host (`tools.example.com`) uses the same cipher as the first one although `*cipher-suite` is declared in global context like this:\n\n```\nlisten:\n    host: 10.0.0.2\n    port: 443\n    ssl: &SSL\n        minimum-version: TLSv1.2\n        dh-file: &dh-file /usr/local/etc/ssl/dhparam4096.pem\n        cipher-preference: &cipher-preference server\n        # https://calomel.org/h2o.html\n        #cipher-suite: &cipher-suite ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA\n        # https://bettercrypto.org\n        #cipher-suite: &cipher-suite EDH+CAMELLIA:EDH+aRSA:EECDH+aRSA+AESGCM:EECDH+aRSA+SHA256:EECDH:+CAMELLIA128:+AES128:+SSLv3:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!PSK:!DSS:!RC4:!SEED:!IDEA:!ECDSA:kEDH:CAMELLIA128-SHA:AES128-SHA\n        # https://wiki.mozilla.org/Security/Server_Side_TLS#Modern_compatibility\n        cipher-suite: &cipher-suite ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256\n        certificate-file: /usr/local/etc/ssl/certs/www.example.com/fullchain.pem\n        key-file:         /usr/local/etc/ssl/certs/www.example.com/privkey.pem\n```\n\nAll hosts that use a unique certificate and key file use the correct cipher (`&cipher-suite`).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/818/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/812", "title": "ecdsa keys", "body": "I just tried h2o with an ecdsa key generated by [letsencrypt.sh](https://github.com/lukas2511/letsencrypt.sh)\n\nI used secp384r1 when I generated it.\n\nWhen I tried to restart the server it seemed to be in a loop:\n\n```\n[\u2026]\n\nfetch-ocsp-response (using OpenSSL 1.0.1l-freebsd 15 Jan 2015 (Library: OpenSSL 1.0.1p-freebsd 9 Jul 2015))\nsending OCSP request to http://ocsp.int-x1.letsencrypt.org/\n/usr/local/etc/ssl/certs/www.xyz.com/fullchain.pem: good\n    This Update: Feb 22 13:00:00 2016 GMT\n    Next Update: Feb 29 13:00:00 2016 GMT\nverifying the response signature\nverify OK (used: -VAfile /tmp/rQVoXZFDRR/issuer.crt)\nnew worker 18927 seems to have failed to start, exit status:19968\nstarting new worker 18934\n[/usr/local/etc/h2o/h2o.conf:118] in command listen, failed to load private key file:/usr/local/etc/ssl/certs/subdomain.xyz.com/privkey.pem:failed to parse the private key\n\n[\u2026]\n```\n\nThis message more or less repeated over and over.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/812/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/810", "title": "Use default config for test command", "body": "the test commands `h2o --mode -test` and `h2o --test` require a config file to be given or to be executed in the h2o`s config directory.\n\nIt would be nice if they would look at the config in use if no path was given (e.g. `/usr/local/etc/h2o/h2o.conf`)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/810/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/779", "title": "HTTP/2 push not working as expected", "body": "I have h2o setup as a reverse proxy. The backend is also an h2o server with php-fpm behind it.\nThe PHP code sends `link` headers to enable HTTP/2 push but only a part of the resources are being pushed and I don't know why.\n\nThese are the headers send with the index.php:\n\n```\nlink:</static/style/mobile.min.css>; rel=preload; as=style\nlink:</static/style/logo.png>; rel=preload; as=image\nlink:</static/js/script.min.js>; rel=preload; as=script\nlink:</static/style/style.min.css>; rel=preload; as=style\n```\n\nBut only the logo.png has the `x-http2-push:pushed` header  when I open the site in Chrome\u2026\n\nWhat should I check first?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/779/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/763", "title": "feature request: allow 'limit-request-body' in `hosts` context", "body": "If h2o is being used as reverse-proxy, it would be great if setting `limit-request-body\"` would be allowed in `hosts` context.\nI want to allow bigger files only for certain sites.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/763/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/761", "title": "restrict request method", "body": "How to restrict the request method to e.g. only `GET`?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/761/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/760", "title": "wildcard URLs", "body": "Is there a prioritization when using wildcard URLS?\nfor example, could I define host *.example.com and also subdomain.example.com, so that subdomain2.example.com would be fetched by the wildcard but subdomain.example wouldn't?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/760/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/759", "title": "several path directives", "body": "Is it possible to use several path directives under one host?\nI'm trying to use YAML aliases to shorten my configuration.\nI would love to do this:\n\n```\nlisten:\n    host: 127.0.0.1\n    port: 80\nlisten:\n    host: xxx:xxx:xx:::x\n    port: 80\nlisten:\n    host: 127.0.0.1\n    port: 443\nlisten:\n    host: xxx:xxx:xx:::x\n    port: 443\n\nhosts:\n  default:\n    paths: \n      \"/\":\n        file.dir: /path/to/doc-root\n    paths: &acme\n      \"/.well-known/acme-challenge/\":\n         file.dir: /path/to/acme\n\n  \"example.org:443\":\n    listen:\n      ssl:\n        certificate-file: /path/to/example.org.crt\n        key-file:         /path/to/example.org.crt\n    paths:\n      \"/\":\n        proxy.reverse.url: \"http://127.0.0.3:8080/\"\n    paths: *acme\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/759/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/757", "title": "which settings are relevant if h2o is reverse-proxy", "body": "Sorry if this question is too general.\nIf it is, slap my face and I will go somewhere else with it.\n\nIf I use h2o as a reverse proxy, which preferences are relevant / irrelevant?\nI assume all the http/2 settings are important. But what about e.g. gzip and mime types? And headers?\nAnd which settings are only relevant if h2o is the endpoint (I guess http/2 is not).\nShould all the redirects happen at the endpoint? What about errordocs?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/757/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/756", "title": "deny access on certain folders or filetypes", "body": "How would I do deny access on certain folders completely?\nUsing a redirect status 403 without giving a url?\n\nHow would I deny access to e.g. hidden files like .htaccess? (some applications create them by default)\nWould I need ruby for that?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/756/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/754", "title": "using several names for one host", "body": "Is it possible to use several names for one host?\ne.g. If I want to use several hostnames as aliases, I would prefer doing this:\n\n```\nhosts:\n  ['www.example.com', 'subdomain.example.com', 'www.example2.org']:\n    listen:\n      port: 80\n    paths:\n      \"/\":\n        [\u2026]\n```\n\nInstead of rewriting all the settings for each host.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/754/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/753", "title": "variables", "body": "is there any way to use variables?\nE.g. for redirects or headers.\nWhat would I do if I wanted to add a `www.` in front of the request?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/753/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/751", "title": "request: more examples for mruby directives", "body": "coming from nginx, h2o's mruby directives seem unnecessarily complicated and a pain to setup and debug.\n\nI would love to see more examples, especially for common applications like wordpress, own cloud, pydio, etc.\n\nOf course I would even prefer a more simple way of setting up rewrites (like nginx does with the try_files command or caddy)\u2026\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/751/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/750", "title": "feature request: support uwsgi protocol", "body": "", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/750/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/746", "title": "pass and get Real IP from upstream / proxy", "body": "It would be great if the client's real IP would be passed to upstream servers and also received from reverse proxies.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/746/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "DtpEJsaYXDU4GDH8dE4MyI9VrieF0UZpPZ0K76K": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1331", "title": "h2o is MASSIVELY INSECURE BY DEFAULT, allows RC4, DES, 3DES in default config", "body": "h2o is MASSIVELY INSECURE BY DEFAULT, allows RC4, DES, 3DES in default config\r\n\r\nthese should not be enabled in any default config. it is not 1995 any more", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1331/reactions", "total_count": 5, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 5, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1281", "title": "Debian package?", "body": "Debian package?", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1281/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "naritta": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1329", "title": "Parallelize multiple http_requests joining in mruby handler", "body": "When users want to issue multiple http request in mruby handler, http_request needs to join one by one like below.\r\n```\r\nreq1 = http_request(...)\r\nreq2 = http_request(...)\r\nreq3 = http_request(...)\r\n\r\nres1 = req1.join\r\nres2 = req2.join\r\nres3 = req3.join\r\n```\r\nFor now, there is no function to get responses from fastest ended ones.\r\nFor example of our case, when we want to issue 3 http requests and return response to client after 2 fastest request is finished, it's impossible. (When 3 request is same contents but to different server, we can't know which return fastest response. req1 may delay by internet reason.)\r\nThen I want to add some function like ```select``` to parallelize http_requests joining.\r\n\r\nIf it is agreed to add this function, I'll implement this function.\r\n\r\nI'm roughly planning to implement like:\r\n\u30fbadd function ```connect```, which connects and calls resume fiber without calling back ```on_head```.\r\n\u30fbadd function select with 2 arguments, ```requests``` and ```wait_num```. this creates ```ready_socket_list``` and waits ```on_head``` callback by epoll.\r\nWhen ```on_head``` is called, just add the socket to ```ready_socket_list```. (it doesn't parse response at this time.) And if the length of ```ready_socket_list``` meets ```wait_num```, it resumes fiber and return ```ready_socket_list```.\r\n\r\nFor example,  we can write like this.\r\n```\r\nreq1 = http_request(...)\r\nreq2 = http_request(...)\r\nreq3 = http_request(...)\r\n\r\nreq1.connect\r\nreq2.connect\r\nreq3.connect\r\n\r\nready_requests = HttpRequest.select([req1, req2, req3], 2)\r\nres1 = ready_requests[0].join\r\nres2 = ready_requests[1].join\r\n```", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1329/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "josephg": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1327", "title": "Feature Request: Ignore server push request instead of cancelling it (CASPER)", "body": "Currently if you initiate a server push to chrome, then cancel the push, chrome will remove the item from its browser cache and re-fetch it.\r\n\r\nIt might make sense for H2O to ignore preloading items specified by the `link:` header when the server can tell subresource is already known by the client. (Ie, when the root document is on the same domain as the subresource and the root document has a casper cookie which contains the subresource).\r\n\r\nThat would reduce backend server load, reduce unnecessary network traffic and (I think) fix server push on chrome.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1327/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1326", "title": "examples/simple http2 does not work - INADEQUATE_TRANSPORT_SECURITY", "body": "The simple example's HTTP2 SSL configuration doesn't work in chrome or firefox. I'm not sure how to debug it or fix it.\r\n\r\nRunning 2.2.x branch from xcode. libevent mode, although the same thing happens in libuv and on master.\r\n\r\nChrome 58 / 59:\r\n\r\n![screen shot 2017-06-10 at 2 14 58 pm](https://user-images.githubusercontent.com/47413/26999877-4b5119a4-4de7-11e7-827a-5659a1308b0c.png)\r\n\r\nFirefox 54:\r\n\r\n<img width=\"702\" alt=\"screen shot 2017-06-10 at 2 15 08 pm\" src=\"https://user-images.githubusercontent.com/47413/26999879-56a76650-4de7-11e7-8e63-b969a0d43a8e.png\">\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1326/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1325", "title": "examples/simple crashes from SSL disconnect", "body": "I'm playing with the simple example. I've enabled https (by editing the #define) and pointed it at the SSL certs in the repository.\r\n\r\nChrome is immediately disconnecting with an INADEQUATE_SECURITY error. And then mashing Cmd+R in chrome crashes the server:\r\n\r\nI'm running the 2.2.x branch in libevent/debug mode through xcode. I can reproduce the problem on master, and using libuv. I can give you stack traces for them instead if you'd prefer.\r\n\r\n```\r\nThread 1: Signal SIGPIPE\r\n\r\n(lldb) bt all\r\n* thread #1, queue = 'com.apple.main-thread', stop reason = signal SIGPIPE\r\n  * frame #0: 0x00007fffa9c057fe libsystem_kernel.dylib`writev + 10\r\n    frame #1: 0x000000010000a657 examples-simple`write_core(fd=7, bufs=0x00007fff5fbff448, bufcnt=0x00007fff5fbff460) at evloop.c.h:166\r\n    frame #2: 0x0000000100007f61 examples-simple`do_write(_sock=0x000000010060fa30, _bufs=0x000000010201ac30, bufcnt=1, cb=(examples-simple`shutdown_ssl at socket.c:356)) at evloop.c.h:265\r\n    frame #3: 0x00000001000081b5 examples-simple`flush_pending_ssl(sock=0x000000010060fa30, cb=(examples-simple`shutdown_ssl at socket.c:356)) at socket.c:301\r\n    frame #4: 0x0000000100007715 examples-simple`shutdown_ssl(sock=0x000000010060fa30, err=0x0000000000000000) at socket.c:390\r\n    frame #5: 0x000000010000674a examples-simple`h2o_socket_close(sock=0x000000010060fa30) at socket.c:458\r\n    frame #6: 0x000000010001af7b examples-simple`close_connection_now(conn=0x0000000100507ff0) at connection.c:284\r\n    frame #7: 0x000000010001aa39 examples-simple`close_connection(conn=0x0000000100507ff0) at connection.c:295\r\n    frame #8: 0x000000010001a105 examples-simple`on_read(sock=0x000000010060fa30, err=\"I/O error\") at connection.c:890\r\n    frame #9: 0x000000010000aae6 examples-simple`read_on_ready(sock=0x000000010060fa30) at evloop.c.h:235\r\n    frame #10: 0x000000010000a8bd examples-simple`run_socket(sock=0x000000010060fa30) at evloop.c.h:495\r\n    frame #11: 0x0000000100006c68 examples-simple`run_pending(loop=0x0000000100503d00) at evloop.c.h:533\r\n    frame #12: 0x0000000100006789 examples-simple`h2o_evloop_run(loop=0x0000000100503d00, max_wait=2147483647) at evloop.c.h:578\r\n    frame #13: 0x0000000100001074 examples-simple`main(argc=1, argv=0x00007fff5fbff6e0) at simple.c:260\r\n    frame #14: 0x00007fffa9ad5235 libdyld.dylib`start + 1\r\n```\r\n\r\nIt looks like the bug is that after chrome closes the SSL socket, h2o is trying to flush some more ssl data before cleaning up. Only, the socket is already closed. Hence SIGPIPE.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1325/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "Tintinabula": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1317", "title": "FreeBSD 11.0 hiredis build error", "body": "Building the latest H2O errors out on hiredis. Last time we built H2O was before hiredis was added.\r\n\r\nOS: FreeBSD 11.0-RELEASE , patched\r\n\r\n```\r\nFreeBSDzfs:  cmake -DCMAKE_INSTALL_PREFIX=/usr/local \r\n     -DCMAKE_CXX_FLAGS=\"-Wall -ggdb3 -O2 \r\n     -fstack-protector-all -D_FORTIFY_SOURCE=2 -Wformat \r\n     -Werror=format-security -std=c++0x -fvisibility=hidden\" \r\n     -DCMAKE_C_FLAGS=\"-Wall -ggdb3 -O2 -fstack-protector-all \r\n     -D_FORTIFY_SOURCE=2 -Wformat -Werror=format-security \r\n     -fvisibility=hidden\" -DWITH_BUNDLED_SSL=on \r\n     -DWITH_PICOTLS=on -DWITH_MRUBY=on . && \r\n     make && make install && echo OKOKOKOKKOKO\r\n\r\n-- The C compiler identification is Clang 3.8.0\r\n-- The CXX compiler identification is Clang 3.8.0\r\n-- Check for working C compiler: /usr/bin/cc\r\n-- Check for working C compiler: /usr/bin/cc -- works\r\n-- Detecting C compiler ABI info\r\n-- Detecting C compiler ABI info - done\r\n-- Detecting C compile features\r\n-- Detecting C compile features - done\r\n-- Check for working CXX compiler: /usr/bin/CC\r\n-- Check for working CXX compiler: /usr/bin/CC -- works\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Could NOT find PkgConfig (missing:  PKG_CONFIG_EXECUTABLE) \r\n-- Looking for pthread.h\r\n-- Looking for pthread.h - found\r\n-- Looking for pthread_create\r\n-- Looking for pthread_create - not found\r\n-- Looking for pthread_create in pthreads\r\n-- Looking for pthread_create in pthreads - not found\r\n-- Looking for pthread_create in pthread\r\n-- Looking for pthread_create in pthread - found\r\n-- Found Threads: TRUE  \r\n-- Found OpenSSL: /usr/lib/libssl.so;/usr/lib/libcrypto.so (found version \"1.0.2k\") \r\n-- Found ZLIB: /usr/lib/libz.so (found version \"1.2.8\") \r\n-- Found LIBUV: /usr/local/lib/libuv.so  \r\n-- libuv found but ignored; is too old\r\n-- Could NOT find WSLAY (missing:  WSLAY_LIBRARIES WSLAY_INCLUDE_DIR) \r\n-- Configuring done\r\n-- Generating done\r\n-- Build files have been written to: /tmp/h2o\r\nScanning dependencies of target libh2o-evloop\r\n[  0%] Building C object CMakeFiles/libh2o-evloop.dir/deps/cloexec/cloexec.c.o\r\n[  0%] Building C object CMakeFiles/libh2o-evloop.dir/deps/hiredis/async.c.o\r\n[  1%] Building C object CMakeFiles/libh2o-evloop.dir/deps/hiredis/hiredis.c.o\r\n[  1%] Building C object CMakeFiles/libh2o-evloop.dir/deps/hiredis/net.c.o\r\n/tmp/h2o/deps/hiredis/net.c:435:29: error: use of undeclared identifier 'AF_LOCAL'\r\n    if (redisCreateSocket(c,AF_LOCAL) < 0)\r\n                            ^\r\n/tmp/h2o/deps/hiredis/net.c:460:21: error: use of undeclared identifier 'AF_LOCAL'\r\n    sa.sun_family = AF_LOCAL;\r\n                    ^\r\n2 errors generated.\r\n*** Error code 1\r\n\r\nStop.\r\nmake[2]: stopped in /tmp/h2o\r\n*** Error code 1\r\n\r\nStop.\r\nmake[1]: stopped in /tmp/h2o\r\n*** Error code 1\r\n\r\nStop.\r\nmake: stopped in /tmp/h2o\r\n\r\nroot@FreeBSDzfs:  \r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1317/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1118", "title": "Can we deny client Range: requests ?", "body": "Is there a recommended method of rejecting clients who ask for a range of bytes of a single file using the \"Range:\" header ?\r\n\r\nFor example, the server provides small static files and there is little reason a client would need to request the first 1KB of a 10KB file. We would prefer to deny client requests which ask for a range of data containing the \"Range:\" header thus reducing our disk I/O.\r\n\r\nI did not see a server configuration option to turn off range requests like \"range: off\". Please correct me if I am wrong.\r\n\r\nWould mruby be a solution by looking for the \"Range:\" header ? Not sure of the variable which would contain the headers, but an idea could be:\r\n\r\n```\r\n  mruby.handler: |\r\n      Proc.new do |env|\r\n        if $headers.include?(\"range\\:\")\r\n            [416, {'content-type' => 'text/plain'}, [\"requested range not satisfiable\"]]\r\n        else\r\n            [399, {}, []];\r\n      end\r\n  end\r\n```", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1118/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/839", "title": "FreeBSD accf_data accept() filter support", "body": "Feature Request: FreeBSD accf_data accept() filter support\n\nThe accept() filter in FreeBSD will buffer incoming connections until client\ndata arrives at which point the daemon, like an https web server, will receive\nthe connected descriptor via accept(). If the client never sends any data then\nthe https daemon will not waist any processing time on the connection. The\nfilter should allow the H2O daemon to serve more clients by filtering out non\nresponsive clients.\n\nFreeBSD Man Page, ACCF_DATA\nhttps://www.freebsd.org/cgi/man.cgi?query=accf_data\n\nThe accf_data kernel module loaded by adding accf_data_load=\"YES\" to\n/boot/loader.conf\n\nThe accf_data and accf_http FreeBSD filters are currently supported in Apache,\nNginx and Varnish. I am not sure if the addition of the accf_data filter will\nbenefit H2O.\n\nLinux has a similar, but incompatible accept filter:\n\nTCP_DEFER_ACCEPT (since Linux 2.4) Allow a listener to be awakened only when\ndata arrives on the socket. Takes an integer value (seconds), this can bound\nthe maximum number of attempts TCP will make to complete the connection.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/839/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "wujunjenny": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1304", "title": "Can I compile libh2o under windows", "body": "", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1304/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "fmunteanu": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1291", "title": "Proper usage of logrotate with H2O?", "body": "Hi,\r\n\r\nI'm in the process of building an rpm for CentOS 7 and I need some clarification if H2O supports SIGUSR1 signals. Intended logrotate usage for both access.log and error.log:\r\n\r\n```\r\n/var/log/h2o/*.log {\r\n\tdaily\r\n\trotate 14\r\n\tmissingok\r\n\tcompress\r\n\tdelaycompress\r\n\tnotifempty\r\n\tcreate 0640 h2o root\r\n\tsharedscripts\r\n\tpostrotate\r\n\t\t/bin/kill -USR1 `cat /run/h2o.pid 2>/dev/null` &>/dev/null || :\r\n\tendscript\r\n}\r\n```\r\n\r\nRegards,\r\n\r\nFloren", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1291/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "tatsushid": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1285", "title": "Proxy choose IPv6 address though it doesn't have IPv6 connectivity", "body": "Hello,\r\n\r\nThanks for developing a high quality HTTP2 server!\r\n\r\nI'd like to report an issue related to DNS name resolving and client access to a remote host in reverse proxy.\r\n\r\nThe summary is, H2O could choose and try to connect to an IPv6 address of a remote host in proxy mode though a host on which H2O is running doesn't have IPv6 connectivity.\r\n\r\nThe details is followings.\r\n\r\nH2O reverse proxy directive enables a reverse proxy and when a request comes, it is handled in `h2o_http1client_connect` which resolves the host's IP addresses if the hostname isn't an IP address nor an unix domain socket then access to it.\r\n\r\nTo look up IP addresses, `h2o_http1client_connect` calls `h2o_hostinfo_getaddr` and it finally reaches `getaddrinfo` in `lookup_and_respond` with `AF_UNSPEC` flag. It gets both IPv4 and IPv6 (A and AAAA DNS records) addresses and returns. To suppress AAAA resolving, it is called with `AI_ADDRCONFIG`, but it doesn't work on IPv4 only host with link-local IPv6 address (See https://fedoraproject.org/wiki/QA/Networking/NameResolution/ADDRCONFIG). I tested on some Linux distributions and the results are same.\r\n\r\nAfter this, in `on_getaddr` of `httpclient1.c`, H2o tries to connect to a remote host with a destination address chosen by `h2o_hostinfo_select_one` but this choose an address in random order so it could choose an IPv6 address resolved by the above way on IPv4 only host. It causes a connection error.\r\n\r\nFor example, it happens on TravisCI when bundled test `t/50reverse-proxy-https.t` is running. en.wikipedia.org used in the test has both A and AAAA record and causes the issue. It could happen on many Linux environment, they are only connected to the Internet by IPv4 while IPv6 is not disabled completely by kernel setting.\r\n\r\nI think there are some way to improve it.\r\n\r\n1. at choosing an address to connect, give priority to IPv4 if it exists.\r\n2. if IPv6 connection fails, fallback to IPv4\r\n3. add something flag to configuration to change the behavior\r\n4. it is for reverse proxy. users know what servers are accessed so do nothing, just recommend to assign proper DNS records to them :)\r\n\r\nIt is a kind of minor, not so big issue but I'd just like to report.\r\n\r\nAgain, thanks for developing great software!", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1285/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "taosx": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1283", "title": "Missing delay (sleep, Thread.sleep) in mruby?", "body": "I wrote a mruby handler which uses http_request to keep my cache fresh in wordpress but because I don't know of any way to sleep the handler and it does too many requests it fails the request because php can't keep up.\r\n\r\nIs there any way to sleep for some seconds in h2o using mruby (I tried installing custom Thread mruby extension but I can't seem to get date for response out of thread)?\r\n\r\nThe error:\r\n`[lib/handler/fastcgi.c] in request:/index.php/tag/science:connection failed:failed to connect to host`\r\n\r\nThe code:\r\n```\r\nif request_is_from_self and links_file_exist and req_is_get\r\n    links = `php #{links_filepath}`\r\n\r\n    for link in links.split(' ') do\r\n        req = http_request(link)\r\n        _, _, _ = req.join\r\n    end\r\nend\r\n```", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1283/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "paulpref": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1280", "title": "Feature Request: LibreSSL 2.5.3 or later", "body": "[LibreSSL 2.5.3](https://ftp.openbsd.org/pub/OpenBSD/LibreSSL/libressl-2.5.3-relnotes.txt) became the latest stable release of LibreSSL on April 11th, 2017.\r\n\r\nWould it be possible to update the bundled LibreSSL to version 2.5.3 or later so h2o can offer the new ECDH X25519 goodies as well as the sane default curve list mentioned in #713?\r\n\r\n(I\u2019m not sure I\u2019m helping or just adding noise with this type of issue: I\u2019m inspired by #1094, but please let me know if this is useful or not. I really appreciate all the hard work put into h2o, it\u2019s a great project, and a true joy to use. Thanks!)", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1280/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "geirarnesen": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1278", "title": "How to pass  ip in custom proxy header field", "body": "We want to use h2o for ssl-termination in front of Varnish.\r\nI need to set my own custom header field, - ie:\r\nproxy.header.add: \"X-MY-Client-IP: {client ip variable}\"\r\n\r\nI'm looking for a variable I may pass into the config which will pass the client ip lik in x-forwarded-for\r\n\r\nGeir\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1278/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "lkwg82": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1269", "title": "[question] How to enable compression for all response?", "body": "I do know, that I can enable compression via \r\n- header `x-compress-hint`\r\n- specific mimetypes\r\n\r\nBut how do I enable for all mimetypes, even unknown ones?\r\n\r\nCheer Lars", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1269/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "MEMBER"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/53573258", "body": "Yes it was. See the new Dockerfile in the separate repository: https://github.com/lkwg82/h2o.docker/blob/master/Dockerfile\n\nCheers Lars\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/53573258/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "MEMBER"}]}, "Lupus": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1253", "title": "Streaming processing of large HTTP request body in libh2o", "body": "It seems that asking this question separately as opposed to discussion in closed FAQ issue will be more appropriate. In #92 there was a question on streaming of large request bodies, and 2 years ago the answer was that it is not possible to stream request bodies. Is this still the case now?\r\n\r\nFor some context: we're considering libh2o as an HTTP solution for an in-house application server, and we need to receive uploads of large files, stored in a distributed storage cluster behind, so we might not have enough RAM/HDD to receive the whole file. We might limit single upload to say 5GB (like S3 does), but we would still have to transfer those 5GB to backend storage once they arrive to request handler and the end user would have to look at 100% progress meter while we're doing that (as he already uploaded all the content).", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1253/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "JoeUX": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1244", "title": "SLOC estimate/comparison with nginx", "body": "Hi Kazuho \u2013 Do you have an estimate on the number of lines of code (SLOC) in h2o? I think it would be very useful to be able to compare h2o's SLOC with nginx, Apache, lwan, kestrel, etc.\r\n\r\nGitHub doesn't have an easy way of finding this via the web interface. I think they have an API where we could infer it from historical SLOC added and removed from the first check-in onward, but I'm not sure how accurate/valid their SLOC estimates are (Is it bucketed by language? Does it understand what gets built and what doesn't?). There's a Firefox extension too, but again I'm not sure about the accuracy. I think the creators and chief contributors of a project would have more accurate figures.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1244/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1110", "title": "Request: Add project to Coverity Scan or similar", "body": "I like H2O a lot, but C makes me nervous given how easy it is to have exploitable memory bugs. Would you consider putting H2O on [Coverity Scan](https://scan.coverity.com/) so that at least some of those kinds of bugs can be detected more easily? It's free for open-source projects.\n\nIt would also be helpful to have a documented strategy for avoiding typical C security holes (buffer and memory bugs, mostly). Neverbleed is brilliant, and lower level code analysis tools like Coverity or the different sanitizers in clang/llvm would be a good combination with it.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1110/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/962", "title": "SSE compiler flags and dependencies", "body": "Hi all \u2013 Are there any instructions for which compiler flags are recommended when building from source? PicoHTTPParser uses the `PCMPESTRI` instruction from SSE 4.2, but I don't see anything about compiler flags for SSE 4.2. Assuming GCC, I'm thinking of options [like these](https://gcc.gnu.org/onlinedocs/gcc-6.1.0/gcc/x86-Options.html#x86-Options) where you can specify minimum CPU architecture (-march='nehalem') or specific instruction sets (-msse4.2).\n\nAre there any other guidelines for optimization? GCC has a whole bunch of [options here](https://gcc.gnu.org/onlinedocs/gcc-6.1.0/gcc/Optimize-Options.html#Optimize-Options). Does anything change if I use clang for FreeBSD?\n\nThanks.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/962/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "Lennie": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1243", "title": "/usr/src/h2o-2.1.0/lib/common/socket.c:817: error: \u2018TLS1_CK_RSA_WITH_AES_128_GCM_SHA256\u2019 undeclared (first use in this function)", "body": "When I run on an older machine with a freshly installed latest version of cmake 3.7.2:\r\n\r\n$ cmake -DWITH_BUNDLED_SSL=on .\r\n$ make\r\n\r\nI got the error above from the title:\r\n\r\n/usr/src/h2o-2.1.0/lib/common/socket.c:817: error: \u2018TLS1_CK_RSA_WITH_AES_128_GCM_SHA256\u2019 undeclared (first use in this function)\r\n\r\n(it's obviously longer)\r\n\r\nBut when I run:\r\n\r\nmake bundled-ssl\r\n\r\nAnd add:\r\n-I/usr/src/h2o-2.1.0/libressl-2.4.4/include to C_INCLUDES in the following 2 files:\r\nCMakeFiles/libh2o-evloop.dir/flags.make\r\nCMakeFiles/libh2o.dir/flags.make\r\n\r\nIt does build:\r\n\r\nShouldn't cmake have added them when I added WITH_BUNDLES_DDL=on ?\r\n\r\nHope this was helpful.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1243/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "chenbd": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1237", "title": "what's the difference between library libh2o and libh2o-evloop? is it possible use websock in library without libuv?", "body": "Hi,\r\nAfter a glance at CMakeList.txt, there are two libraries libh2o and libh2o-evloop from the project.\r\nwhat's the difference between them?\r\n\r\nfrom https://github.com/h2o/h2o/blob/master/examples/libh2o/websocket.c\r\ni can see the example websocket.c is using libuv, is it possible use server function and websock in library without libuv?\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1237/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [{"url": "https://api.github.com/repos/h2o/h2o/commits/20150ffb4e88645e5dcdcc16a63f55851b7584bc", "message": "fix review issues about \"h2o_cleanup_thread\""}, {"url": "https://api.github.com/repos/h2o/h2o/commits/02323a9c263fc305daa3897b882663d79e680048", "message": "add interface h2o_tls_data_dispose()\n\nThe function can be used when needed to release the resources associated to the TLS"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/bc51c0b5fba46950e9a708973efe55946a4e1674", "message": "close epoll / kqueue socket on destroy"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a860828143f23685548229935b3dfff8052df135", "message": "fix review issues for \"h2o_mem_alloc_pool()\""}, {"url": "https://api.github.com/repos/h2o/h2o/commits/4dd533de8abbc2f17e5065b5c92260c87b946add", "message": "fix review issues for \"h2o_mem_alloc_pool()\""}, {"url": "https://api.github.com/repos/h2o/h2o/commits/adc3b6bd68c0b6182ac4e8f1e42993efc6fe88df", "message": "try adding aligment to \"h2o_mem_alloc_pool()\"\n\nissues #1597"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ba0812ebd0ad232adfcfeccb8bdf2539696eddfc", "message": "websocket: reset conn->_write_buf.cnt in on_write_complete()"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/93b2f8afa3b71c5ca1d96096125925068b86770b", "message": "fix \"examples-latency-optimization\" to \"examples-latency-optimization-evloop\", make \"lib-examples-evloop\" as a dependency of \"check\""}, {"url": "https://api.github.com/repos/h2o/h2o/commits/7913c0953620621bd6044f439ee9380bbb298c19", "message": "replace \"FILENAME_MAX\" with \"H2O_TMP_FILE_TEMPLATE_MAX\"\n\nsee issues #1586"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a5bad4d8b5c39b9b3a87691443af339d6754d0bc", "message": "websocket: judge NULL pointer when free write buffer in on_write_complete()"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/2b59b7edd3b9f937ecd00704f45c7bc7c99fc676", "message": "avoid infinite loop when user want send more bufers count than ours in on_msg_callback()"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/738f9b19c3d49f0693c884e3c9b3499a4af3be7c", "message": "add target \"lib-examples-evloop\"\n\n\"examples-latency-optimization\" is not changed because it depenps libh2o-evloop"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0e4a3a71ce15d1821f5057f9f0b0b5a03a5d2404", "message": "websocket: use h2o_mem_alloc() in send_callback(), and freed when on_write_complete()"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/3a651cdb60dceceea4b3587a51ea2e4facb0830a", "message": "remove unsed prototype in \"include/h2o/websocket.h\""}, {"url": "https://api.github.com/repos/h2o/h2o/commits/f25d751ce2310104a0f95d0458550dc03ddef5b0", "message": "queue 4 chunks for wslay's send_callback(), and merged with one h2o_socket_write() call"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/b4371bf1e498f539a9a15d23a9eed94bb1b27972", "message": "clang-format for \"examples/libh2o/websocket.c\""}, {"url": "https://api.github.com/repos/h2o/h2o/commits/28b916a0fadc7d1144537b7888e62a15abb5d226", "message": "\"lib-examples\" built when \"LIBUV_FOUND\" is false against libh2o-evloop"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ce65fc911aefa332819a7f419ae0ba1762ffaa1d", "message": "\"examples/libh2o/websocket.c\" built support without libuv"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/184090a2f851ccc1418b68390e4f65d47c902024", "message": "remove redundant assignments (amends #801; closes #1584)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/781c37a3821bc52f807b97c74811ca1f46272aa5", "message": "more clean up about \"move TCP_NODELAY\""}, {"url": "https://api.github.com/repos/h2o/h2o/commits/482a307910ac08adb36175a4f1b548749417f5c0", "message": "fix coding miss (missing \";\")"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a388777f697e24bc99ce140a3b9032684902181a", "message": "move TCP_NODELAY flag setting to h2o_evloop_socket_create()"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/83cd70883ba71e6a1534aae9a21c2e71dfd3b3f1", "message": "set \"TCP_NODELAY\" on accepted socket in case of not inherit from listening socket"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/3dbe9bc2a5cfcb8d550cb4477dd9f8c8f2db87b1", "message": "fix ci error: Failed test at t/40unix-socket.t line 26"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0cab5f58af52b3ef756975af964228823eca6d10", "message": "fix ci error: Linking C executable examples-simple"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/98dc0dd0a38c0bf2661dc258d37bf8e420e0c728", "message": "move \"TCP_NODELAY\" from accepted socket to listening socket"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/fd81e393f978d9625e3b3fb28cbcc6b390dc329d", "message": "revert latency-optimization.c and simple.c"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/2b22dcb54c81a74fd962731a105d33c51c3fe892", "message": "change macro name from \"SERVER_STARTER_ENV_NAME\" to \"SERVER_STARTER_PORT\""}, {"url": "https://api.github.com/repos/h2o/h2o/commits/413b337913a8b7b28503743bf690abf65359c0b5", "message": "setting the O_NONBLOCK flag in the public functions of evloop.c.h"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/9bfc1074876d1f1658cb86908717b24049b55aa9", "message": "more changes about removing duplicate fcntl with O_NONBLOCK call"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/249c1510474c596407b66ebc6073954114837be2", "message": "move \"SERVER_STARTER_PORT\" to macro \"SERVER_STARTER_ENV_NAME\""}, {"url": "https://api.github.com/repos/h2o/h2o/commits/63361794c8d205f122d348f5e6cc40627b98a827", "message": "remove duplicate fcntl with O_NONBLOCK call"}], "pull_requests": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/1567", "title": "enable SO_REUSEPORT under linux", "body": "SO_REUSEPORT was done in kernel 3.9:\r\nhttps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=c617f398edd4db2b8567a28e899a88f8f574798d\r\n\r\nabout The SO_REUSEPORT socket option:\r\nhttps://lwn.net/Articles/542629/\r\n\r\ncan we gain better performance and load balance with SO_REUSEPORT enabled?\r\n", "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/1531", "title": "try using epoll_create1 when available", "body": "try using epoll_create1 with flag EPOLL_CLOEXEC when available\uff0c so that we can omit fcntl() call.", "author_association": "CONTRIBUTOR"}], "issue_comments": [], "commit_comments": [], "review_comments": []}, "felipewd": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1230", "title": "Logging SSL handshake failure", "body": "Hi all,\r\n\r\nCurrently, I cannot catch neither with %{error}x in access-log, nor with error-log.emit-request-errors any SSL handshake failures. Is there a way to do this?\r\n\r\nI'd like something similar to haproxy's Error Log:\r\n\r\nhttp://cbonte.github.io/haproxy-dconv/1.6/configuration.html#8.2.5\r\n\r\nwhich would produce a simple: \r\n\r\n`https-in/1: SSL handshake failure`\r\n\r\nThis'd be useful for me, for example, as a way to catch clients without SNI that are trying to do a TLS handshake and getting a wrong certificate.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1230/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "alexhultman": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1228", "title": "Seamless libh2o <-> \u00b5WebSockets integration", "body": "Hi,\r\n\r\nI want to integrate \u00b5WS with libh2o so that http2/websockets are handled respectively by the two projects. To do this I need a file descriptor, an SSL pointer and a common event-loop. Looking at the websockets example the two first requirements seem easy to solve but the event-loop integration will probably need some work.\r\n\r\nWe both can run on libuv but I read that libh2o is better off without libuv and I'm personally looking to distance \u00b5WS from libuv with next release. By default I run on raw epoll now and this layer is separate from the application level so if necessary I could write a small libh2o event-loop backend.\r\n\r\nWhat event-loop is used in libh2o? libev? Raw epoll? To build an event-loop integration for libh2o I need to have: Polls, Timers, Async and Loop components. Async would be as in uv_async_t.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1228/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "VladimirMaksovic": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1220", "title": "libh2o buffered responce", "body": "Hi,\r\n\r\nI would like to create a web service which relies on third party lib.\r\nThis lib is creating data and it's giving a callback when the data is available.\r\nWhen the data arrives, it is in prepared memory chunk (continues buffer).\r\n\r\nI've checking couple of HTTP server libs, and either I'm not understanding something, or all of them are prepared for the file descriptor data and not buffered data.\r\n\r\nIn the H2O, if I understood it right, h2o_generator_t should be used for similar cases.\r\nAlso, if I understood it well, h2o_generator_t works in \"pull\" mode.\r\nCan you please confirm my understanding?\r\n\r\nIf yes, is there a way to create \"push buffer\" model in H20?\r\nIf yes, do you have some pointer?\r\n\r\nThanks a lot for your help,\r\nVladimir", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1220/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "zenny": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1207", "title": "h2o as reverse proxy to nginx with letsencrypt", "body": "Hi,\r\n\r\nInternet--->h20 listening on port 80 and 443 as reverse proxy with letsencrypt support --> several nginx/h2o servers running in the background.\r\n\r\nIs there any suggestions and links to realize something like above similar to the ones for pound reverse proxy at https://secwise.nl/lets-encrypt-certifcates-and-pound-load-balancer/ and https://github.com/bmsleight/teletubbies-pound.\r\n\r\nAfter looking at the benchmarks, h2o can be an ideal backend, too, but there are some bottleneck due to the shared hosting, managed by ISPconfig3 at the backend, fyi. ;-)\r\n\r\nThanks for the inputs!\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1207/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "pyros2097": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1205", "title": "Build a http web framework?", "body": "Is is feasible to build a http web framework like openresty on top of h2o? Will mruby cause a performance hit if database call or http requests are made in the handlers? Is the mruby handler code going to be cached or something because if I implement huge libraries in mruby and it imports all the libraries again in every request it is going to slow down performance", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1205/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "noogeu": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1202", "title": "endless redirect cycle", "body": "h2o 2.1.0 (also tried with 2.2.0-DEV) does an endless redirect cycle for the following configuration:\r\n\r\n```yaml\r\nuser: nobody\r\ncompress: ON\r\nfastcgi.timeout.io: 600000\r\n\r\nfile.custom-handler:\r\n    extension:  .php\r\n    fastcgi.spawn:\r\n        command: \"PHP_FCGI_CHILDREN=10 exec /opt/php7/bin/php-cgi\"\r\n        user:   nobody\r\n\r\nfile.index: [ 'index.php', 'index.html', 'index.htm', 'index.txt' ]\r\n\r\nhosts:\r\n  \"localhost\":\r\n    listen:\r\n      port: 80\r\n    paths:\r\n      /:\r\n        file.dir: /srv/www\r\n      /bolt:\r\n        file.dir: /srv/cms/bolt/public\r\n        file.index: [ 'index.php' ]\r\n\r\naccess-log: /var/log/h2o-access.log\r\nerror-log: /var/log/h2o-error.log\r\npid-file: /run/h2o.pid\r\n```\r\n\r\nNow if I do: \"wget -S -O- http://localhost/bolt/\" then I get a 301 location /bolt,\r\nwhich goes to http://localhost/bolt, which gives 301 location: /bolt/,\r\nand the cycle continues for 20 times in total.\r\n\r\nI tried adding a slash in the configuration to /bolt/: and/or to file.dir: /srv/cms/bolt/public/,\r\nbut to no avail. In the first case /bolt is no longer found (as /srv/www/bolt doesn't exist.)\r\n\r\nIf I wget localhost/bolt/index.php then the page is fetched fine! The file clearly exists.\r\nRemoving \"file.index: [ 'index.php' ]\" doesn't help.\r\n\r\nI have something similar with an installation of grav-admin in /srv/www/user/grav-admin/\r\nIt also gives an endless cycle with/without trailing slash. Never fetching the index.php which is in that directory. I checked all file permissions, they are readable/searchable everywhere.\r\nphp-cgi runs fine, processing index.php okay.\r\n\r\nWhat is the problem?\r\nTo me it seems the ", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1202/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "andydavies": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1150", "title": "Set headers based on mimetype", "body": "I'd like to be able to set headers based on the mimetype of the response e.g. only set CSP header on html responses\r\n\r\nJust checking I haven't missed something as based on my reading of the docs this isn't currently possible?", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1150/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/584", "title": "Resources pushed in opposite order to order listed in HTTP link header", "body": "When there are multiple push requests how does h2o prioritise their order?\n\nI was expecting them to be pushed in the order they are listed in the HTTP link headers, or perhaps use another heuristic based on mimetype but it appears the header and data frames are sent in reverse order to the order they are listed in the HTTP header.\n\nMy test environment is h2o/1.5.0, proxying nginx/1.4.6 with a simple static site template I found on the web - https://http2.andydaves.me/interio\n\nhttp2-reprioritize-blocking-assets is set to off\n\nI've been using the test site to experiment with pushing CSS, JS and fonts but looking at the waterfalls in WebPageTest and Chrome's netinternals the first resources pushed actually get their bytes last, and vice versa.\n\nTake these two tests where the only difference is the order of the link headers to trigger h2o to push:\n- https://http2.andydavies.me/interio/index-fonts-push-css-js-woff2.html\n\nHeaders for push are set in this order by nginx\n\n```\nlink: </interio/css/reset.css>; rel=preload; as=stylesheet\nlink: </interio/css/style.css>; rel=preload; as=stylesheet\nlink: </interio/css/grid.css>; rel=preload; as=stylesheet\nlink: </interio/js/jquery-1.6.2.min.js>; rel=preload; as=script\nlink: </interio/js/jquery.galleriffic.js>; rel=preload; as=script\nlink: </interio/js/jquery.opacityrollover.js>; rel=preload; as=script\nlink: </interio/fonts/font.woff2>; rel=preload; as=font\n```\n\nFirefox in WPT - http://www.webpagetest.org/result/151108_N6_e33cecb2a6f1a864da8b37a740e6d8fb/\n\n![waterfall-normal-order](https://cloud.githubusercontent.com/assets/427052/11032582/8bc2d1f2-86d4-11e5-8b0c-bffa126eb85d.png)\n- https://http2.andydavies.me/interio/index-fonts-push-css-js-woff2-reverse-order.html\n\nHeaders for push are set in this order by nginx (reverse to previous test)\n\n```\nlink: </interio/fonts/font.woff2>; rel=preload; as=font\nlink: </interio/js/jquery.opacityrollover.js>; rel=preload; as=script\nlink: </interio/js/jquery.galleriffic.js>; rel=preload; as=script\nlink: </interio/js/jquery-1.6.2.min.js>; rel=preload; as=script\nlink: </interio/css/grid.css>; rel=preload; as=stylesheet\nlink: </interio/css/style.css>; rel=preload; as=stylesheet\nlink: </interio/css/reset.css>; rel=preload; as=stylesheet\n```\n\nFirefox in WPT - http://www.webpagetest.org/result/151108_SR_9b7f89faecf21204a2ccd12a5ef3e8cb/\n\n![waterfall-reverse-order](https://cloud.githubusercontent.com/assets/427052/11032614/beca467a-86d4-11e5-8a71-c9a5b672d1c8.png)\n\nIn each case it appears the resources complete roughly in the opposite order to which they listed in the link headers.\n\nUnfortunately push resources aren't shown in Chrome tests on WPT yet but testing the same pages in Chrome and capturing the netlogs it appears the push promises arrive in the order the links are listed, but then the header and data frames for the later streams are sent first\n\nUsing the same two test URLs:\n- https://http2.andydavies.me/interio/index-fonts-push-css-js-woff2.html \n\nChrome in WPT - http://www.webpagetest.org/result/151109_ZB_afd3e8f99a7902216da790bd1dba63fa/\n\nnet log is attached to the test (http://www.webpagetest.org/getgzip.php?test=151109_ZB_afd3e8f99a7902216da790bd1dba63fa&file=1_netlog.txt),  the streams are associated with the resources are follows\n\n| resource | promised stream id |\n| --- | --- |\n| /interio/css/reset.css | 2 |\n| /interio/css/style.css | 4 |\n| /interio/css/grid.css | 6 |\n| /interio/js/jquery-1.6.2.min.js | 8 |\n| /interio/js/jquery.galleriffic.js | 10 |\n| /interio/js/jquery.opacityrollover.js | 12 |\n| /interio/fonts/font.woff2 | 14 |\n\nChrome then receives the headers for stream 1, then data frames for stream 1, before receiving header frames for streams 14, 12, 10 & 8 then all the data frames for 14, then 12, then 10, then 8 before receiving header frames for 6, 4 & 2, then data frames for 6, 4 & 2 in that order.\n- https://http2.andydavies.me/interio/index-fonts-push-css-js-woff2-reverse-order.html\n\nChrome in WPT - http://www.webpagetest.org/result/151109_R8_aa809c42f177f0558e11effe76629db7/\n\nNet log - http://www.webpagetest.org/getgzip.php?test=151109_R8_aa809c42f177f0558e11effe76629db7&file=1_netlog.txt\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/584/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "fleonis": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1128", "title": "relocatable binary package", "body": "[cmake](https://github.com/h2o/h2o/blob/9389f21e937fafd785a92207c200b94134cfdc44/CMakeLists.txt#L168) compiles h2o with -DH2O_ROOT=\"${CMAKE_INSTALL_DIR}\". if cpack will be used for create package, this package cannot be install to directory different from ${CMAKE_INSTALL_DIR}.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1128/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/574", "title": "reconfigure libh2o", "body": "hello!\ni'm searching for a way to reconfigure the running server. for example clear all handler registered to a host, or destroy a host, without a changing in other hosts. is it possible using libh2o api?\n\nor i need a way to correctly destroy all for create it again. which api can be used for this?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/574/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "shreenidhihegde": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1125", "title": "Low perf with single connection ", "body": "Hi,\r\n\r\nI am using h20 library as HTTP Server for my application. \r\n\r\nI am running on low performance when I use 1 connection and 1 thread in wrk tool. Even when tried manually the consecutive third request's response is not received until another application (using consul health check request) spawns a new request and writes into socket.\r\n  \r\n\r\n/home/shegde/wrk -t1  -c1 -d30s -s ./post.lua https://localhost:40134/<application url>\r\nRunning 30s test @ https://localhost:40134/<application url>\r\n  1 threads and 1 connections\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   495.43ms  410.26ms   1.02s    33.33%\r\n    Req/Sec     2.15      2.65    10.00     90.91%\r\n  61 requests in 30.03s, 14.24KB read\r\nRequests/sec:      2.03\r\nTransfer/sec:     485.42B\r\n\r\n\r\nI have keep-alive option enabled and using TCP_NODELAY option. I am getting better performance when number of connections increase. I want to get better perf lower connection.\r\n\r\nAlso, My h2o version is older (around an year), when I tried upgrading h2o to latest I ended up with compilation error as my openssl version is OpenSSL 1.0.1e-fips 11 Feb 2013.\r\n\r\nAppreciate your help on this.\r\n\r\nThanks,\r\nShreenidhi", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1125/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "dch": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1124", "title": "native syslog support", "body": "Either /dev/log or syslog over TCP (or UDP) would be super useful. Re-reading and processing the logfiles via rsyslog again is a little silly when h2o could send them directly.", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1124/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "COLLABORATOR"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "sebdeckers": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1115", "title": " PUSH_PROMISE and http2-max-concurrent-requests-per-connection", "body": "Pushed responses in H2O seems to be limited by [`http2-max-concurrent-requests-per-connection`](https://h2o.examp1e.net/configure/http2_directives.html#http2-max-concurrent-requests-per-connection).\r\n\r\n1. Why is the total number of promises capped? It seems like the setting should limit concurrent requests, not the total number of requests. I would expect the pushed promise to simply stagger (max. `N` at a time) until they are all completed.\r\n\r\n    In that case it would be important to send all `HTTP2_SESSION_RECV_PUSH_PROMISE` (but I believe not necessarily the `HTTP2_STREAM_ADOPTED_PUSH_STREAM`) **before** sending the main request's headers and data (e.g. `/`). Otherwise the browser would begin parsing the HTML and make redundant requests for resources that the server has planned, but not yet been able, to push.\r\n\r\n1. The [HTTP/2 Directives documentation](https://h2o.examp1e.net/configure/http2_directives.html#http2-max-concurrent-requests-per-connection) says:\r\n\r\n    > The value cannot exceed 256.\r\n\r\n    However larger values seem to work just fine. Is there a risk with >256? It seems unwise to open this many file handles for a single client, for example. There should not be a problem sending this many PUSH_PROMISE frames, however. (In my tests Firefox chokes at about 8k promises and Chrome rejects anything over 1k. That was a few months ago so YMMV.)\r\n\r\n1. As [explained](https://github.com/h2o/h2o/issues/563#issuecomment-149380569) the `http2-max-concurrent-requests-per-connection ` setting is different from the hardcoded `SETTINGS_MAX_CONCURRENT_STREAMS` setting. However, is there a link between the two when it comes to PUSH_PROMISE?\r\n\r\n    Note: https://tools.ietf.org/html/rfc7540#section-8.2.2\r\n\r\n    >   A client can use the SETTINGS_MAX_CONCURRENT_STREAMS setting to limit\r\n   the number of responses that can be concurrently pushed by a server.\r\n   Advertising a SETTINGS_MAX_CONCURRENT_STREAMS value of zero disables\r\n   server push by preventing the server from creating the necessary\r\n   streams.  This does not prohibit a server from sending PUSH_PROMISE\r\n   frames; clients need to reset any promised streams that are not\r\n   wanted.\r\n\r\n\r\n### Experiment\r\n\r\nHere are examples with the setting at 10, 100, 256, and 10 million. Total of 1 main reponse and 347 files being pushed (see [`fallback.rb`](https://gist.githubusercontent.com/cbas/4389d0e9d53c104af303976eaeee04b4/raw/e90613a3a1db7c23d225bd0d18afb81eaede9e25/fallback.rb) in the Gist). Using [chrome-http2-log-parser](https://github.com/rmurphey/chrome-http2-log-parser) to visualise.\r\n\r\n- [http2-max-concurrent-requests-per-connection: 10](https://cdn.rawgit.com/cbas/4389d0e9d53c104af303976eaeee04b4/raw/354a193caeb4742db86fd3852213b4fb9ab88d21/10.html)\r\n- [http2-max-concurrent-requests-per-connection: 100](https://cdn.rawgit.com/cbas/4389d0e9d53c104af303976eaeee04b4/raw/e90613a3a1db7c23d225bd0d18afb81eaede9e25/100.html)\r\n- [http2-max-concurrent-requests-per-connection: 256](https://cdn.rawgit.com/cbas/4389d0e9d53c104af303976eaeee04b4/raw/e90613a3a1db7c23d225bd0d18afb81eaede9e25/256.html)\r\n- [http2-max-concurrent-requests-per-connection: 10000000](https://cdn.rawgit.com/cbas/4389d0e9d53c104af303976eaeee04b4/raw/e90613a3a1db7c23d225bd0d18afb81eaede9e25/10000000.html)\r\n\r\n### Data\r\n\r\n<https://gist.github.com/cbas/4389d0e9d53c104af303976eaeee04b4>\r\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1115/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/1114", "title": "file.index", "body": "I tried disabling `file.index` and noticed some unexpected behaviour. Not sure if these are bugs. Is there a better way to disable `file.index`?\r\n\r\n#### `configuration/test-file.index.yml`\r\n```yml\r\nhosts:\r\n  \"localhost:80\":\r\n    listen:\r\n      port: 80\r\n\r\n    paths:\r\n\r\n      # Correct/Expected\r\n\r\n      #200 - Hello world\r\n      \"/test_default/\":\r\n        file.dir: public\r\n\r\n      #404 - not found\r\n      \"/test_not_a_real_file/\":\r\n        file.index: ['!']\r\n        file.dir: public\r\n\r\n      # Incorrect/Unexpected\r\n\r\n      #403 - access forbidden\r\n      # Doesn't seem to run handlers on this path at all.\r\n      \"/test_empty_list/\":\r\n        file.index: []\r\n        file.dir: public\r\n\r\n      # Infinite 301 redirects, keeps appending \"/\" to path.\r\n      # Chrome gives up with ERR_TOO_MANY_REDIRECTS.\r\n      # E.g. http://localhost/test_empty_string///////////////////////////////////////////\r\n      \"/test_illegal_character/\":\r\n        file.index: ['/']\r\n        file.dir: public\r\n      \"/test_empty_string/\":\r\n        file.index: ['']\r\n        file.dir: public\r\n```\r\n#### `public/index.html`\r\n```html\r\nHello world\r\n```\r\n#### CLI\r\n```\r\n$ sudo h2o -c configuration/test-file.index.yml\r\n[INFO] raised RLIMIT_NOFILE to 10240\r\nh2o server (pid:16412) is ready to serve requests\r\n```\r\n#### Version\r\n```\r\n$ h2o -v\r\nh2o version 2.1.0-beta3\r\nOpenSSL: LibreSSL 2.4.3\r\nmruby: YES\r\n```\r\n```\r\n$ brew info h2o\r\nh2o: stable 2.0.4 (bottled), devel 2.1.0-beta3\r\nHTTP server with support for HTTP/1.x and HTTP/2\r\nhttps://github.com/h2o/h2o/\r\n/usr/local/Cellar/h2o/2.1.0-beta3 (110 files, 4.6M) *\r\n  Built from source on 2016-10-31 at 10:56:31 with: --with-libressl --without-openssl@1.1\r\nFrom: https://github.com/Homebrew/homebrew-core/blob/master/Formula/h2o.rb\r\n==> Dependencies\r\nBuild: cmake \u2714, pkg-config \u2714\r\nRecommended: openssl \u2714\r\nOptional: libressl \u2714, libuv \u2718, wslay \u2718\r\n```\r\n```\r\n$ sw_vers\r\nProductName:\tMac OS X\r\nProductVersion:\t10.12.1\r\nBuildVersion:\t16B2555\r\n```", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1114/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "mrhein": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1091", "title": "poor https performance", "body": "## Is there a way to improve https performance maybe by config?\n### http 56k vs https 4k\n### version\n\n```\n\u22ca> ~ h2o -v\nh2o version 2.1.0-DEV\nOpenSSL: LibreSSL 2.2.7\nmruby: YES\n```\n### config\n\n```\ncompress: ON\ncompress: [ gzip, br ]\nfile.etag: ON\nfile.send-compressed: ON\nexpires: 1 day\nssl-session-resumption:\n    mode: all\n\nhosts:\n  \"test.tld:3080\":\n    listen:\n      port: 3080\n    paths:\n      \"/\":\n        file.dir: test.tld\n      \"/stats\":\n        status: ON\n      \"/hello\":\n        mruby.handler: |\n          Proc.new do |env|\n            [200, {'content-type' => 'text/plain'}, [\"Hello world\\n\"]]\n          end\n  \"test.tld:3443\":\n      http2-push-preload: ON\n      listen:\n        port: 3443\n        ssl:\n          cipher-preference: server\n          cipher-suite: ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA\n          minimum-version: TLSv1.2\n          certificate-file: ./fullchain.pem\n          key-file: ./privkey.pem\n      paths:\n        \"/\":\n          file.dir: test.tld\n\n```\n### filedirectory\n\n```\n\u22ca> ~ ls -ahl test.tld/\ntotal 72\ndrwxr-xr-x    7 mathias  staff   238B Sep 29 11:00 .\ndrwxr-xr-x+ 269 mathias  staff   8.9K Sep 28 21:29 ..\ndrwxr-xr-x   13 mathias  staff   442B Sep 28 21:33 .git\n-rw-r--r--    1 mathias  staff    12B Sep 22 12:34 README.md\n-rw-r--r--    1 mathias  staff    14K Sep 22 12:34 index.html\n-rw-------    1 mathias  staff   4.7K Sep 28 21:33 index.html.br\n-rw-r--r--    1 mathias  staff   5.6K Sep 22 12:34 index.html.gz\n```\n### http\n\n```\n\u22ca> ~ wrk -s ~/pipeline.lua -t 1 -c 400 -d 10 http://test.tld:3080/ -- 80\nRunning 10s test @ http://test.tld:3080/\n  1 threads and 400 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    15.97ms    5.50ms  92.91ms   70.20%\n    Req/Sec    56.62k     2.97k   63.78k    78.00%\n  565485 requests in 10.10s, 7.88GB read\nRequests/sec:  56012.77\nTransfer/sec:    799.35MB\n```\n### https\n\n```\n\u22ca> ~ wrk -s ~/pipeline.lua -t 1 -c 400 -d 10 https://test.tld:3443/ -- 80\nRunning 10s test @ https://test.tld:3443/\n  1 threads and 400 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   227.93ms  287.00ms   1.76s    89.39%\n    Req/Sec     7.27k     2.07k   12.49k    64.41%\n  43772 requests in 10.02s, 624.66MB read\n  Socket errors: connect 0, read 0, write 0, timeout 62\nRequests/sec:   4369.12\nTransfer/sec:     62.35MB\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1091/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "dpk": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1082", "title": "\u2018graceful\u2019/zero-downtime restart", "body": "On the server webpage it is claimed that h2o can perform a \u2018graceful\u2019 restart (presumably meaning that no downtime is involved). How is this possible? What exactly is reloaded (ssl certs? fastcgi processes)? I can't find anything in the docs about this.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1082/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/971", "title": "Support for X-Sendfile header or similar mechanism", "body": "I know from issue #671 that h2o can't use the `sendfile` call in HTTP/2.0 but it would be nice when proxying or using FastCGI to be able to get the server to do the work of sending files \u2026 not least because it can probably do it a lot better than my Ruby/Python app code can.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/971/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "Sp1l": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1078", "title": "Detect (and use) installed LibreSSL", "body": "1. Various operating systems (e.g. HardenedBSD, TrueOS/PC-BSD, VOID Linux) use LibreSSL (stable) as provider of libcrypto/libssl in the base system.\n2. Various operating systems allow setting the default libcrypto/libssl provider to LibreSSL (e.g. FreeBSD, DragonflyBSD)\n\nIt would be great if the build framework detects an installed LibreSSL (existence of `libtls.so` and/or defined `LIBRESSL_VERSION_NUMBER` in opensslv.h) and use that in stead of the bundled LibreSSL.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1078/reactions", "total_count": 4, "+1": 4, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "nextgenthemes": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1056", "title": "Headers not seem to work correctly when adding on host or path.", "body": "``` yaml\nhosts:\n\n# advancedembeds.com hosts php on HTTP and HTTPS\n  \"www.advancedembeds.com\":\n    listen:\n      port: 80\n    listen:\n      port: 443\n      ssl: &default_ssl\n        cipher-suite: ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS\n        certificate-file: /etc/letsencrypt/live/advancedembeds.com/fullchain.pem\n        key-file:         /etc/letsencrypt/live/advancedembeds.com/privkey.pem\n    paths: &advancedembeds_com_redirect_path\n      \"/\":\n        redirect: http://advancedembeds.com/\n  \"advancedembeds.com\":\n    listen:\n      port: 80\n    listen:\n      port: 443\n      ssl: *default_ssl\n    paths:\n      \"/\":\n        header.unset: \"Content-Security-Policy\" # remove https specific header\n        file.dir: /www/advancedembeds.com/php # serve static files if found\n        redirect: &php_redirect                  # if not found, internally redirect to /index.php/<path>\n          url: /index.php/ # wordpress will have this in the permalink structure by default after install, you probably want to remove this in the wordpress config\n          internal: YES\n          status: 307\n\n# nextgenthemes.com\n  \"www.nextgenthemes.com\":\n    listen:\n      port: 80\n    listen:\n      port: 443\n      ssl: &nextgenthemes_com_ssl\n        <<: *default_ssl\n        certificate-file: /etc/letsencrypt/live/nextgenthemes.com-0001/fullchain.pem\n        key-file:         /etc/letsencrypt/live/nextgenthemes.com-0001/privkey.pem\n    paths: &nextgenthemes_redirect_path\n      \"/\":\n        redirect: https://nextgenthemes.com/\n  \"nextgenthemes.com:80\":\n    listen:\n      port: 80\n    paths: *nextgenthemes_redirect_path\n  \"nextgenthemes.com:443\":\n    header.set: \"Strict-Transport-Security: max-age=31536000; includeSubDomains; preload\"\n    listen:\n      port: 443\n      ssl: *nextgenthemes_com_ssl\n    paths:\n      \"/wp-content/uploads/edd/\":\n        redirect: https://nextgenthemes.com/\n      \"/\":\n        header.set: \"Strict-Transport-Security: max-age=31536000; includeSubDomains; preload\"\n        file.dir: /www/nextgenthemes.com/php\n        redirect: *php_redirect\n\n# demo.nextgenthemes.com\n  \"demo.nextgenthemes.com:80\":\n    listen:\n      port: 80\n    paths:\n      \"/\":\n        redirect: https://demo.nextgenthemes.com/\n  \"demo.nextgenthemes.com:443\":\n    listen:\n      port: 443\n      ssl:\n        <<: *default_ssl\n        certificate-file: /etc/letsencrypt/live/demo.nextgenthemes.com/fullchain.pem\n        key-file:         /etc/letsencrypt/live/demo.nextgenthemes.com/privkey.pem\n    paths:\n      \"/\":\n        header.set: \"Strict-Transport-Security: max-age=31536000; includeSubDomains; preload\"\n        file.dir: /www/demo.nextgenthemes.com/php\n        redirect: *php_redirect\n\n# community.nextgenthemes.com\n  \"community.nextgenthemes.com:80\":\n    listen:\n      port: 80\n    paths:\n      \"/\":\n        redirect: https://community.nextgenthemes.com/\n  \"community.nextgenthemes.com:443\":\n    header.set: \"Strict-Transport-Security: max-age=31536000; includeSubDomains; preload\"\n    listen:\n      port: 443\n      ssl:\n        <<: *default_ssl\n        certificate-file: /etc/letsencrypt/live/community.nextgenthemes.com/fullchain.pem\n        key-file:         /etc/letsencrypt/live/community.nextgenthemes.com/privkey.pem\n    paths:\n      \"/\":\n        file.dir: /www/community.nextgenthemes.com/php\n        redirect: *php_redirect\n\n# nico.onl\n  \"www.nico.onl\":\n    listen:\n      port: 80\n    listen:\n      port: 443\n      ssl: &nico_onl_ssl\n        <<: *default_ssl\n        certificate-file: /etc/letsencrypt/live/nico.onl-0001/fullchain.pem\n        key-file:         /etc/letsencrypt/live/nico.onl-0001/privkey.pem\n    paths: &nico_onl_redirect_path\n      \"/\":\n        redirect: https://nico.onl/\n  \"nico.onl:80\":\n    listen:\n      port: 80\n    paths: *nico_onl_redirect_path\n  \"nico.onl:443\":\n    listen:\n      port: 443\n      ssl: *nico_onl_ssl\n    paths:\n      \"/\":\n        header.set: \"Strict-Transport-Security: max-age=31536000; includeSubDomains; preload\"\n        file.dir: /www/nico.onl/php # serve static files if found\n        redirect: *php_redirect\n\n# nicolasjonas.com (Static, no PHP)\n  \"www.nicolasjonas.com\":\n    listen:\n      port: 80\n    listen:\n      port: 443\n      ssl: &nicolasjonas_com_ssl\n        <<: *default_ssl\n        certificate-file: /etc/letsencrypt/live/nicolasjonas.com-0001/fullchain.pem\n        key-file:         /etc/letsencrypt/live/nicolasjonas.com-0001/privkey.pem\n    paths: &nicolasjonas_com_redirect_path\n      \"/\":\n        redirect: https://nicolasjonas.com/\n  \"nicolasjonas.com:80\":\n    listen:\n      port: 80\n    paths: *nicolasjonas_com_redirect_path\n  \"nicolasjonas.com:443\":\n    listen:\n      port: 443\n      ssl: *nicolasjonas_com_ssl\n    paths:\n      \"/\":\n        header.set: \"Strict-Transport-Security: max-age=31536000; includeSubDomains; preload\"\n        file.dir: /www/nicolasjonas.com/php\n\n# Global settings\nuser: www-data # default username for webservers on ubuntu/debian... this was a essential thing I needed, found out by trail and error\nfile.index: [ 'index.php', 'index.html' ] # globally set h2o to look for php files first\naccess-log: /var/log/h2o/access.log       # you need to create this folder first (common ubuntu/... folder)\nerror-log: /var/log/h2o/error.log  \npid-file: /var/run/h2o.pid                # (common ubuntu/... folder)\nhttp2-reprioritize-blocking-assets: ON    # performance tuning option\n\n#header.set: \"Content-Security-Policy: default-src https:\" # This is recommenced but ...\nheader.set: \"Content-Security-Policy: default-src https: 'unsafe-eval' 'unsafe-inline'\" # Needed for iframe embeds, edd and svg was not loaded correctly.\n# header.set: \"Strict-Transport-Security: max-age=31536000; includeSubDomains; preload\"  # https://hstspreload.appspot.com says this header should not be send over HTTP so it is set in individial hosts to be served with HTTPS only.\nheader.set: \"X-Content-Type-Options: nosniff\"\nheader.set: \"x-frame-options: deny\"\nheader.set: \"X-XSS-Protection: 1; mode=block\"\nfile.custom-handler:\n  extension: .php\n  fastcgi.connect:\n    port: /var/run/php/php7.0-fpm.sock\n    type: unix\n```\n\nAs you can see in my config I am trying to add the HSTS `Strict-Transport-Security: max-age=31536000; includeSubDomains; preload` header only to the page when its served over HTTPS because https://hstspreload.appspot.com says this header should not be send over HTTP. As you can see I tried on the host and on the path level. This does not seem to work correctly. https://observatory.mozilla.org/analyze.html?host=nextgenthemes.com I tested it there and also looked at the headers in the browser debug. It seems that the initial HTTP document misses that header but the assets get it correctly. When I added it on a global it worked fine.\n\nThe same happens when I try to `header.unset: \"Content-Security-Policy\" # remove https specific header` on this one host. I have it set globally but I have only one site that I want to serve HTTP so I like to set this header globally and then remove it for this one host. Seems to be the same problem as for the HSTS header. The initial HTML document still has the header but its only removed on the assets.\n\nA little off topic but I like to discus and share my config because it took me quite some time to get there. I like to share a config like this in the wiki because it may help others.\n- The wiki example mentions WordPress but shows a config with fastcgi php. As far as I know php-fpm is faster and more modern and should be the way to go?\n- I needed to add the `user: www-data` because otherwise I could not even get h2o to run, and this was not mentioned in the wiki configs or somewhere around here I think think should be mentioned prominently somewhere and/or added to the example configs. Setting the user may be a good ideo for all linux systems or not? For debian bases its www-data.\n- I used yaml aliases and merge but its still feels like a lot of config. Especially the redirect parts from www. to no www and to https at the same time gets repeated a lot. Can this done in a simpler way? Either way I think a config for that would bring value to the wiki.\n- In general is there something that could be improved in my config? My next steps is to trying to improve TLS config for better security. So far I just added the cyphers.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1056/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/604", "title": "How to write rewrite rules?", "body": "Is it possible to have h2o rewrite rules like this?\n\n```\nRewriteEngine On\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\n\n# add a trailing slash to /wp-admin\nRewriteRule ^([_0-9a-zA-Z-]+/)?wp-admin$ $1wp-admin/ [R=301,L]\n\nRewriteCond %{REQUEST_FILENAME} -f [OR]\nRewriteCond %{REQUEST_FILENAME} -d\nRewriteRule ^ - [L]\nRewriteRule ^([_0-9a-zA-Z-]+/)?(wp-(content|admin|includes).*) $2 [L]\nRewriteRule ^([_0-9a-zA-Z-]+/)?(.*\\.php)$ $2 [L]\nRewriteRule . index.php [L]\n```\n\n(Wordpress Multisite subdirectory .htaccess)\n\nAm I right to assume that this can/should be done with a mruby handler?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/604/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "jameshadley": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1045", "title": "unknown command: http2-latency-optimization-min-rt", "body": "My config file is..\n\n```\nuser: nobody\n\nhttp2-reprioritize-blocking-assets: ON\nhttp2-casper: ON\n\nssl-session-resumption:\n    mode: all\n\n\naccess-log: /var/log/h2o.access.log \nerror-log: /var/log/h2o.error.log \npid-file: /var/log/h2o.pid\n\nhosts:\n  domain.com:80:\n    listen:\n      port: 80\n    paths:\n      /:\n        proxy.reverse.url: http://domain.com:8001\n        proxy.preserve-host: \"ON\"\n  domain.com:443:\n    listen:\n      port: 443\n      ssl:\n        key-file: /etc/ssl/domain.com.key\n        certificate-file: /etc/ssl/domain.com.cert\n    paths:\n      /:\n        proxy.reverse.url: https://domain.com:8000\n        proxy.preserve-host: \"ON\"\n        proxy.ssl.verify-peer: \"OFF\"\n```\n\nI tried adding `http2-latency-optimization-min-rt: 10` just before `http2-casper` but I get this error:\n\n```\nunknown command: http2-latency-optimization-min-rt\n```\n\nI am using a CentOS 7 x64 KVM VPS and believe I have access to the required option..\n\n```\n[root@li66-140 h2o]# cat /proc/sys/net/ipv4/tcp_notsent_lowat\n-1\n```\n\nI built H2O using the Docker image.\n\nI would appreciate if someone could let me know if this is a bug or a brainfart :)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1045/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "mozumder": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1023", "title": "Add WSGI support", "body": "Hi, I'd like to run h2o for our Python/Django apps, for the HTTP2 server push capabilities.\n\nWould it be possible to add WSGI support to enable usage of Python & Django?  \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1023/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "pynej": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1015", "title": "Proxy link translating", "body": "Is there a feature akin to this: http://nginx.org/en/docs/http/ngx_http_sub_module.html\n\nI see the documentation for this feature https://h2o.examp1e.net/configure/mruby.html witch seams like it would so what I need but I don't know the language or how to get the content.  Also I'm not sure who the performance would be.\n\nIn short we are proxying content through with this:\n\n```\nuser: www\npid-file: /var/run/h2o.pid\naccess-log: /var/log/h2o/h2o-access.log\nerror-log: /var/log/h2o/h2o-error.log\n\n# per-host configuration\nhosts:\n    www.inkonit.com:\n        listen: 80\n        listen:\n            port: 443\n            ssl:\n                minimum-version: TLSv1.2\n                certificate-file: /usr/local/etc/ssl/www.inkonit.com.crt\n                key-file: /usr/local/etc/ssl/www.inkonit.com.key\n        paths:\n            \"/\":\n                proxy.reverse.url: http://localhost:8088\n                proxy.preserve-host: ON\n```\n\nBut the end site generates full URL's for resources.  Ie a script is included as `http://www.inkonit.com/scripts/test.js` not `/scripts/test.js`.  I can't fix this in all the systems to be relative as I'd like due to the CMS system limitations, so I want to rewrite them so that serving the SSL pages doesn't load non-SSL links.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1015/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "meiry": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1014", "title": "does the server support latest websockets + binary sending ? does it compiles on windows ?", "body": "Hello \nim looking for fast web-socket only server , and found this one . \nhow can i start check the web-socket support ? \nalso does it compiles on windows ? \nThanks\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1014/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "muthukumarclay": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1009", "title": "H2O library Documentaion", "body": "I am looking for the API documentation for H2O library. Please help. \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1009/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "ghost": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1004", "title": "Cannot specify link libraries for target \"t-00unit-libuv.t\" which is not   built by this project.", "body": "Can no longer build h2o on ubuntu 14.04 like I did before without problems. current version https://github.com/h2o/h2o/commit/c676c4dfda8c97367ad44873f2d359199d882a33 gives me this.\n\n```\ncmake -DWITH_BUNDLED_SSL=on .\n-- The C compiler identification is GNU 4.8.4\n-- The CXX compiler identification is GNU 4.8.4\n-- Check for working C compiler: /usr/bin/cc\n-- Check for working C compiler: /usr/bin/cc -- works\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Check for working CXX compiler: /usr/bin/c++\n-- Check for working CXX compiler: /usr/bin/c++ -- works\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- Could NOT find PkgConfig (missing:  PKG_CONFIG_EXECUTABLE) \n-- Looking for include file pthread.h\n-- Looking for include file pthread.h - found\n-- Looking for pthread_create\n-- Looking for pthread_create - not found\n-- Looking for pthread_create in pthreads\n-- Looking for pthread_create in pthreads - not found\n-- Looking for pthread_create in pthread\n-- Looking for pthread_create in pthread - found\n-- Found Threads: TRUE  \n-- Found OpenSSL: /usr/lib/x86_64-linux-gnu/libssl.so;/usr/lib/x86_64-linux-gnu/libcrypto.so (found version \"1.0.2h\") \n-- Found ZLIB: /usr/lib/x86_64-linux-gnu/libz.so (found version \"1.2.8\") \n-- Could NOT find LIBUV (missing:  LIBUV_LIBRARIES LIBUV_INCLUDE_DIR) \n-- Could NOT find WSLAY (missing:  WSLAY_LIBRARIES WSLAY_INCLUDE_DIR) \nCMake Error at CMakeLists.txt:519 (TARGET_LINK_LIBRARIES):\n  Cannot specify link libraries for target \"t-00unit-libuv.t\" which is not\n  built by this project.\n\n\n-- Configuring incomplete, errors occurred!\nSee also \"/root/build/h2o/CMakeFiles/CMakeOutput.log\".\nSee also \"/root/build/h2o/CMakeFiles/CMakeError.log\".\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1004/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/678", "title": "H2O mod_rewrite support", "body": "Is there any chance to support original .htaccess mod_rewrite?\n\nI would like to battle test H2O on shared webhosting environment,\nbut almost all users use RewriteEngine.\n\nThanks in advance!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/678/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "jeroen": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/1003", "title": "Pedantic compiler warnings", "body": "Trying to package up `libh2o` but compiling with `-Wall -pedandtic` gives a lot of warnings, mostly about GNU extensions. Is this expected? We need ISO C99 code.\n\nBuild log: http://pastebin.com/raw/XJQgTYdD\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/1003/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "janit": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/994", "title": "Remove proxy header by default due to httpoxy vulnerability", "body": "The httpoxy vulnerability can be exploited by sending HTTP a \"proxy: foobar\" header that will be translated to server parameters has been uncovered. Details: https://httpoxy.org\n\nShould h2o strip the proxy header in default configurations to mitigate the issue? What is the recommended method for achieving protection against this vulnerability?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/994/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/11798164", "body": "fastcgi.connect: /tmp/fcgi.sock does not work for me. Maybe a configuration format change?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/11798164/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "review_comments": []}, "NightDevel": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/992", "title": "BoringSSL API changes break compilation w/ h2o", "body": "#228\n\nBoringSSL removes several functions that make it impossible to utilize the library without some porting.\n\nI found this reference guide that may shed some light: https://boringssl.googlesource.com/boringssl/+/65703b45c47bb71cfcb972edea00d82218cb0f9d/PORTING.md\n\n`\n[ 59%] Linking CXX executable h2o\nCMakeFiles/h2o.dir/lib/common/socket.c.o: In function`h2o_socket_get_ssl_session_reused':\n/tmp/build/h2o/lib/common/socket.c:669: undefined reference to `SSL_ctrl'\nCMakeFiles/h2o.dir/lib/common/socket.c.o: In function`h2o_socket_ssl_handshake':\n/tmp/build/h2o/lib/common/socket.c:963: undefined reference to `SSL_ctrl'\nCMakeFiles/h2o.dir/lib/handler/proxy.c.o: In function`h2o_proxy_register_reverse_proxy':\n/tmp/build/h2o/lib/handler/proxy.c:159: undefined reference to `CRYPTO_add_lock'\nCMakeFiles/h2o.dir/lib/handler/configurator/proxy.c.o: In function`create_ssl_ctx':\n/tmp/build/h2o/lib/handler/configurator/proxy.c:78: undefined reference to `SSL_CTX_ctrl'\n/tmp/build/h2o/lib/handler/configurator/proxy.c:78: undefined reference to`SSL_CTX_ctrl'\nCMakeFiles/h2o.dir/lib/handler/configurator/proxy.c.o: In function `on_config_enter':\n/tmp/build/h2o/lib/handler/configurator/proxy.c:176: undefined reference to`CRYPTO_add_lock'\nCMakeFiles/h2o.dir/lib/handler/configurator/proxy.c.o: In function `update_ssl_ctx':\n/tmp/build/h2o/lib/handler/configurator/proxy.c:89: undefined reference to`CRYPTO_add_lock'\nCMakeFiles/h2o.dir/deps/neverbleed/neverbleed.c.o: In function `load_key_stub':\n/tmp/build/h2o/deps/neverbleed/neverbleed.c:625: undefined reference to`CRYPTO_free'\n/tmp/build/h2o/deps/neverbleed/neverbleed.c:627: undefined reference to `CRYPTO_free'\nCMakeFiles/h2o.dir/deps/neverbleed/neverbleed.c.o: In function`neverbleed_init':\n/tmp/build/h2o/deps/neverbleed/neverbleed.c:845: undefined reference to `RSA_PKCS1_SSLeay'\n/tmp/build/h2o/deps/neverbleed/neverbleed.c:902: undefined reference to`ENGINE_set_id'\n/tmp/build/h2o/deps/neverbleed/neverbleed.c:903: undefined reference to `ENGINE_set_name'\n/tmp/build/h2o/deps/neverbleed/neverbleed.c:903: undefined reference to`ENGINE_set_RSA'\n/tmp/build/h2o/deps/neverbleed/neverbleed.c:907: undefined reference to `ENGINE_add'\nCMakeFiles/h2o.dir/src/main.c.o: In function`on_ocsp_stapling_callback':\n/tmp/build/h2o/src/main.c:345: undefined reference to `CRYPTO_malloc'\n/tmp/build/h2o/src/main.c:354: undefined reference to`SSL_ctrl'\nCMakeFiles/h2o.dir/src/main.c.o: In function `listener_setup_ssl':\n/tmp/build/h2o/src/main.c:516: undefined reference to`SSL_CTX_ctrl'\nCMakeFiles/h2o.dir/src/main.c.o: In function `setup_ecc_key':\n/tmp/build/h2o/src/main.c:185: undefined reference to`SSL_CTX_ctrl'\nCMakeFiles/h2o.dir/src/main.c.o: In function `listener_setup_ssl':\n/tmp/build/h2o/src/main.c:574: undefined reference to`SSL_CTX_ctrl'\n/tmp/build/h2o/src/main.c:575: undefined reference to `SSL_CTX_ctrl'\n/tmp/build/h2o/src/main.c:607: undefined reference to`SSL_CTX_callback_ctrl'\n/tmp/build/h2o/src/main.c:608: undefined reference to `SSL_CTX_ctrl'\n/tmp/build/h2o/src/main.c:589: undefined reference to`SSL_CTX_callback_ctrl'\n/tmp/build/h2o/src/main.c:590: undefined reference to `SSL_CTX_ctrl'\nCMakeFiles/h2o.dir/src/ssl.c.o: In function`setup_cache_disable':\n/tmp/build/h2o/src/ssl.c:107: undefined reference to `SSL_CTX_ctrl'\nCMakeFiles/h2o.dir/src/ssl.c.o: In function`setup_cache_memcached':\n/tmp/build/h2o/src/ssl.c:128: undefined reference to `SSL_CTX_ctrl'\nCMakeFiles/h2o.dir/src/ssl.c.o: In function`setup_cache_internal':\n/tmp/build/h2o/src/ssl.c:114: undefined reference to `SSL_CTX_ctrl'\nCMakeFiles/h2o.dir/src/ssl.c.o: In function`serialize_ticket_entry':\n/tmp/build/h2o/src/ssl.c:324: undefined reference to `EVP_CIPHER_type'\nCMakeFiles/h2o.dir/src/ssl.c.o: In function`ssl_setup_session_resumption':\n/tmp/build/h2o/src/ssl.c:868: undefined reference to `SSL_CTX_callback_ctrl'\n/tmp/build/h2o/src/ssl.c:872: undefined reference to`SSL_CTX_ctrl'\n/tmp/build/h2o/src/ssl.c:872: undefined reference to `SSL_CTX_ctrl'\nCMakeFiles/h2o.dir/src/ssl.c.o: In function`init_openssl':\n/tmp/build/h2o/src/ssl.c:918: undefined reference to `OPENSSL_add_all_algorithms_noconf'\ncollect2: error: ld returned 1 exit status\nCMakeFiles/h2o.dir/build.make:2619: recipe for target 'h2o' failed\nmake[2]: *** [h2o] Error 1\nCMakeFiles/Makefile2:467: recipe for target 'CMakeFiles/h2o.dir/all' failed\nmake[1]: *** [CMakeFiles/h2o.dir/all] Error 2\nMakefile:127: recipe for target 'all' failed\nmake: *** [all] Error 2\n`\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/992/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/964", "title": "Caching mechanism for reverse proxy?", "body": "Hello, the h2o webserver is functioning great in my environment, but I couldn't find any systems for caching nor ratelimiting.\n\nPerhaps I missing something or are these functions not built in as of yet?\n\nAnother concern - I would like to reverse proxy several different systems on other ports, but the built-in load balancing doesn't seem to have support for this either.\n\n(i.e. server1.local:80, server2.local:909)\n\nThanks!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/964/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/1001", "title": "Add support for User-Agent blocking without using mruby", "body": "Example configuration\n\n`num-threads: 8\nhosts:\n  \"h2o\":\n    blocked-agents:\n      - wordpress\n      - curl\n    listen:\n      port: 443`\n\nWe use h2o as a SSL terminator and have frequently seen massive GET floods from insecure wordpress instances.  Currently it only works for http1.\n\nEdit:  I had added the latest LibreSSL for our purposes - just letting you know.\n", "author_association": "NONE"}], "issue_comments": [], "commit_comments": [], "review_comments": []}, "Meai1": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/984", "title": "How do I set up libh2o with http2?", "body": "Hi, I would like to embed the libh2o webserver in another language but I want to use http2.\n\nI have tried setting #define USE_HTTPS 1 and #define H2O_USE_ALPN 1 but I get  \"undefined reference: h2o_ssl_register_alpn_protocols\"\nThe server starts if I use \"#define H2O_USE_NPN 1\" but when I try it in the browser I first have to add a firefox security exception due to the wrong ssl certificate (this is okay so far, i can make a valid one later i assume) but then even with the added exception I get no response.\nOn Chrome after adding the exception I do get a response but I dont think that it's HTTP2. I looked it up and browsers dont support NPN anymore.\nOk so I figured out that I apparently need a higher version of openssl. But I dont get it, first of all why isnt the bundled libressl working? Isnt the whole point of bundling it so that it works out of the box? And even after ugprading my openssl im still getting different undefined reference errors: SSL_get0_alpn_selected\nSo now I'm clueless what ssl libary should be used to make this work.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/984/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "valour01": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/965", "title": "hpack headers check", "body": "Will h2o store all the headers (key/value) that is not in the static table into the dynamic table? I mean does h2o do any check on the request headers. Sometimes, clients might send rubbish headers, is there any way to handle this, or h2o will encode it and store it into the dynamic table? Many thanks\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/965/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/545", "title": "Order of the received dataframes", "body": "I did some test on the feature of priority related to http/2. And I found that when I build a dependency tree with A as the parent of B, C & D.  I cannot receive B,C,D's dataframe until A (A is a very big file)is finished. This is reasonable. \nBut when I control the size of the frame (for example, set the maximum as 10), A might be the last one to be finished. I am eager to know the mechanism why this comes. I thought there is a queue to keep the  order of the responses. \nCould you please help me to locate the detailed code. I spend some time on finding it, but I failed at last. Many Thanks.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/545/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/521", "title": "Server push times", "body": "Hi.\nI tried the server push of h2o. An interesting thing is that even if my index.html contains 5 png with the same src. And I set the server to push this. I can only get the push_promise once. Do you know why? And could you please locate the related code for me. Thanks a lot\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/521/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/518", "title": "Padding of http2", "body": "Does h2o implement padding? If so, what frames can use padding? Could you please tell me which file realize them. Thanks a lot.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/518/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/504", "title": "Dependency tree built. ", "body": "I use Jetty 9.3.3 to make HTTP/2 request to h2o trying to change the priority to test the new feature. But it seems h2o didn't work. I want to know is there any methods to see the detail information for the process of dependency tree building, that might helps me to debug.\nThe access.log has no information about priority or dependency. Many Thanks.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/504/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "rajdravid": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/963", "title": "libh2o post body not being sent in reproxy", "body": "@kazuho I am just trying simple.c and allowing post requests to be proxied to a different server.  The post request does make it to my server but the post body that I am sending does not make it.  content-length header is also not being forwarded.\n\nAm I missing something ?  May be I should be using proxy instead of reproxy.  If so how do I configure it ?\n\nThank you !\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/963/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/948", "title": "libh2o output gzip content-encoding", "body": "Is there any way we can enable gzip encoding for content sent via libh2o ?  Can you please provide a sample. \n\nThanks !\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/948/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "gyh007": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/956", "title": "http1client crash?", "body": "hello, i am new to h2o, want to use http client library, i copy master/examples/libh2o/http1client.c, compile with libuv and test, if http connection timeout the test program will exit by line 129, if i remove this line, it will crash, is three any bug? thanks.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/956/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "remoteportal": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/952", "title": "Can I use H2O itself for websocket app development?", "body": "I'm hoping that H2O is the most massively scalable \"C\" language solution for websockets, since it's faster than libuv and has wslay built-in.   (NOT using H2O as proxy.)\n\nI've researched Erlang but am thinking that for my needs that H2O would scale higher since it's so darn optimized and simple.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/952/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "herzoeg": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/949", "title": "Building on Windows", "body": "I'm currently trying to get h2o building on Windows via Visual C++. I have not yet actually gotten to the step of trying to compile. I will update here as I come across things.\n\nSo far:\n1. I am using OpenSSL 1.1.0 (though anything above 1.0.0 seems to share this) -- cmake's FindOpenSSL module looks for the wrong libraries on Windows, and thus even after installing or build/installing OpenSSL correctly, it fails. It is searching for libeay32.lib and ssleay32.lib, when in reality the libraries are libssl.lib and libcrypto.lib. This is an issue with cmake.\n2. The cmake script is involving the dependency of pkg-config, which while an annoyance is not insurmountable. I am going to work on that tomorrow if I get time.\n\nHaving gone through at least a few of the source files, though, I suspect it will take some work to port (I'm also a C++ programmer by trade, so C is a bit different for me). There are includes of headers that do not exist on Windows (for instance, 'sys/uio.h', 'sys/mman.h', pthreads, and many others) which will have to be ported to WinAPI.\n\nGiven that this is meant to be a 'small' library, it has a _lot_ of dependencies, and the main reason I want to use this or something like it is that I simply don't have the time to roll my own HTTP1 and HTTP2 implementations, as it's not trivial.\n\nIf I keep having difficulties with cmake, is it possible to get a list of the source files that h2o is compiling and which library dependencies it actually has when building as a library? I could potentially just generate a vcxproj instead.\n\nAlso, I noticed that you are using brotli - may I ask why? My own tests of brotli have shown it as superior to neither snappy nor zlib.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/949/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "1ma": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/947", "title": "how to configure h2o as a front controller (Silex/Symfony projects)", "body": "I've successfully bootstrapped a Silex codebase using a small variation of the h2o configuration file for Wordpress that is documented [here](https://github.com/h2o/h2o/wiki/FastCGI-%28Wordpress%29) and [elsewhere](https://www.symfony.fi/entry/serving-php-on-http-2-with-h2o-and-hhvm-symfony-wordpress-drupal).\n\nBut there's something that I don't quite like about it: I don't want the flexibility to trigger a FastCGI run for _any_ PHP script, but rather just one or maybe two \"whitelisted\" scripts. I am struggling to achieve that because the `extension` field of the `file.custom-handler` directive is mandatory.\n\nIn essence I'd like some help to translate the minimum, recommended [nginx configuration](http://symfony.com/doc/current/cookbook/configuration/web_server_configuration.html#nginx) for Symfony to an h2o configuration file. An even more succint version could be:\n\n```\nserver {\n    server_name silex.dev;\n    root /var/www/silex.dev/web;\n\n    location / {\n        try_files $uri /index.php$is_args$args;\n    }\n\n    location ~ ^/index\\.php(/|$) {\n        fastcgi_pass app:9000;\n\n        fastcgi_split_path_info ^(.+\\.php)(/.*)$;\n        include fastcgi_params;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        fastcgi_param HTTPS off;\n\n        internal;\n    }\n}\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/947/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "quentusrex": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/943", "title": "libh2o example of blocking http call/request", "body": "After taking the http1client.c example and testing against a few remote and slow systems, it seems that a slow tls setup can cause h2o_evloop_run() calls to return quickly even though the request is still processing. Is there an example of how to perform the equivalent of a blocking request?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/943/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/899", "title": "Full and proper shutdown and cleanup for libh2o with evloop", "body": "Looks like h2o_evloop_destroy() isn't an exported symbol in the 1.7 releases. The examples appear to all comment out the function call, and one even has a fixme noted. What is the proper way to clean up and shutdown when using evloop?\n\nhttps://github.com/h2o/h2o/blob/master/examples/libh2o/socket-client.c\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/899/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/884", "title": "Passing application context data into a timeout entry for use during the callback", "body": "In a follow up to https://github.com/h2o/h2o/issues/807 I'm trying to find a way to pass a (void *) of application specific data pointer so that this can be accessed during the timeout callback. \n\nAnyone have an example of how to accomplish this task? Even it if requires stashing the pointer on the h2o_loop_t, and somehow being able to pull that in the timeout event callback.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/884/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/807", "title": "Example evloop_run with timeout for receiving connections", "body": "Is there an example for using h2o_evloop_run() but specifying a timeout so that it won't block forever?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/807/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "mcddx330": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/934", "title": "Isn't set access-log and error-log on each hosts?", "body": "Hi.\nI using minimal web server on this.\nBut I can't set logfie path on each hosts.\n(only \"access-log\" is work. with \"error-log\" is still not work.)\n\nconf is like:\n\n```\npid-file: /var/log/h2o/pid_file\n#error-log: /dev/stdout\n\nuser  : user\nlisten: 80\nlisten:\n  port: 8443\n  ssl :\n    certificate-file: /etc/h2o/cert.pem\n    key-file: /etc/h2o/cert.key\n\n  \"one.com\":\n    paths:\n      /:\n        file.dir: /hoge/fuga\n        access-log: /var/log/h2o/one/access_log\n        error-log: /var/log/h2o/one/error_log\n\n  \"two.net\":\n    paths:\n      /:\n        file.dir: /foo/bar\n        access-log: /var/log/h2o/two/access_log\n        error-log: /var/log/h2o/two/error_log\n```\n\nAnd error message is:\n\n```\n[/etc/h2o/h2o.conf:xx] in command error-log, the command cannot be used at this level\n```\n\nSo where I fix it? or Only output one error-log file?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/934/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "reqshark": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/931", "title": "TCP proxy", "body": "quick question, maybe this was already answered\n\ncan the proxy handler pass to TCP instead of HTTP?\n\ni.e. can i pass inbound ssh like nc?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/931/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "Xuchenhao": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/928", "title": "Can't open conf file ", "body": "```\nfailed to parse configuration file:/root/h2o/kotori.conf:line 14:did not find expected key\n```\n\n```\n[root@vps284854 ~]# ls /root/h2o\nkotori.conf  kotori.net.crt  kotori.net-key.crt\n[root@vps284854 ~]#\n```\n\n```\nhosts:\n  \"kotori.net:80\":\n    listen:\n\u0000\u0000\u0000\u0000\u0000\u0000port: 80\n    paths:\n\u0000\u0000\u0000\u0000\u0000\u0000\"/\":\n\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000redirect: https://kotori.net/\n  \"kotori.net:443\":\n    listen:\n\u0000\u0000\u0000\u0000\u0000\u0000port: 443\n\u0000\u0000\u0000\u0000\u0000\u0000ssl:\n\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000certificate-file: /root/h2o/kotori.net.crt\n\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000key-file:\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000/root/h2o/kotori.net-key.crt\n   paths:\n\u0000\u0000\u0000\u0000\u0000\u0000\"/\":\n\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000proxy.reverse.url: https://kotori.net/\n\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000# proxy.preserve-host: ON     # to not rewrite the incoming host:port\n\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000# proxy.timeout.keepalive: 0  # to explicitly disable persistent connections to the application server\n\naccess-log: /root/h2o/access-log\nerror-log: /root/h2o/error-log\npid-file: /root/h2o/pid-file\nhttp2-reprioritize-blocking-assets: ON   # performance tuning option\n~\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/928/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "191919": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/914", "title": "Struct member padding issue", "body": "I am new to h2o and just started to read the code. I found that the struct member alignment/padding issue has not been taken account of.\n\nE.g.:\n\n```\ntypedef struct st_h2o_http2_frame_t {\n    uint32_t length;\n    uint8_t type;\n    uint8_t flags;\n    uint32_t stream_id;\n    const uint8_t *payload;\n} h2o_http2_frame_t;\n```\n\n```\ntypedef struct st_h2o_socket_export_t {\n    int fd;\n    struct st_h2o_socket_ssl_t *ssl;\n    h2o_buffer_t *input;\n} h2o_socket_export_t;\n```\n\n```\ntypedef struct st_h2o_socketpool_t {\n\n    /* read-only vars */\n    h2o_socketpool_type_t type;\n    struct {\n        h2o_iovec_t host;\n        union {\n            /* used to specify servname passed to getaddrinfo */\n            h2o_iovec_t named_serv;\n            /* if type is sockaddr, the `host` is not resolved but is used for TLS SNI and hostname verification */\n            struct {\n                struct sockaddr_storage bytes;\n                socklen_t len;\n            } sockaddr;\n        };\n    } peer;\n    int is_ssl;\n    size_t capacity;\n    uint64_t timeout; /* in milliseconds (UINT64_MAX if not set) */\n    struct {\n        h2o_loop_t *loop;\n        h2o_timeout_t timeout;\n        h2o_timeout_entry_t entry;\n    } _interval_cb;\n\n    /* vars that are modified by multiple threads */\n    struct {\n        size_t count; /* synchronous operations should be used to access the variable */\n        pthread_mutex_t mutex;\n        h2o_linklist_t sockets; /* guarded by the mutex; list of struct pool_entry_t defined in socket/pool.c */\n    } _shared;\n} h2o_socketpool_t;\n```\n\nI don't know whether they are intentional or are for ABI compatibility. Please let me know if I am wrong.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/914/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "Winzigweich": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/876", "title": "download *.php file - not execute or open php. ", "body": "hello, my configuration file is: \n\naccess-log: /var/www/vhosts/system/affilie.de/logs/proxy_access_ssl_log\nerror-log: /var/www/vhosts/system/affilie.de/logs/error_log\nexpires: off\nfile.dirlisting: off\nfile.send-compressed: on\n\nlimit-request-body: 1024\n\npid-file: /var/run/h2o.pid\nuser: root\n\nfile.mime.addtypes:\n   \"text/html; charset=utf-8\": .html\n\nssl-session-resumption:\n   mode: all\n\nhosts:\n  \"HTTP server, redirect all requests to https\":\n   listen:\n      host: 217.160.108.85\n      port: 80\n   paths:\n     /:\n       redirect:\n         status: 301\n         url: https://www.affilie.de/\n\n  \"HTTPS server\":\n   listen:\n      host: 217.160.108.85\n      port: 4444\n      ssl:\n        certificate-file: /opt/psa/var/certificates/cert-FhvkAw\n        key-file: /opt/psa/var/certificates/cert-FhvkAw\n        cipher-preference: server\n        cipher-suite: ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA\n        minimum-version: TLSv1.2\n   paths:\n     /:\n\n```\n  file.dir: /var/www/vhosts/abonne-affilie.de/httpdocs/wordpress\n\n  header.add: \"cache-control: public, max-age=31556926\"\n  header.add: \"strict-transport-security: max-age=31556926; includesubdomains; preload\"\n  header.add: \"x-frame-options: deny\"\n```\n\nin browser all *.php files will open or save, not execute. \nhave anyone a idea?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/876/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "jay": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/870", "title": "h2o build process LDFLAGS not working", "body": "Hey Kazuho, I have an Ubuntu 14.04 LTS x64 VM that has two OpenSSL versions installed. The packaged one, OpenSSL 1.0.1f, and a different one I installed for ALPN, OpenSSL 1.0.2g. For various reasons I can't uninstall the former.\n\nTypically if I want to build a program that uses OpenSSL I can specify the OpenSSL path and specify that same path as an rpath to LDFLAGS so that the right OpenSSL libraries will be loaded from that path. I was under the impression I could do the same with cmake but it doesn't seem to work. For example:\n\n```\nLDFLAGS=\"-Wl,-rpath,/usr/local/ssl/lib -Wl,-rpath,/usr/local/lib\"  PKG_CONFIG_PATH=/usr/local/ssl/lib/pkgconfig cmake -DWITH_BUNDLED_SSL=off\n```\n\nIt appears h2o will build with the right libraries but when I run h2o it will error with `undefined symbol: SSL_CTX_set_alpn_select_cb` and that is because it is still loading the old SSL libs. In other words the LDFLAGS doesn't seem to matter. I also tried CMAKE_EXE_LINKER_FLAGS, CMAKE_SHARED_LINKER_FLAGS and CMAKE_MODULE_LINKER_FLAGS, and separately OPENSSL_LIBRARIES and OPENSSL_INCLUDE_DIR.\n\nFor now I've just reverted to BUNDLED_SSL=on so this isn't a blocker for me.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/870/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "eleshar": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/861", "title": "h2o-2.0.0-beta2 Build Failure", "body": "I'm attempting to build h2o-2.0.0-beta2 but keeps failing on Linux lsdev.biz 3.16.0-4-amd64 SMP Debian 3.16.7-ckt25-1 (2016-03-06) x86_64\n\n```\n/root/sources/h2o-2.0.0-beta2/lib/common/socket.c: In function \u2018on_async_resumption_remove\u2019:\n/root/sources/h2o-2.0.0-beta2/lib/common/socket.c:587:52: error: dereferencing pointer to incomplete type\n     h2o_iovec_t session_id = h2o_iovec_init(session->session_id, session->session_id_length);\n                                                    ^\n/root/sources/h2o-2.0.0-beta2/lib/common/socket.c:587:73: error: dereferencing pointer to incomplete type\n     h2o_iovec_t session_id = h2o_iovec_init(session->session_id, session->session_id_length);\n                                                                         ^\n/root/sources/h2o-2.0.0-beta2/lib/common/socket.c: In function \u2018h2o_socket_ssl_async_resumption_setup_ctx\u2019:\n/root/sources/h2o-2.0.0-beta2/lib/common/socket.c:723:34: warning: passing argument 2 of \u2018SSL_CTX_sess_set_get_cb\u2019 from incompatible pointer type\n     SSL_CTX_sess_set_get_cb(ctx, on_async_resumption_get);\n                                  ^\nIn file included from /root/sources/h2o-2.0.0-beta2/include/h2o/socket.h:31:0,\n                 from /root/sources/h2o-2.0.0-beta2/lib/common/socket.c:31:\n/usr/local/include/openssl/ssl.h:723:6: note: expected \u2018struct SSL_SESSION * (*)(struct ssl_st *, const unsigned char *, int,  int *)\u2019 but argument is of type \u2018struct SSL_SESSION * (*)(struct SSL *, unsigned char *, int,  int *)\u2019\n void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,\n      ^\nCMakeFiles/libh2o.dir/build.make:422: recipe for target 'CMakeFiles/libh2o.dir/lib/common/socket.c.o' failed\nmake[2]: *** [CMakeFiles/libh2o.dir/lib/common/socket.c.o] Error 1\nCMakeFiles/Makefile2:348: recipe for target 'CMakeFiles/libh2o.dir/all' failed\nmake[1]: *** [CMakeFiles/libh2o.dir/all] Error 2\nMakefile:117: recipe for target 'all' failed\nmake: *** [all] Error 2\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/861/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "hrektts": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/858", "title": "undefined reference to `__sync_add_and_fetch_8'", "body": "2.0.0-beta2 fails to build from source on a ppc32 Linux box with the following error message:\n\n```\n$ cmake .\n$ make\n.......\n[ 40%] Linking CXX executable h2o\nCMakeFiles/h2o.dir/lib/http1.c.o: In function `h2o_create_connection':\n/tmp/src/h2o-2.0.0-beta2/include/h2o.h:1578: undefined reference to `__sync_add_and_fetch_8'\nCMakeFiles/h2o.dir/lib/http2/connection.c.o: In function `h2o_create_connection':\n/tmp/src/h2o-2.0.0-beta2/include/h2o.h:1578: undefined reference to `__sync_add_and_fetch_8'\ncollect2: ld returned 1 exit status\nmake[2]: *** [h2o] Error 1\nmake[1]: *** [CMakeFiles/h2o.dir/all] Error 2\nmake: *** [all] Error 2\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/858/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "mingodad": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/857", "title": "h2o nginx h2load", "body": "Hello !\nI did a test of my fork of h2o with nginx on a raspberry pi 3 and although h2o outperforms nginx (2 by 1) on https requests using httpress/ab tools but with h2load/wrk h2o/nginx perform basically the same except nginx has lot better time to first byte.\nAnd that intrigues me because h2o page shows it performs nginx on time to first byte.\n\nSee here https://gist.github.com/mingodad/e5a46c809ee030befc18\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/857/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/840", "title": "Response sent twice crash h2o", "body": "Hello !\nI'm creating a scripting module for h2o and testing an application I'm getting an assert at:\n\n```\nvoid do_write(h2o_socket_t *_sock, h2o_iovec_t *_bufs, size_t bufcnt, h2o_socket_cb cb)\n{\n...\n    assert(sock->super._cb.write == NULL); ///<<<<< here\n```\n\nThe problem arises because one script called `h2o_send_redirect` and while doing other final work got an error and when back at  `handle_request(h2o_handler_t *_handler, h2o_req_t *req)` I returned -1, then h2o continue calling other handlers and finally try to send a:\n\n```\nreq->send_error(404, \"File Not Found\", \"not found\", 0);\n```\n\nAnd because a `h2o_send_redirect` was already sent  this assert `assert(sock->super._cb.write == NULL);` aborts h2o.\n\nSo how can we prevent this ?\nI was thinking in 2 ways:\n1 - h2o provides a way to detect if a response was already sent to return 0 from `handle_request`.\n2 - h2o internally detect it and write an error log and abort the attempt to send a response twice.\n\nAnyone have other idea ?\n\nCheers !\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/840/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/833", "title": "Knowing the number of threads", "body": "Hello !\nI'm creating a scripting module and it has a debug option that when enabled will reload and compile the script for every request (when doing web development we change a file and expect just to reload the page on the web browser) but for it to work properly h2o need to be configured to only use one thread so I was willing to check it at configuration time to abort/warn the user about it (because the scripting reload/compile will be a mess, one thread compiling and other reloading/invalidating, ...), but actually there is no way to know from the api how many threads are running (if the user do not specify on the config file in main.c it'll be set for the number of cpus but without setting it back to the h2o_globalconf_t).\n\nCheers ! \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/833/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/826", "title": "h2o etag on http2", "body": "Hello !\nI'm testing one application with h2o and it send small images from a database and sets the \"etag\" with a datetime string, h2o works fine with http and https for http1.\\* both not http2.\n\nIf I do not set the etag then it works with http2 too.\n\n```\nrequest.response_header(\"ETag\", img_etag); // img_etag  2012-07-22 09:45:10\n\ncurl: (16) HTTP/2 stream 1 was not closed cleanly: error_code = 1\n```\n\nCheers !\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/826/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/762", "title": "h2o tests do no work properly on ubuntu 14.04", "body": "Hello !\nI'm trying to execute the h2o tests on ubuntu 14.04 and there is several dependencies on perl5 modules that do not compile/install or are not supported by perl 5.18.2 the default perl on ubuntu 14.04.\nAlso \"OCSP Stapling\" is not executed, any chance to have a public certificate that can be used to test it ?\n\nCheers !\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/762/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/752", "title": "h2o as C++", "body": "Hello !\nI started an attempt to convert h2o from C to C++ at https://github.com/mingodad/h2o , right now it still uses the \".c\" extension to make it easy to compare with the original h2o files, it started with h2o version 1.7, it's passing all tests that my machine can perform, to compile it's the same as the original h2o except that it uses a C++ compiler instead of C, right now it doesn't include any C++ library.\n\nWhy do it ?\nh2o has a good performance and small code base but C++ offer better ways to create cleaner/safe high level code and maintain all the advantages of C.\n\nAny suggestions/comments are welcome, I'll give back any improvement/code that can be reused to h2o and also will try to follow the h2o updates.\n\nCheers !\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/752/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/646", "title": "klib possible bug ?", "body": "Hello !\nMaking a test where I rename \".c\" files to \".cpp\" and try compile then with g++ shows this error in klib:\n\n```\ndeps/klib/bgzf.cpp: In function \u2018int bgzf_check_EOF(BGZF*)\u2019:\ndeps/klib/bgzf.cpp:462:29: error: initializer-string for array of chars is too long [-fpermissive]\n  static uint8_t magic[28] = \"\\037\\213\\010\\4\\0\\0\\0\\0\\0\\377\\6\\0\\102\\103\\2\\0\\033\\0\\3\\0\\0\\0\\0\\0\\0\\0\\0\\0\";\n```\n\nCheers !\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/646/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/348", "title": "Maybe libtask for inner thread processing can be usefull !", "body": "Hello !\n\nToday I review this library https://swtch.com/libtask/ and thought that it would be helpful to process connections inner threads for content handlers.\n\nCheers ! \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/348/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57359513", "body": "Also nginx probably is logging the requests, h2o isn't, that will slow down h2o abit.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57359513/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57361290", "body": "Nginx logs all requests but h2o do not, that is not fair comparison.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57361290/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68028016", "body": "Here is the config file:\n\n# \n\nnum-threads: 2\nlisten: 8080\nlisten:\n  port: 8081\n  ssl:\n    certificate-file: examples/h2o/server.crt\n    key-file: examples/h2o/server.key\n\nhosts:\n  \"127.0.0.1.xip.io:8080\":\n    paths:\n      /:\n        file.dir: examples/doc_root\n    access-log: /dev/null\n\n  \"alternate.127.0.0.1.xip.io:8081\":\n    listen:\n      port: 8081\n      #port: h2o_unix\n      #type: unix\n      ssl:\n        certificate-file: examples/h2o/alternate.crt\n        key-file: examples/h2o/alternate.key\n    paths:\n      /:\n        file.dir: examples/doc_root.alternate\n    access-log: /dev/null\n\n# \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68028016/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68028315", "body": "Maybe the question that I made about how listener threads are managed have something with this?\n\nmingodadDecember 23, 2014 at 2:46 PM\nI was looking at the src/main.c and found that each thread is creating it's own listeners queue using the server listeners. Isn't this a mistake ?\nWhat will happen when there is more than one thread ?\nAll of then will wakeup and try to manage the accepted socket ?\nWhy not accepting the listeners only in main process and distribute the accepted sockets to threads after ?\n\nAm I missing something here ?\n\nCheers !\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68028315/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68618628", "body": "Would be nice if we could set the max body size before it starts reading it on a per request basis.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68618628/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68622217", "body": "h2o_parse_url do not recognize unix sockets.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68622217/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68644106", "body": "Thank you !\n\nI did a test using a scripting language (squilu https://code.google.com/p/squilu/) and the server side works !\n\n---\n\nfunction download(usock, host, file, extra_header=null){\n    local sock = socket.unix();\n    sock.connect(usock);\n    //local info = sock.getpeername()\n    //print(info.address, info.port);\n    //sock.settimeout(1);\n\n```\nlocal count = 0;    // counts number of bytes read\nlocal req = \"GET \" + file + \" HTTP/1.1\\r\\nHost: \" + host + \"\\r\\n\";\nif (extra_header) req += extra_header + \"\\r\\n\";\nreq += \"\\r\\n\";\nprint(req, req.len());\nsock.send(req);\nlocal s, rc;\nlocal tbl = {};\nlocal len = 0;\nwhile (true){\n    rc = sock.receive(\"*l\");\n    s = rc[0];\n    print(\"s\", s, rc[1]);\n    //if err == \"closed\" then break end\n    if (s.len() == 0) break;\n    //if (rc[1] == socket.IO_CLOSED) break;\n    local slen;\n    s.gmatch(\"Content%-Length: (%d+)\", function(m){ slen=m; return false;});\n    if (slen) {\n        len = slen.tointeger();\n    }\n}\nrc = sock.receive(len);\ns = rc[0];\nsock.close();\n//print(file, count)\nreturn s;\n```\n\n}\n\nlocal page;\n\npage = download(\"/tmp/h2o.sock\", \"unix.local\", \"/\");\nprint(page);\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68644106/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69878140", "body": "I did a refactoring, now we can create request handlers from LUA itself in a function called on thread initialization:\n\n```\n--per thread initialization\nfunction h2oOnThreadStart(ctx)\n    ctx:register_handler_global(\"/LUA/\")\n    --ctx:register_handler_on_host(\"/LUA/\", \"www.example.com\")\nend\n\n\n--per thread finalization\nfunction h2oOnThreadEnd(ctx)\nend\n\n--per request call\nfunction h2oManageRequest(req)\n    local host = req:host() --also req:authority()\n    local path = req:path()\n    if path:find(\"/LUA/\", 1, true) then\n        return myLuaRequestHandler(req, host, path)\n    end\n    return 0\nend\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69878140/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/16292151", "body": "How much performance degrade on multiple cpus by this new contention point \"connection id\" ?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/16292151/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "review_comments": []}, "szepeviktor": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/855", "title": "Qualys A+", "body": "Could h2o be setup to get A+ grade?\nhttps://www.ssllabs.com/ssltest/analyze.html?d=h2o.examp1e.net\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/855/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/13087894", "body": "`apt-get install netcat-openbsd` to support `-U`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/13087894/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/14403469", "body": "Could it be that this is not in master but in v1.5.x?\n\nhttps://github.com/h2o/h2o/blob/master/Changes has nothing for 1.5.4\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/14403469/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/26727612", "body": "@kazuho Could it be that coverity does not check h2o anymore?", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/26727612/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "review_comments": []}, "tobybryans": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/852", "title": "Allow running of cgi-scripts without file extensions", "body": "I'm trying to set up h2o instead of apache httpd on a customer site which uses mailman. The cgi-scripts provided by mailman do not have any extensions but instead are all in a /cgi-bin/ folder. I tried:\n\n```\n      /mailman/:\n        file.dir: /u01/app/mailman/cgi-bin/\n        fastcgi.spawn:\n          command: \"exec /u01/app/h2o/share/h2o/fastcgi-cgi\"\n          user: mailman\n```\n\nbut this just fetched the file from the cgi-bin folder. Since the files do not have an extension I can't catch them with file.extension. Is there another way?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/852/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "arafath-mk": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/843", "title": "Is it possible to use Go (Golang) style IO using libmill?", "body": "In Go, a programmer will get benefits of the asynchronous IO by writing code in normal synchronous style itself. In Go, each http connections are served in separate goroutines. If a goroutine does any blocking IO, then Go will internally switch execution to some other goroutine. (If there is any goroutine is available)\n\nA similar library is available for C, called libmill.  https://github.com/sustrik/libmill\n\nCan h2o use libmill?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/843/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "isoma0": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/842", "title": "Feature request: gzip Transfer-Encoding for HTTP/1.1 responses", "body": "I would like [H2O](https://h2o.examp1e.net) to be able to send responses compressed with gzip. Lots of webservers (mis)use Content-Encoding: for this; however, a web proxy should not change the content encoding.\n\nI would like to be able to operate H2O as a reverse proxy and, for HTTP/1.1 connections, apply gzip [Transfer-Encoding](https://tools.ietf.org/html/rfc2616#section-14.41) even if the origin server has sent an uncompressed response.\n\nFor background on why Transfer-Encoding rather than Content-Encoding, see http://stackoverflow.com/a/11664307\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/842/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "karantin2020": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/831", "title": "Socket read errors again", "body": "Hello. I tested last version of h2o server `h2o/2.0.0-DEV` (1.8.0-alpha1 is the same).\nI have some errors raised when used wrk http benchmark tool.\n`[INFO] raised RLIMIT_NOFILE to 65536`, `ulimit -n` is the same.\nTested pure h2o server with no changes.\nOS: `Linux 3.13.0-79-generic #123-Ubuntu SMP Fri Feb 19 14:27:58 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux`.\n\n``` sh\n$ wrk -d30s -c10000 -t2 --timeout 20s http://127.0.0.1:8080\nRunning 30s test @ http://127.0.0.1:8080\n  2 threads and 10000 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    22.84ms   22.37ms 261.64ms   76.20%\n    Req/Sec    21.24k     5.26k   32.36k    70.12%\n  1261111 requests in 30.09s, 499.12MB read\n  Socket errors: connect 0, read 8774, write 0, timeout 0\nRequests/sec:  41913.01\nTransfer/sec:     16.59MB\n```\n\nIf there is less connections then everything is fine.\n\n``` sh\n$ wrk -d300s -c1000 -t2 --timeout 20s http://127.0.0.1:8080\nRunning 5m test @ http://127.0.0.1:8080\n  2 threads and 1000 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    24.46ms   14.71ms 173.07ms   66.22%\n    Req/Sec    20.57k     3.20k   31.25k    79.82%\n  12284491 requests in 5.00m, 4.75GB read\nRequests/sec:  40941.84\nTransfer/sec:     16.20MB\n```\n\nSomething similar is with apache ab.\n\n```\n$ ab -n 500000 -c 1000 -t 10 -k http://127.0.0.1:8080/\nThis is ApacheBench, Version 2.3 <$Revision: 1528965 $>\nCopyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/\nLicensed to The Apache Software Foundation, http://www.apache.org/\n\nBenchmarking 127.0.0.1 (be patient)\nCompleted 5000 requests\nCompleted 10000 requests\nCompleted 15000 requests\nCompleted 20000 requests\nCompleted 25000 requests\nCompleted 30000 requests\nCompleted 35000 requests\nCompleted 40000 requests\nCompleted 45000 requests\nCompleted 50000 requests\nFinished 50000 requests\n\n\nServer Software:        h2o/2.0.0-DEV\nServer Hostname:        127.0.0.1\nServer Port:            8080\n\nDocument Path:          /\nDocument Length:        177 bytes\n\nConcurrency Level:      1000\nTime taken for tests:   1.171 seconds\nComplete requests:      50000\nFailed requests:        0\nKeep-Alive requests:    50000\nTotal transferred:      20750000 bytes\nHTML transferred:       8850000 bytes\nRequests per second:    42680.83 [#/sec] (mean)\nTime per request:       23.430 [ms] (mean)\nTime per request:       0.023 [ms] (mean, across all concurrent requests)\nTransfer rate:          17297.41 [Kbytes/sec] received\n\nConnection Times (ms)\n              min  mean[+/-sd] median   max\nConnect:        0    1   5.0      0      48\nProcessing:     1   22  13.7     21     249\nWaiting:        1   22  13.7     21     249\nTotal:          1   23  14.8     22     273\n\nPercentage of the requests served within a certain time (ms)\n  50%     22\n  66%     26\n  75%     29\n  80%     32\n  90%     43\n  95%     48\n  98%     53\n  99%     61\n 100%    273 (longest request)\n```\n\n1000+ concurrent connections cause errors again.\n\n``` sh\n$ ab -n 500000 -c 10000 -t 10 -k http://127.0.0.1:8080/\nThis is ApacheBench, Version 2.3 <$Revision: 1528965 $>\nCopyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/\nLicensed to The Apache Software Foundation, http://www.apache.org/\n\nBenchmarking 127.0.0.1 (be patient)\nCompleted 5000 requests\nCompleted 10000 requests\nCompleted 15000 requests\nCompleted 20000 requests\nCompleted 25000 requests\nCompleted 30000 requests\nCompleted 35000 requests\nCompleted 40000 requests\nCompleted 45000 requests\napr_socket_recv: Connection reset by peer (104)\nTotal of 49615 requests completed\n```\n\nor errors like\n\n``` sh\nFailed requests:        6\n   (Connect: 0, Receive: 0, Length: 6, Exceptions: 0)\n```\n\nIs it server error? Or only linux distro (ubuntu customized kernel) error? Or something else?\nHas any one the same errors?\nThanks.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/831/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/804", "title": "Server router", "body": "Hello.\nI found this issue in code.\n\n``` c\nh2o_pathconf_t *h2o_config_register_path(h2o_hostconf_t *hostconf, const char *pathname)\n## Register path\n{\n    h2o_pathconf_t *pathconf;\n\n    h2o_vector_reserve(NULL, &hostconf->paths, hostconf->paths.size + 1);\n    pathconf = hostconf->paths.entries + hostconf->paths.size++;\n    ## Path is added in the end of paths list\n    h2o_config_init_pathconf(pathconf, hostconf->global, pathname, hostconf->mimemap);\n\n    return pathconf;\n}\n\nstatic void process_hosted_request(h2o_req_t *req, h2o_hostconf_t *hostconf)\n## Searching for corresponding path on request\n{\n    size_t i;\n\n    req->hostconf = hostconf;\n    req->pathconf = &hostconf->fallback_path;\n\n    /* setup pathconf, or redirect to \"path/\" */\n    for (i = 0; i != hostconf->paths.size; ++i) {\n        h2o_pathconf_t *pathconf = hostconf->paths.entries + i;\n        size_t confpath_wo_slash = pathconf->path.len - 1;\n        if (req->path_normalized.len >= confpath_wo_slash &&\n            memcmp(req->path_normalized.base, pathconf->path.base, confpath_wo_slash) == 0) {\n            if (req->path_normalized.len == confpath_wo_slash) {\n                req->pathconf = pathconf;\n                h2o_iovec_t dest = h2o_uri_escape(&req->pool, pathconf->path.base, pathconf->path.len, \"/\");\n                if (req->query_at != SIZE_MAX)\n                    dest =\n                        h2o_concat(&req->pool, dest, h2o_iovec_init(req->path.base + req->query_at, req->path.len - req->query_at));\n                h2o_send_redirect(req, 301, \"Moved Permanently\", dest.base, dest.len);\n                return;\n            }\n            if (req->path_normalized.base[confpath_wo_slash] == '/') {\n                req->pathconf = pathconf;\n                break;\n                ## This breaks search loop\n            }\n        }\n    }\n\n    call_handlers(req, req->pathconf->handlers.entries);\n}\n```\n\nI did this:\n1. Used standalone server with costume changes to add handlers.\n2. Server starts with config file that has some paths with handlers\n3. In code I added some handler with path `/name`\n\nThe result path list was:\n`'/next'` - from config file\n`'/'` - from config file\n`'/name'` - added in code\n\nWhen `process_hosted_request` the last processed path is  `/` but not `/name`. Replied with 404 status.\n\nIt may be corrected only by sorting path list.\nIt is not problem. But is there any standard function for that in h2o? Or any other solution?\n\nAnd more. Did you think about any request router for h2o? May be it's there, I didn't find it?\nDon't paths support pattern matches (regexp or wildcard)?\n\nThanks.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/804/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "s0j0urn": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/805", "title": "Max local stream count 100 exceeded", "body": "Test Case:\n\n```\nClient Jar: HTTP/2v9.3.7\nServer: h2ov1.7.0\n```\n\nI am requesting about 219 resources from the server and 1 resource is being pushed. Irrespective of push or not, I have observed this issue: \n\n```\n2016-02-24 16:09:26.794:WARN:oeju.Promise$Adapter:main: \njava.lang.IllegalStateException: Max local stream count 100 exceeded\n    at org.eclipse.jetty.http2.HTTP2Session.createLocalStream(HTTP2Session.java:633)\n    at org.eclipse.jetty.http2.HTTP2Session.newStream(HTTP2Session.java:443)\n    at http2.client.Http2ClientBenchMark.main(Http2ClientBenchMark.java:110)\n```\n\nI did not observe this issue while using Jetty Server `v9.3.6`. I found out that h2o limits this max_concurrent_streams to 100 in the initial SETTINGS frame sent. Is there anyway I can get around this.\n\nHere is my Jetty client code:\n\n```\n    for(int i=0;i<urlsListSize;i++)\n    {\n\n        MetaData.Request metaDataRequest = new MetaData.Request(\"GET\", new HttpURI(\"https://\" + host + \":\" + port + urlsList.get(i).substring(urlsList.get(i).indexOf('/',8))), HttpVersion.HTTP_2, requestFields);\n        //Create Headers frame\n        HeadersFrame headersFrame = new HeadersFrame(metaDataRequest,null,true);\n\n        //Listen to response frames.\n\n        session.newStream(headersFrame, new Promise.Adapter<Stream>(), new Stream.Listener.Adapter()\n        {\n            @Override\n            public void onHeaders(Stream stream, HeadersFrame frame)\n            {\n                System.out.println(\"Header frame \" + frame);\n                if (frame.isEndStream()) {\n                    System.out.println(\"on Headers frame end\" + frame.getStreamId());\n\n                }\n            }\n\n            @Override\n            public void onData(Stream stream, DataFrame frame, Callback callback)\n            {\n                System.out.println(\"Data frame\" + frame);\n\n                callback.succeeded();\n                if (frame.isEndStream()) {\n                    System.out.println(\"on data frame end\" + frame.getStreamId());\n\n                }\n            }\n\n            @Override\n            public Stream.Listener onPush(Stream stream, PushPromiseFrame frame)\n            {\n\n                System.out.println(\"Push promise frame received);\n\n                return this;\n            }\n        });\n\n    }\n```\n\n If I cannot get around this limitation, what could be my possible options to handle this so that all the resources are fetched without affecting the performance.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/805/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/490", "title": "h2o configuration for server push", "body": "Hello,\n\nI have been trying to design some server push tests. However, I cannot see the requested resource being pushed by h2o server. I am not sure where I am getting it wrong. Will you please check and let me know my mistake.\n\nHere is my `h2o.conf` file:\n\n```\nuser: nobody\n#header.add: \"link: </css/index.css>; rel=preload; as=stylesheet\"\nhosts:\n  \"127.0.0.1.xip.io:8081\":\n    listen:\n      host: 127.0.0.1\n      port: 8081\n      ssl:\n        certificate-file: examples/h2o/server.crt\n        key-file: examples/h2o/server.key\n    paths:\n      \"/\":\n        file.dir: examples/doc_root\n        header.add: \"Link: </css/index.css>; rel=preload; as=stylesheet\"\naccess-log: /dev/stdout\nerror-log: /home/machine_name/h2o_software/h2o-1.4.4/h20_error_log.txt\npid-file: /home/machine_name/h2o_software/h2o-1.4.4/h20_pid_file.pid\n```\n\nHere is the response using nghttp client:\n\n```\nnghttp -nv --stat https://127.0.0.1:8081/index.html\n[  0.001] Connected\nThe negotiated protocol: h2\n[  0.006] send SETTINGS frame <length=12, flags=0x00, stream_id=0>\n          (niv=2)\n          [SETTINGS_MAX_CONCURRENT_STREAMS(0x03):100]\n          [SETTINGS_INITIAL_WINDOW_SIZE(0x04):65535]\n[  0.007] send HEADERS frame <length=33, flags=0x05, stream_id=1>\n          ; END_STREAM | END_HEADERS\n          (padlen=0)\n          ; Open new stream\n          :method: GET\n          :path: /index.html\n          :scheme: https\n          :authority: 127.0.0.1:8081\n          accept: */*\n          accept-encoding: gzip, deflate\n          user-agent: nghttp2/0.7.5\n[  0.007] recv SETTINGS frame <length=18, flags=0x00, stream_id=0>\n          (niv=3)\n          [SETTINGS_ENABLE_PUSH(0x02):0]\n          [SETTINGS_MAX_CONCURRENT_STREAMS(0x03):100]\n          [SETTINGS_INITIAL_WINDOW_SIZE(0x04):262144]\n[  0.007] send SETTINGS frame <length=0, flags=0x01, stream_id=0>\n          ; ACK\n          (niv=0)\n[  0.007] recv SETTINGS frame <length=0, flags=0x01, stream_id=0>\n          ; ACK\n          (niv=0)\n[  0.007] recv (stream_id=1) :status: 200\n[  0.007] recv (stream_id=1) server: h2o/1.4.4\n[  0.007] recv (stream_id=1) date: Wed, 09 Sep 2015 21:36:45 GMT\n[  0.007] recv (stream_id=1) content-type: text/html\n[  0.007] recv (stream_id=1) last-modified: Wed, 09 Sep 2015 19:40:33 GMT\n[  0.007] recv (stream_id=1) etag: \"55f08b31-106\"\n[  0.007] recv (stream_id=1) accept-ranges: bytes\n[  0.007] recv (stream_id=1) link: </css/index.css>; rel=preload; as=stylesheet\n[  0.007] recv HEADERS frame <length=121, flags=0x04, stream_id=1>\n          ; END_HEADERS\n          (padlen=0)\n          ; First response header\n[  0.007] recv DATA frame <length=262, flags=0x01, stream_id=1>\n          ; END_STREAM\n[  0.007] send GOAWAY frame <length=8, flags=0x00, stream_id=0>\n          (last_stream_id=0, error_code=NO_ERROR(0x00), opaque_data(0)=[])\n***** Statistics *****\n\nRequest timing:\n  responseEnd: the  time  when  last  byte of  response  was  received\n               relative to connectEnd\n requestStart: the time  just before  first byte  of request  was sent\n               relative  to connectEnd.   If  '*' is  shown, this  was\n               pushed by server.\n      process: responseEnd - requestStart\n         code: HTTP status code\n         size: number  of  bytes  received as  response  body  without\n               inflation.\n          URI: request URI\n\nsee http://www.w3.org/TR/resource-timing/#processing-model\n\nsorted by 'complete'\n\nresponseEnd requestStart  process code size request path\n     +665us       +193us    471us  200  262 /index.html\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/490/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "oimou": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/795", "title": "The first frame after connection preface", "body": "RFC7540 says\n\n> That is, the connection preface starts with the string \"PRI *\n>    HTTP/2.0\\r\\n\\r\\nSM\\r\\n\\r\\n\").  This sequence MUST be followed by a\n>    SETTINGS frame (Section 6.5), which MAY be empty.\n\nin [3.5 HTTP/2 Connection Preface](https://tools.ietf.org/html/rfc7540#section-3.5).\n\nSo, the first frame after connection preface should be SETTINGS. However, according to this output of [h2i](https://github.com/bradfitz/http2/tree/master/h2i), h2o server seems to accept HEADERS frame as the first frame after connection preface.\n\n```\n % ./h2o -c h2o.conf &\n...\n\n % h2i -insecure localhost:8081\nConnecting to localhost:8081 ...\nConnected to [::1]:8081\nNegotiated protocol \"h2\"\n[FrameHeader SETTINGS len=12]\n  [MAX_CONCURRENT_STREAMS = 100]\n  [INITIAL_WINDOW_SIZE = 16777216]\nh2i> HEADERS\n(as HTTP/1.1)> GET / HTTP/1.1\n(as HTTP/1.1)>\nOpening Stream-ID 1:\n :authority =\n :method = GET\n :path = /\n :scheme = https\n[FrameHeader HEADERS flags=END_HEADERS stream=1 len=63]\n  :status = \"404\"\n  server = \"h2o/1.8.0-alpha1\"\n  date = \"Sat, 20 Feb 2016 19:04:32 GMT\"\n  content-type = \"text/plain; charset=utf-8\"\n  content-length = \"9\"\n[FrameHeader DATA flags=END_STREAM stream=1 len=9]\n  \"not found\"\nh2i>\n```\n\nIs it expected behaviour?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/795/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "dtruffaut": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/776", "title": "Feature Request : Proxy Cache", "body": "h2o cache aware server push (http2-casper) is a brilliant feature, that performs very well for assets.\n\n... But there is currently no cache mechanism for the caller : the html document. \n\nPlease provide a proxy cache directive to be able to cache/microcache the result of the back-end response.\n\nSee also : NginX proxy cache\nhttps://www.nginx.com/resources/wiki/start/topics/examples/reverseproxycachingexample/\nhttps://www.nginx.com/blog/nginx-caching-guide/\nhttps://www.nginx.com/blog/benefits-of-microcaching-nginx/\nhttps://www.nginx.com/resources/admin-guide/nginx-tcp-ssl-upstreams/\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/776/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/775", "title": "Feature Request : Load balancing - Proxy - Cluster", "body": "h2o is an amazing tool !\n\nToday it can challenge Varnish with the cache aware server push feature (http2-casper) that brings cache logic and memory consumption to the client. That is a great improvement.\n\nTomorrow, with the ability to proxify requests to a cluster of backends, it can even challenge load balancers like HAProxy or NginX.\n\nHere is a proposal of a very basic and naive declaration of a cluster :\n\n```\ncluster: &back_cluster\n  - http://127.0.0.1:8080\n  - http://127.0.0.1:8081\n  - http://127.0.0.1:8082\n\nhosts:\n  \"example.com\":\n    listen:      \n        ...\n    paths:\n      \"/\":\n        proxy.reverse.url: *back_cluster\n```\n\nNotes: \n- Clusters IP can be internal or external\n- Clusters can be defined at multiple levels (global, host, ...)\n- Multiple clusters can defined (one for backend, one for backoffice, one for files, ...etc.)\n- Clusters be used with the reproxy directive\n\nBonus : we can even listen from a cluster :\n\n```\ncluster: &in_cluster\n  - http://92.250.218.59:443\n  - http://92.250.218.60:443\n  - http://92.250.218.61:443\n\nhosts:\n  \"example.com\":\n    listen: *in_cluster     \n    ssl:\n      certificate-file: /etc/letsencrypt/live/example.com/fullchain.pem\n      key-file: /etc/letsencrypt/live/example.com/privkey.pem\n      ...\n```\n\n...But that supposes to separate `listen:` from `ssl:`.\n\nHere is an alternative, more extensible but also more verbose syntax:\n\n```\ncluster: &back_cluster\n  another_option: ...\n  nodes:\n    - node:\n        scheme: \"http\"\n        host: 127.0.0.1\n        port: 8080\n        weight: 1\n    - node:\n        scheme: \"http\"\n        host: 127.0.0.1\n        port: 8081\n        weight: 2\n    - node:\n        scheme: \"http\"\n        host: 127.0.0.1\n        port: 8082\n        weight: 1\n\nhosts:\n  \"example.com\":\n    listen:      \n        ...\n    paths:\n      \"/\":\n        proxy.reverse.url: *back_cluster\n```\n\nNote : I wrote \"node\" but it could be \"server\", \"entry\" or whatever more semantic.\n\nRelated issues : \nhttps://github.com/h2o/h2o/issues/90\nhttps://github.com/h2o/h2o/issues/764\nhttps://github.com/h2o/h2o/issues/577\n\nSee also : NginX Upstream :\nhttp://nginx.org/en/docs/http/ngx_http_upstream_module.html\nhttp://nginx.org/en/docs/http/load_balancing.html\nhttps://www.nginx.com/resources/admin-guide/load-balancer/\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/775/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/769", "title": "Feature request - Write a nginx to h2o translator tool for configuration file", "body": "Feature :\nWrite a nginx to h2o translator tool for configuration file\n\nExpected benefit :\nIncrease conversion from nginx to h2o\nCommercial argument : Change from nginx is easy\nAvoid or limit FAQ time consumption\n## \n\nBonus tasks :\nDo the same work with Apache\nWrite a web tool that generates installation script (with LetsEncrypt) according to the selected OS\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/769/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "abhi-bit": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/742", "title": "Example application demonstrating a real world chunked-encoding scenario", "body": "Hi @kazuho,\n\nI'm planning to use h2o as a library for following application use case:\n- Expose `/query` endpoint over HTTP.\n- Curl against `/query` endpoint results into a read call for a file on disk(b+tree based)\n- When handler function reads individual disk blocks, it needs to stream the read data over HTTP to user.\n\nHere is what I've tried out in this regard:\n- Looked up `chunked.c` example, where `h2o_chunked_register` is supposed to create filter based on `h2o_pathconf_t*`(which would handle `/query` endpoint for my use case).\n- Way I'm handling streaming of individual disk block, by passing a callback function - which would be responsible for reading blocks from file and then writing it to the http socket.\n\nArea where I'm stuck is how can I've callback function write to http socket post reading a disk block. (I'm reading source to figure a way out, but would be useful if could provide any pointers).\n\n(Eventually I'm thinking of writing a getting started with h2o guide, which would be of use to folks like me)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/742/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "dantman": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/741", "title": "Better reverse-proxy support", "body": "I'd like to use h2o primarily as a reverse proxy that'll provide SSL termination and HTTP/2 support (which is better than any other server I'd consider using) for my varnish and nginx backends.\n\nThe problem is, `proxy.reverse.url` is part of `paths` which is only valid in the `host` context. This means A) it's impossible to proxy all your sites without explicitly defining a host for every single hostname you use; and B) the h2o config file gets massive due to all the duplicate configs.\n\nIdeally it would be possible to define a `paths` in `global` context so you could listen globally to port `80`, add https hosts listening on 443 for the ssl config, and reverse proxy all that to the same webserver.\n\nSomething easier to implement that would also help a bit would be a way to define some common config and include it elsewhere in the file. Such as an `include`/`includes` setup:\n\n``` yaml\nincludes:\n  proxy:\n    \"/\":\n      proxy.reverse.url: \"http://127.0.0.1:80\"\n      proxy.preserve-host: ON\nhosts:\n  \"vancouver-anime.com\":\n    listen: 80\n    listen:\n      port: 443\n      ssl:\n        certificate-file: ...\n        key-file: ...\n    paths:\n      include: proxy\n  # more hosts with similar config\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/741/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "Wonderfall": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/713", "title": "How can I use a \"stronger\" ECDH curve?", "body": "Hi, first of all thanks for you work. h2o is incredibly fast.\nHow can I use another curve like `secp384r1` for ECDH (not DH) with h2o ? I'd feel more confortable with it, though `prime256v1` is actually considered as sufficient (and should be in the next years). It may sound stupid to you, but I was used to modify the `ssl_ecdh_curve` directive on nginx. That's why I'm lost here.\n\nSo, is there a directive dedicated to ECDH cuve on h2o ? \n(Nothing mentions that, so I fear the answer is no.)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/713/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "math0ne": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/711", "title": "Extra trailing slash 301 redirect on redirect directive in config", "body": "When using what seems like a simple 302 redirect (/anim/arm.html -> https://ib-staging.htdt.net/anatomy/nervous/arm-hand) in my config I seem to be getting an additional 301 redirect that is adding a closing slash to my url before re-directing to the proper url.  Any ideas what could be causing this.\n\nI'm running version: h2o/1.7.0-beta1\n\nYou can see the affect here: \n\n![2016-01-19_1118](https://cloud.githubusercontent.com/assets/3026/12426272/819e198c-be9e-11e5-8581-d740836b89cc.png)\n\nThese are the headers:\n\n![2016-01-19_1120](https://cloud.githubusercontent.com/assets/3026/12426322/bbb2521e-be9e-11e5-98f6-6bdd41b1e1f9.png)\n\nThis is my config:\n\n```\n# to find out the configuration commands, run: h2o --help\n\nmax-connections: 65536\nlimit-request-body: 536870912\nnum-threads: 16\nnum-name-resolution-threads: 1\nhttp2-reprioritize-blocking-assets: ON\ntcp-fastopen: 33554432\nhttp1-upgrade-to-http2: OFF\n\nhosts:\n  \"127.0.0.1:80\":\n    listen:\n      port: 80\n    paths:\n      \"/\":\n        redirect:\n          status: 301\n          url: https://ib-staging.htdt.net/\n      \"/anim/arm.html\":\n        redirect:\n          status: 301\n          url: \"https://ib-staging.htdt.net/anatomy/nervous/arm-hand\"\n  \"127.0.0.1:443\":\n    listen:\n      port: 443\n      ssl:\n        key-file: /ssl.key\n        certificate-file: /ssl-certificate.pem\n    paths:\n      \"/\":\n        proxy.reverse.url: http://varnish:80/\n        proxy.preserve-host: ON\n        header.add: \"Access-Control-Allow-Origin:*\"\n\naccess-log: /var/run/h2o/access-log\nerror-log: /var/run/h2o/error-log\nhttp2-reprioritize-blocking-assets: ON   # performance tuning option\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/711/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "p30arena": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/697", "title": "Latency", "body": "@kazuho \nWhen I build simple.c with \n\n```\n-DH2O_USE_LIBUV=1\n```\n\nI see occasional **_4s to 6s**_ latency in the chunked-test.\nAnd it is **_before the handler callback**_ is called.\n\nEven worse the probability increases when I try to embed python.\nI initialize python in the main thread and use python functions in a worker thread, but the issue happens more.\n\nSample GET requests are:\n\nevery time I invoke these two, on the second one I have a lag of 5-6 seconds before the handler gets called.\n\n```\nhttp://192.168.182.139:8080/test/123124151231231231265\n```\n\nAND\n\n```\nhttp://192.168.182.139:8080/test\n```\n\nand the problem is repeatable when I reissue the second request.\n\nBesides that when I try to compile with h2o's event loop I get a tone of errors.\nIt seemed that I needed to \n\n```\n#include \"h2o/socket/evloop.h\"\n```\n\n but it had conflicts with other headers included.\nSo I went for g++ instead of gcc, because you've included the header in the case of \n\n```\n__cplusplus=1\n```\n\nbut it didn't solve the problem, now I face errors like\n\n```\nerror: \u2018h2o_evloop_socket_accept\u2019 was not declared in this scope\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/697/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/691", "title": "libh2o restricting file uploads", "body": "Hello, I'm working on a web application and using libh2o as the web application server.\n#92 #142 #574\n\n**UPDATE**\n1- How to manually restrict upload size in code?\n2- How to **reject a request** based on a condition before receiving the body, or before receiving the upload stream (after the header before the body) ?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/691/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "greatwar": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/687", "title": "add some free on ...dispose or destroy", "body": "1.   at config.c destroy_hostconf\n\n```\nfree(hostconf->paths.entries);\n```\n1.  at config.c h2o_config_dispose_pathconf\n   DESTROY_LIST(h2o_logger_t, pathconf->loggers);\n\n```\n    if (pathconf->path.base) {\n        free(pathconf->path.base);\n    }\n```\n# undef DESTROY_LIST\n1.   at multithread.c h2o_multithread_destroy_queue\n\n```\nfree(queue->async.read);\nfree(queue);\n```\n\ni am not sure i was right, thanks!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/687/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/51525148", "body": "thanks a lot\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/51525148/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}]}, "webhtb": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/677", "title": "Traffic shaping feature request", "body": "Hello,\n\nI request traffic shaping implementation for each vhost and.or connection from vhost or entire server like lighttpd https://redmine.lighttpd.net/projects/lighttpd/wiki/Docs_TrafficShaping\nNow i use webhtb for entire ip, but i need per connection, for .mp4 files, cant serve for each client entire free bandwidth.\n\nThankx in advance\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/677/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/636", "title": "Wrong choice certificate", "body": "Hi,\n\nI have configured two sites who contain in name word \"hotel\", each site have his own certificate, but, for the second site who contain \"hotel\", h2o serve me the certificate for first site in conf who contain \"hotel\" word in domain name.\n\nh2o version is 1.7.0-alpha1\n\nThanks\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/636/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/540", "title": "[lib/handler/fastcgi.c] in request:/index.php?action=getAllWithG...:I/O timeout", "body": "Hello, after this error, H2O server died, what is it about? Haw to fix this? Thanks in advance!\n\n[lib/handler/fastcgi.c] in request:/index.php?action=getAllWithG...:I/O timeout\nh2o: /root/h2o-1.5.0/lib/common/url.c:299: h2o_url_resolve: Assertion `base->path.base[0] == '/'' failed.\nreceived fatal signal 6; backtrace follows\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/540/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "ducthangho": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/671", "title": "Sendfile consideration", "body": " Hello.\nI am considering to use H2O or nginx as a reverse proxy for a map tile server. Basically, each tile is a png image of 256x256, which represent a small part of the map. There might be millions of those images, storing in a hierarchy of folders in the form of   \"z/x/y.png\" where z is the zoom level, x,y are the index of the tile.\n\nUsually when a user requests a tile, the web server will look to see if the corresponding png file exists, if it does, simply return it, otherwise, compute the image on-the-fly using mapnik. I would expect 90-95% would hit the cache (aka no computation needed). According to my understandings, nginx utilizes sendfile(), which is a zero-copy syscall, and H2o uses writev() to send static files like this. \n1. Do you think H2o has any advantages in my use cases. \n2. Why didn't you implement sendfile() in the first place\n3. What do you think of Facebook Proxygen vs H2o in terms of performance.\n\nMany thanks and looking forward to hearing from you\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/671/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "unixfox": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/663", "title": "Feature request: Logo", "body": "H2o should have a logo.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/663/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "WangWenchao": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/635", "title": "warning of \"failed to set TCP_FASTOPEN:Invalid argument\"", "body": "\u279c  ~  brew install  h2o\n==> Downloading https://homebrew.bintray.com/bottles/h2o-1.6.1.el_capitan.bottle.tar.gz\n###### ################################################################## 100.0%\n\n==> Pouring h2o-1.6.1.el_capitan.bottle.tar.gz\n==> Caveats\nA basic example configuration file has been placed in /usr/local/etc/h2o.\nYou can find fuller, unmodified examples here:\n  https://github.com/h2o/h2o/tree/master/examples/h2o\n\nTo have launchd start h2o at login:\n  ln -sfv /usr/local/opt/h2o/*.plist ~/Library/LaunchAgents\nThen to load h2o now:\n  launchctl load ~/Library/LaunchAgents/homebrew.mxcl.h2o.plist\nOr, if you don't want/need launchctl, you can just run:\n  h2o\n==> Summary\n\ud83c\udf7a  /usr/local/Cellar/h2o/1.6.1: 72 files, 3.3M\n\u279c  ~  h2o -c /usr/local/etc/h2o/h2o.conf\n[warning] failed to set TCP_FASTOPEN:Invalid argument\n[warning] failed to set TCP_FASTOPEN:Invalid argument\n[INFO] raised RLIMIT_NOFILE to 10240\nh2o server (pid:38314) is ready to serve requests\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/635/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "wangfakang": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/625", "title": "It's will have docker image?", "body": "@kazuho It's will have docker image for H2o? Thx.\n\nhost version: 1 CST 2014 x86_64 x86_64 x86_64 GNU/Linux.\n\nI have some problems at compile it:  and i have installed [libuv](https://github.com/libuv/libuv) but it's not ok. Please give me some tips thank you:\n\n```\n0> cmake -DWITH_BUNDLED_SSL=on .\n-- checking for module 'libuv>=1.0.0'\nsh: warning: setlocale: LC_ALL: cannot change locale (zh_CN.UTF-8)\n--   package 'libuv>=1.0.0' not found\n-- checking for module 'libwslay'\nsh: warning: setlocale: LC_ALL: cannot change locale (zh_CN.UTF-8)\n--   package 'libwslay' not found\n-- Could NOT find WSLAY (missing:  WSLAY_LIBRARIES WSLAY_INCLUDE_DIR) \n-- Configuring done\n-- Generating done\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/625/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/605", "title": "How to set h2o server non-keepalive ", "body": "hi , I have some question that h2o default keepalive, but how to set non-kepalive ?\nThank you. \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/605/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "heijiu": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/616", "title": "how to support Luajit", "body": "how to support Luajit like Nginx-module-lua\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/616/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "martell": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/609", "title": "http/2 client example", "body": "Hi @kazuho,\n\nI see a http1 client and a http/2 server but\nI just recently noticed there was no http/2 client example.\nWould you be able to create one easily?\n\nKind Regards\nMartell\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/609/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33452994", "body": "If you look a few lines above this is only relevant for the evloop implementation\n#if H2O_USE_LIBUV\n#else\n\nWith reguard to the evloop implementation I do need some advice here :)\nIn cloexec to setup fds[0] and fds[1] on windows we have to create the socket before hand\nThis means we need to know if it is tcp or udp a stream etc beforehand which I don't think we know at this point ?\nThis is done in the set_cloexec function\n\nI think I should focus on supporting doing 1 of the 2 first and not both at the same time.\nlibuv seemed like the easiest one as it already supports windows and mingw-w64.\nYour thoughts ?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33452994/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33453613", "body": "I think if we are only including this for structs and defines we may want to include the actual headers where they are implemented.\n\nhttp://pubs.opengroup.org/onlinepubs/009696899/basedefs/sys/select.h.html\nsys/types.h and time.h possibly\nWe can look at this later anyway it is not a big issue atm\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33453613/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33453644", "body": "I will remove the cast.\nI need to look at the differences between windows and unix headers closely here\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33453644/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33453690", "body": "On windows 0.0.0.0 is not a valid localhost or host name\nSo the default should be 127.0.0.1\nIf there is somewhere else in the code that can be changed to accommodate this we can move it :)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33453690/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33453719", "body": "Thank you for this I didn't spot this.\n\ndone: haven't pushed changes yet as we need to address all the issues\n\nnote: This might break or fix something because \nbecause we are now changing iovec's len from unsigned long to h2o_iovec_t's len which is size_t\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33453719/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33453724", "body": "Yes I agree this makes sense.\n\ndone: haven't pushed changes yet as we need to address all the issues\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33453724/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33453731", "body": "done: haven't pushed changes yet as we need to address all the issues\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33453731/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33464891", "body": "> So I think on Windows you would need to create a pair of TCP sockets connected to each other under my understanding that the HANDLEs created by CreatePipe cannot be passed to select.\n\nYes I did this yesterday evening using the socket function and making it a stream socket with ipv4 support and tcp but it didn't change much in that the in ev-loop mode example-httpclient hangs (still stuck in the loop)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33464891/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33467366", "body": "> I agree that porting the libuv-side would be faster, but if your intention is to make the H2O standalone server runnable on Windows, you would need to port evloop (and it seems like that you have already done that to some extent!).\n\nYes I started working on that because I couldn't get the examples that use libuv working :(\nI would like to get libh2o working first if possible because I want to create a few mockups with it.\n\nI still intend to get the full h2o package working on windows but I would like to focus on the lib aspect first.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33467366/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33471237", "body": "> To which part of the callbacks does the client proceed? exmaples/libh2o/http1client.c defines a number of callbacks that are called one by one. on_connect is called first, then on_head, and on_body. You could also set breakpoints to (or emit logs in) the callback functions within socketpool.c or http1client.c to determine which callbacks are called, and which are not.\n\nWhen using libuv on_connect is called and it doesn't complain and that comes from a call stack of\n\n1 on_connect\n2 call_connect_cb\n3 uv_process_tcp_connect_req\n4 uv_process_reqs\n5 uv_run\n\nthen after that it hits on_head and exits on line 108 after fprintf \"I/O timeout\"\n\nthe stack for this is\n\n1 on_head\n2 on_error_before_head\n3 h2o_timeout_run\n4 on_timeout\n\nAfter debugging in fiddler2 the http req debugger I can see that the http request is infact never made to argv[1] in my case hxxp://google.com (xx = tt)\n\nnow the only strange piece of code left is this\n/uv-binding.c.h:147:25: warning: passing argument 1 of 'dup' makes integer from pointer without a cast\n     if ((info->fd = dup(fd)) == -1)\n\nI tried using _get_osfhanle but it doesn't change anything :/\n\nI'm not quite sure whats going on here exactly.\nThe handle is being duplicated for some reason to hold on to after close ?\n\n> If your intention is to use libh2o, then you should better concentrate on libh2o and the examples under examples/libh2o. OTOH if your intention is porting the standalone server to Windows, I would suggest concentrating on evloop and then working on the libuv-side.\n\nI would like to get the lib working first, but I do intend to get the server working after that :)\n\n> Personally I did not expect somebody to start porting the standalone server to Windows, and am fascinated by how far you have achieved so far.\n\nSomeone was bound to try it sooner or later :D\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33471237/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}]}, "nifflerfox": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/592", "title": "How many platforms does h2o support?", "body": "I cannot find information about this.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/592/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "SamsudhinHabeeb": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/590", "title": "Error in .verify_dataxy", "body": "hi,\n\ni am a new user of h2o packages in r, i am facing problems while trying to train a model. kindly help on this issue.\nError in .verify_dataxy(training_frame, x, y, autoencoder) : \n  out of range explanatory variable\n\nThanks,\nSam\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/590/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "Cheedoong": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/577", "title": "H2O Listen Multiple Ports", "body": "Nginx has the capability to listen multiple ports (for a single server) by adding multiple \"listen\" configuration lines. \nWill H2O add similar feature? \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/577/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "Thalak": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/572", "title": "send websocket-messages after leave of the cbf on_ws_message()   (asynchronous)", "body": "Hi,\n\nif I send websocket frames similar to your example:\n\n```\nstatic void on_ws_message(h2o_websocket_conn_t *conn, const struct wslay_event_on_msg_recv_arg *arg)\n{\n    if (arg == NULL) {\n        h2o_websocket_close(conn);\n        return;\n    }\n\n    if (!wslay_is_ctrl_frame(arg->opcode)) {\n        struct wslay_event_msg msgarg = {arg->opcode, arg->msg, arg->msg_length};\n        wslay_event_queue_msg(conn->ws_ctx, &msgarg);\n    }\n}\n```\n\nit's working fine. The webssocket-recv-cbf and the messages send are synchronously\nbecause with leave of  on_ws_message() you call finally the methode:\n\n```\nh2o_websocket_proceed(conn);\n```\n\nwhere you call inside \n\n```\nwslay_event_send(conn->ws_ctx)\n```\n\nto send the queued data before.\n\nBut I have to send messages after I have left this function and after you have called  h2o_websocket_proceed(conn).\n\nBut If I try to call  'h2o_websocket_proceed(conn)' by my own with the same connection 'conn', gotten by the call of  'on_ws_message()', I get a error with a proken pipe in stream.c at \n\n```\nn = write(uv__stream_fd(stream), iov[0].iov_base, iov[0].iov_len);\n```\n\nThere seems some dependency between h2o, libuv and wslay. \n\nDo you know how can I send websocket-messages asynchronous to on_ws_message() with the same websocket connection (channel)?\n\nThanks\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/572/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/507", "title": "h2o_file_register issue at a GET root ('/') request by the Client", "body": "h2o_file_register issue at a GET root ('/') request by the Client\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/507/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/481", "title": "Copy of the whole client connection structure at a request necessary to save the connection?", "body": "Hi,\nI want to hold the request by a client when I get a request in my callback function:\n\n```\n    int HttpAppServer::OnRequest(h2o_handler_t *self, h2o_req_t *req)\n    {\n           ...\n          parsedUrl();\n          ...\n          if(m_pCallback != NULL)\n          {\n              m_pCallback->AppRequestReceived(parsedUrl);\n          }\n          ...\n          //copy 'req' to my own structure before leave the function(?)\n    }\n```\n\nBecause I have to call in this callback above a other own callback function (AppRequestReceived() ) to a other thread who is offering the data for the request. While this time (less mseconds e.g.) the connection to the client keeps open. \n\nHow can I save the open client-connection until my other thread has processed the data for the response?\n\nIt is necessary to copy the whole h2o_req_t *req structure to save the connection to the client or can you tell me which parameters of the h2o_req_t structure are only necessary to save?\n\nThanks\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/481/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/455", "title": "With use of libh2o library how can I configure a path for the file-content (assets) for the server?", "body": "Hi,\n\nI'am using the to libh2o library. And i't works so fare if I handle e.g. a 'Get' Request by the client in my request callback funktion where I'am have to response.\n\nBut I have also some fix html-content to offer for a client. How and where must I configure the libh2o- server to offer the client the content e.g. /root/server_files/ ... index.html .... and so on?\n\nI would expect I can use a own Port and handover the content-path to the server-setup and it is done.\nIf a client is calling to this address or path to the content, the server offers directly the content.\n\nWith the stand alone h2o server we have a config-file where we can set-up the path and hand over this config-file to the server. Then we start the server and finish. If a client is calling the path or address die server is responding to this path. \n\nlike this ---> https://h2o.examp1e.net/configure/base_directives.html\n\nBut what must I do for this same behavior if I use the  libh2o library?\n\nThanks and Regards,\nThalak\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/455/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "stetsonsarecool": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/566", "title": "POST labeled as GET when trailing / is added", "body": "When I register a handler for some path /myTestPath, and if I do a POST with data in the body to that path, in the h2o_req_t object, I see the path is changed to /myTestPath/ with a trailing slash and the method as a GET with an entity of NULL.\n\nIf, however, I do the same POST to /myTestPath/, I see the request object's method correctly as a POST and I see the data in the entity.\n\nI am using H2O version: h2o/1.2.1-alpha1.\n\nDo you know what might be causing this issue?\n\nThanks in advance!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/566/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "scottjehl": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/559", "title": "Rack interface with proxy?", "body": "I expected the following to work but it does not appear to set any link headers in the final response:\n\n```\npaths:\n      /:\n        proxy.reverse.url: \"http://mywebsite.com/\"\n        mruby.handler: |\n          Proc.new do |env|\n            push_paths = []\n            if env[\"PATH_INFO\"] == \"/\"\n              push_paths << \"/css/dist/all.css\"\n            end\n            [399, push_paths.empty? ? {} : {\"link\" => push_paths.map{|p| \"<#{p}>; rel=preload\"}.join(\"\\n\")}, []]\n          end\n```\n\nDoes mruby work in addition to proxy or only with file.dir?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/559/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/558", "title": "Detecting http/1.1 or http/2 in a proxied environment", "body": "I'm running h2o as a proxy over php and apache. Is there a way, from PHP, to detect whether the h2o session is http1.1 or http/2 ? I was hoping to use an mruby handler to send some session information to the proxy url (via headers) but nothing seems to show up in the PHP request headers. For example, this header doesn't pass through to PHP:\n\n```\n        mruby.handler: |\n          Proc.new do |env|\n            [399, {'foo' => 'bar'}, []]\n          end\n        proxy.reverse.url: \"http://mytesturl.com\"\n```\n\nIdeally, I'd like to have some logic in the PHP that either inlines or references resources depending on whether server push is available, so knowing the session type would be very helpful.\n\nThanks.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/558/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/557", "title": "Proxy with server push", "body": "I'm running h2o as a proxy on top of an apache + php site and I ran into a problem. \n\nI'm able to set link preload response headers on my html files using either php or apache (via htaccess) and can verify that they pass through to the client. However, h2 is not server-pushing the assets referenced in the headers. The h2o docs say that server-push will work when link preload headers are set via mruby, proxy, or fastcgi, and I was able to verify that server push does indeed work when I set the headers with mruby (and use a `file.dir` instead of proxy). \n\nMy configuration on the proxied server looks like this:\n\nApache:\n\n```\n<Files ~ \"\\.(html)$\">\nHeader set link \"</css/dist/all.css>; rel=preload; as=stylesheet\"\n</Files>\n```\n\nIn my browser's devtools, I can see that the header is there for that html file, but the css file it references just loads normally without a x-http2-push header. Any suggestions would be great.\n\nThanks!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/557/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "bitbeans": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/555", "title": "Verify client certificates", "body": "Is there an equivalent of:\n- ssl_verify_client on; (nginx)\n- ssl_verify_depth 2; (nginx)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/555/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "psychoss": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/546", "title": "is h2o support something like \"try_files\"?", "body": "hi,is h2o support something like \"try_files\"? i'd like to check first whether the static file is exsit. if not, proxy the request to upstream server,sorry, the english is not my mother language. \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/546/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "mohdalif": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/544", "title": "h2o segmentation fault on Alpine", "body": "hi, h2o crashed a few times on Alpine linux but can not get the trace on frame 0 maybe because of other shared library?\n\n```\n~ $ h2o -v\nh2o version 1.5.0\nOpenSSL: OpenSSL 1.0.2d 9 Jul 2015\nmruby: YES\n```\n\n```\n(gdb) bt full\n#0  0x00007ff66fe2e550 in ?? ()\nNo symbol table info available.\n#1  0x00007ff66cd254de in close_generator_and_filters (req=req@entry=0x7ff66fe2e658) at /tmp/h2o/lib/core/request.c:150\nNo locals.\n#2  0x00007ff66cd2677f in h2o_reprocess_request (req=0x7ff66fe2e658, method=..., scheme=0x7ff66d0aea10 <H2O_URL_SCHEME_HTTPS>, authority=..., path=..., overrides=0x0, \n    is_delegated=1) at /tmp/h2o/lib/core/request.c:225\n        hostconf = <optimized out>\n#3  0x00007ff66cd26963 in on_reprocess_request_cb (entry=<optimized out>) at /tmp/h2o/lib/core/request.c:273\n        args = <optimized out>\n#4  0x00007ff66cd1f9b6 in h2o_timeout_run (loop=loop@entry=0x7ff66e1eb4a0, timeout=timeout@entry=0x7ffe882cede0, now=<optimized out>)\n    at /tmp/h2o/lib/common/timeout.c:35\n        entry = <optimized out>\n        max_registered_at = <optimized out>\n#5  0x00007ff66cd1d050 in h2o_evloop_run (loop=0x7ff66e1eb4a0) at /tmp/h2o/lib/common/socket/evloop.c.h:509\n        timeout = 0x7ffe882cede0\n        node = 0x7ffe882cede8\n        __func__ = \"h2o_evloop_run\"\n#6  0x00007ff66cd5a02a in run_loop (_thread_index=0x0) at /tmp/h2o/src/main.c:1263\n        thread_index = 0\n        listeners = 0x7ffe882ceca0\n        i = <optimized out>\n#7  0x00007ff66cd14c85 in main (argc=<optimized out>, argv=<optimized out>) at /tmp/h2o/src/main.c:1675\n        cmd = <optimized out>\n        opt_config_file = <optimized out>\n        error_log_fd = <optimized out>\n        __func__ = \"main\"\n        i = 1\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/544/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/420", "title": "how to custom error page", "body": "possible to redirect to custom error page e.g: 404 ?\n\nexample from nginx:\nerror_page   404  =  /404.html\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/420/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "guilhem": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/541", "title": "Add support for configuration from a distributed key-value store", "body": "H2O is really lovely to use and configure.\nBut what can make it really powerful to maintain and deploy is to be able to use a distributed key/value store like `etcd` or `consul`.\n\nI mainly have `etcd` in mind who is embedded in `coreos` and really easy to use, but it's not the only solution.\n\nI think H2O configuration is already \"k/v ready\" and can be really easily put in a distributed k/v store.\n\nOptionally we can also put a trigger to reload service on configuration change (with a \"watch\").\n\nSomething helpful to configure service would be some environment variables. For example:\n\n`H2O_CONFIGURATION_STORE` (to configure file or etcd, this can be an URI)\n`H2O_ETCD_USER`\netc\n\nWhat are you thinking about it?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/541/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "marhag87": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/536", "title": "Soname version libh2o-evloop.so", "body": "I'm currently looking into packaging h2o for fedora and came across the following problem: https://fedoraproject.org/wiki/Packaging:Guidelines#Downstream_.so_name_versioning\nPlease consider setting a soname version for /usr/lib/libh2o-evloop.so:\nhttp://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/536/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "diecyde": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/524", "title": "accept4 not allways inplemented on systems", "body": "I found that accept4 is not always implemented in all libraries and kernels.\nIn some implementations this function is stubbed and will return -1 always.\nThus rendering the webserver unreachable.\nUncommenting the **linux** define is not directly an option.\nSo I ifdeffed an normal accept into the code.\n\nBefore I commit this patch,  I would like to ask if maybe we could just replace accept4 with accept and fcntl ?\nOr is there a good reason to stick with accept4?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/524/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/1437", "title": "h2o websockets module proxy to TCP/UNIX socket", "body": "relates to : https://github.com/h2o/h2o/issues/1435\r\nI finally managed to do it the proper way through github, I was unable to do the pull request before.\r\nPlease feel free to close the ticket\r\n\r\nI have created an new module for H2o, this module upgrades calls to\r\nconfigured directories to websockets.\r\nAfter upgrading it connects to an specified tcp/unix socket.\r\nThis functionality is much like what is already supported by lighttpd.\r\n\r\nAll framing needs to be handled by the party which accepts the socket.\r\nThe module is based on the fcgi module source code, and I tried to\r\noptimize it as much possible.\r\n\r\n**Configuration**\r\nI have embedded 2 configuration parameters:\r\n\r\nwebsocket.connect:\r\nregisters an tcp or unix endpoint to make the connection to (adopted\r\nfrom fcgi)\r\n\r\nwebsocket.accept_protocol:\r\noptional: specifies which protocol should be accepted\r\n\r\nAn example configuration:\r\n\r\n> \"/ws\":\r\n> websocket.connect:\r\n> port: /tmp/ws.socket\r\n> type: unix\r\n\r\nPlease review my code and feel free to optimize or modify my patch it in\r\nany way.\r\nI really feel this module will up the ante for this awesome webserver.", "author_association": "NONE"}], "issue_comments": [], "commit_comments": [], "review_comments": []}, "paravoid": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/523", "title": "Coordinated ticket master key rotation in a cluster of h2os", "body": "I just discovered H2O -because of neverbleed making the rounds- and it seems like an impressive project, containing all the right and exciting keywords right on its homepage. Kudos!\n\nI was delighted to see that someone has actually built a TLS terminator that properly supports shared session keys and tickets in a memcached store and on top actually rotates those tickets for PFS! I'd be curious to see of the performance impact of using memcached for this, btw.\n\nHowever, while all the building blocks are there, there doesn't seem to be an easy way to run multiple `h2o`s in different servers (or even the same server, with `SO_REUSEPORT`) and have them all use the memcached store for both the session cache and the ticket master key. The former appears like it would work, but the latter has the problem that, to my understanding, all of those different servers will attempt to rotate keys on their own, at roughly the same or overlapping times, clashing with each other. It's a shame, since this work is //almost// there \u2014 that said, properly coordinating this over a distributed cluster won't be trivial\u2026 perhaps memcached's CAS operations would help.\n\nBesides this, there might be other issues that I haven't thought of; it'd be nice to get some confirmation that such a clustered configuration is indeed possible and supported.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/523/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "JohnPittman": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/512", "title": "Double OCSP request on server start?", "body": "Is there supposed to be 2 OCSP requests for SSL cert validation? \nThis is directly from the console of my ec2 instance:\n\n[INFO] raised RLIMIT_NOFILE to 1048576\nh2o server (pid:1) is ready to serve requests\nfetch-ocsp-response (using OpenSSL 1.0.2d 9 Jul 2015)\nfetch-ocsp-response (using OpenSSL 1.0.2d 9 Jul 2015)\nsending OCSP request to http://ocsp.startssl.com/sub/class1/server/ca\nsending OCSP request to http://ocsp.startssl.com/sub/class1/server/ca\n/etc/ssl/chickendinosaur-chain.crt: good\n        This Update: Sep 16 03:51:23 2015 GMT\n        Next Update: Sep 18 03:51:23 2015 GMT\nverifying the response signature\nverify OK (used: -VAfile /tmp/_s4JJmpBc9/issuer.crt)\n[OCSP Stapling] successfully updated the response for certificate file:/etc/ssl/chickendinosaur-chain.crt\n/etc/ssl/chickendinosaur-chain.crt: good\n        This Update: Sep 16 04:23:16 2015 GMT\n        Next Update: Sep 18 04:23:16 2015 GMT\nverifying the response signature\nverify OK (used: -VAfile /tmp/2MguISHG5v/issuer.crt)\n[OCSP Stapling] successfully updated the response for certificate file:/etc/ssl/chickendinosaur-chain.crt\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/512/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/480", "title": "SSL --issuer option", "body": "Hey again,\n\nSo I'm using a certificate I got form StartSSL and am getting this message on load:\n\n--issuer option was not used, and failed to extract issuer certificate from the certificate\n\nCan't find anything on the configure section of the site cert issuer options. Learn me on this?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/480/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/476", "title": "package 'libmruby' not found but says Found MRUBY - Driving me bananas!", "body": "Finally broke down and have to post install issue. Everything thing else installs fine for h2o. The last installation error that i have is package 'libmruby' not found as seen below:\n\nchecking for module 'libuv>=1.0.0'\n--   found libuv, version 1.7.3\n-- checking for module 'libwslay'\n--   found libwslay, version 1.0.1-DEV\n-- checking for module 'libmruby'\n--   package 'libmruby' not found\n-- Found MRUBY: /usr/lib/libmruby.a  \n\nI install libmruby-dev and then compile/install mruby from https://github.com/mruby/mruby so I don't know what else to do here. Here is my build script for the mruby section:\n# All installs for the entire build\n\napt-get update && apt-get install -y wget git-core \\\n build-essential cmake libssl-dev zlib1g-dev libtool autoconf pkg-config python-sphinx bison ruby libmruby-dev\n# mruby\n\ncd /tmp \\\n && git clone https://github.com/mruby/mruby \\\n&& cd mruby \\\n&& ruby ./minirake\n\nHere's the h2o section in case you see something here:\n# h2o\n\ncd /tmp && \ngit clone https://github.com/h2o/h2o && \ncd h2o && \n\ncmake -DCMAKE_INSTALL_PREFIX=/usr/local -DCMAKE_C_FLAGS=\"-Wall -O2 -fstack-protector-all -D_FORTIFY_SOURCE=2 -Wformat -Werror=format-security -fvisibility=hidden\" . && make && make install\n\nTrying my best to get this process stable so I can start shipping some website with the best web server on the net! Thanks for the hard work so us coders can deliver our art as fast as possible to as many people as possible around the globe.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/476/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "HLFH": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/473", "title": "Let's Encrypt support", "body": "Hi,\n\nWe should support [Let's Encrypt](https://github.com/letsencrypt/letsencrypt). Let's Encrypt client supports plugin infrastructure: https://letsencrypt.readthedocs.org/en/latest/plugins.html\n\nThanks in advance,\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/473/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "negima1976": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/456", "title": "It is an error to the SSL connection", "body": "## \u25a0Environment\n\nOS: CentOS 6.7(x86_64)\nkernel: 2.6.32-573.3.1.el6.x86_64\nh2o: 1.4.4\nopenssl: 1.0.1e\n## \u25a0h2o cmake option\n\ncmake -DWITH_BUNDLED_SSL=on\n## \u25a0h2o config\n\nuser: nobody\nlisten:\n  port: 80\n  host: 0.0.0.0\n\nlisten:\n  port: 443\n  host: 0.0.0.0\n  ssl:\n    key-file: /etc/pki/tls/private/server.key\n    certificate-file: /etc/pki/tls/certs/server.pem\n\nmax-connections: 1024\n\nfile.index: ['index.php', 'index.html']\nfile.send-gzip: ON\nfile.etag: OFF\nexpires: 1 day\n\nhosts:\n  \"hogehoge.com:80\":\n    paths:\n      /:\n        redirect: https://hogehoge.com/\n\n  \"hogehoge.com:443\":\n    paths:\n      /:\n        file.dir: /path/wordpress\n        file.dirlisting: OFF\n        redirect:\n          url: /index.php/\n          internal: YES\n          status: 307\n\nfile.custom-handler:\n  extension: .php\n  fastcgi.connect:\n    port: /var/run/php-fpm/php-fpm.sock\n    type: unix\n\naccess-log: \"| exec rotatelogs /var/log/h2o/access.log.%Y%m%d 86400\"\nerror-log:  \"| exec rotatelogs /var/log/h2o/error.log.%Y%m%d 86400\"\npid-file: /var/run/h2o.pid\nhttp2-reprioritize-blocking-assets: ON\n\nheader.unset: \"X-Powered-By\"\nheader.set: \"X-Content-Type-Options: nosniff\"\n## \u25a0 configration test\n\n``` bash\nh2o -c /etc/h2o/h2ossl.conf -t\nEnter PEM pass phrase:\n[OCSP Stapling] testing for certificate file:/etc/pki/tls/certs/server.pem\nfetch-ocsp-response (using OpenSSL 1.0.1e-fips 11 Feb 2013)\nsending OCSP request to http://gv.symcd.com\n/etc/pki/tls/certs/server.pem: good\n    This Update: Aug 19 01:02:14 2015 GMT\n    Next Update: Aug 26 01:02:14 2015 GMT\nverifying the response signature\nverify OK (used: -VAfile /tmp/MLclhcdAt8/issuer.crt)\n[OCSP Stapling] stapling works for file:/etc/pki/tls/certs/server.pem\nEnter PEM pass phrase:\n[OCSP Stapling] testing for certificate file:/etc/pki/tls/certs/server.pem\nfetch-ocsp-response (using OpenSSL 1.0.1e-fips 11 Feb 2013)\nsending OCSP request to http://gv.symcd.com\n/etc/pki/tls/certs/server.pem: good\n    This Update: Aug 19 01:02:14 2015 GMT\n    Next Update: Aug 26 01:02:14 2015 GMT\nverifying the response signature\nverify OK (used: -VAfile /tmp/U_ABtoqx2R/issuer.crt)\n[OCSP Stapling] stapling works for file:/etc/pki/tls/certs/server.pem\nconfiguration OK\n```\n## \u25a0h2o error.log\n\n``` bash\nstarting new worker 11524\nEnter PEM pass phrase:\n[/etc/h2o/h2ossl.conf:10] in command listen, failed to load private key file:/etc/pki/tls/private/server.key\n\n139901539391392:error:0906406D:PEM routines:PEM_def_callback:problems getting password:pem/pem_lib.c:116:\n139901539391392:error:0906A068:PEM routines:PEM_do_header:bad password read:pem/pem_lib.c:467:\n139901539391392:error:140B0009:SSL routines:SSL_CTX_use_PrivateKey_file:PEM lib:ssl_rsa.c:613:\nnew worker 11524 seems to have failed to start, exit status:19968\nstarting new worker 11525\nEnter PEM pass phrase:\n[/etc/h2o/h2ossl.conf:10] in command listen, failed to load private key file:/etc/pki/tls/private/server.key\n\n140023512741792:error:0906406D:PEM routines:PEM_def_callback:problems getting password:pem/pem_lib.c:116:\n140023512741792:error:0906A068:PEM routines:PEM_do_header:bad password read:pem/pem_lib.c:467:\n140023512741792:error:140B0009:SSL routines:SSL_CTX_use_PrivateKey_file:PEM lib:ssl_rsa.c:613:\nnew worker 11525 seems to have failed to start, exit status:19968\nstarting new worker 11527\nEnter PEM pass phrase:\n[/etc/h2o/h2ossl.conf:10] in command listen, failed to load private key file:/etc/pki/tls/private/server.key\n\n139798662301600:error:0906406D:PEM routines:PEM_def_callback:problems getting password:pem/pem_lib.c:116:\n139798662301600:error:0906A068:PEM routines:PEM_do_header:bad password read:pem/pem_lib.c:467:\n139798662301600:error:140B0009:SSL routines:SSL_CTX_use_PrivateKey_file:PEM lib:ssl_rsa.c:613:\nnew worker 11527 seems to have failed to start, exit status:19968\nstarting new worker 11536\nEnter PEM pass phrase:\n[/etc/h2o/h2ossl.conf:10] in command listen, failed to load private key file:/etc/pki/tls/private/server.key\n\n140685311305632:error:0906406D:PEM routines:PEM_def_callback:problems getting password:pem/pem_lib.c:116:\n140685311305632:error:0906A068:PEM routines:PEM_do_header:bad password read:pem/pem_lib.c:467:\n140685311305632:error:140B0009:SSL routines:SSL_CTX_use_PrivateKey_file:PEM lib:ssl_rsa.c:613:\nnew worker 11536 seems to have failed to start, exit status:19968\nstarting new worker 11537\nEnter PEM pass phrase:\n```\n\nThe nginx 's and is working without problems .\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/456/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "gschlager": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/448", "title": "Add support for signed_certificate_timestamp TLS extension", "body": "This is needed in order to support [Certificate Transparency](http://www.certificate-transparency.org/how-ct-works).\n\nnginx already has a module for this: https://github.com/grahamedgecombe/nginx-ct\n[ct-submit](https://github.com/grahamedgecombe/ct-submit) can be used to submit a certificate to the log servers.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/448/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "hjf288": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/422", "title": "PHP  config with Fallback to 404?", "body": "Hi,\n\nWith the current implementation, if you want to use the example provided below:\n\n```\n    paths:\n      \"/\":\n        file.dir: /path/to/doc-root   # serve static files if found\n        redirect:                     # if not found, internally redirect to /index.php/<path>\n          url: /index.php/\n          internal: YES\n          status: 307\n```\n\nEvery non existent asset will be sent to the index, it would be great to pass dynamic requests to PHP while requests to other assets such as static assets are served with a 404.\n\nMaybe a list of extensions that are static could/should be defined so the server can return static error pages without being redirected.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/422/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "alairs": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/419", "title": "access forbidden error", "body": "### My h2o.conf\n\nhosts:\n  \"res.ltecn.com\":\n    listen:\n      port: 80\n    paths:\n      \"/\":\n        file.dir: /root/res/\naccess-log: /root/h2olog/access-log\nerror-log: /root/h2olog/error-log\n# pid-file: /root/h2olog/pid-file\n\nhttp2-reprioritize-blocking-assets: ON   # performance tuning option\n\nthe file dir\n\nroot@bwgvps:~/res# ls -lh\ntotal 3.3M\n-rw-r--r--  1 root root  18K Jul 22 04:26 FileZilla.xml\ndrwxr-xr-x  4 root root 4.0K Jul 22 09:29 Font-Awesome-3.2.1\ndrwxr-xr-x  2 root root 4.0K Jul 21 23:53 Heart_Sutra\ndrwxr-xr-x  2 root root 4.0K Jul 21 23:54 KoreanEnt\ndrwxr-xr-x 16 root root 4.0K Jul 21 23:54 LFS-BOOK-7.7-systemd\n-rw-r--r--  1 root root  13K Jul 22 04:26 LTE_Bands_LTE_Frequency.htm\ndrwxr-xr-x  3 root root 4.0K Jul 21 23:54 alinstall\ndrwxr-xr-x  2 root root 4.0K Jul 21 23:56 apks\ndrwxr-xr-x  5 root root 4.0K Jul 21 23:52 bootstrap-3.3.5-dis\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/419/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "KyleSanderson": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/401", "title": "Native CGI without using libh2o", "body": "Hi Kazuho,\n\nIs there any way presently to natively compile C code on the fly (kind of how G-Wan is setup http://gwan.ch )? At the moment it looks like I need to ship compiled webpages (binaries) with libh2o to accomplish this. Any guidance would be appreciated.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/401/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "wmertens": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/392", "title": "Different path for http2", "body": "If you could send a different index.html for http2, you'd be able to have http1 optimized html with inclining etc and http2 optimized html with server push...\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/392/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "admogh": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/372", "title": "\"failed to spawn\" if /usr/local/share/h2o/start_server does not exist.", "body": "I found In case the mode option is _daemon_.\n\n```\n:/usr/local/src/h2o# lsb_release -a\nNo LSB modules are available.\nDistributor ID: Ubuntu\nDescription:    Ubuntu 14.10\nRelease:        14.10\nCodename:       utopic\n:/usr/local/src/h2o# ./h2o -v\nh2o version 1.3.1\n:/usr/local/src/h2o# ./h2o -c ./h2o.conf -m daemon\nfailed to spawn /usr/local/share/h2o/start_server:No such file or directory\n:/usr/local/src/h2o# ln -s /usr/local/src/h2o/share/h2o /usr/local/share/h2o\n:/usr/local/src/h2o# ./h2o -c ./h2o.conf -m daemon\nstart_server (pid:2881) starting now...\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/372/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "qgy18": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/355", "title": "Server push and browser cache", "body": "I am using h2o as my HTTP/2 server, and use 'Link header' for server push css file, like this:\n\n> link: </static/css/theme/greyshade_50d9a.css>; rel=preload; as=stylesheet\n\nEverything is ok when visit the page first time. After first visiting, this css file has been cached in browser.\n\nAnd visit the page next time, there will be a 'HTTP2_SESSION_SEND_RST_STREAM' sending by browser after 'HTTP2_SESSION_RECV_PUSH_PROMISE', because of the browser have cached the pushing file.\n\nMy confusion is : Why there still have 'HTTP2_SESSION_RECV_HEADERS' and 'HTTP2_SESSION_RECV_DATA' after RST steam?\n\nInformation from 'chrome://net-internals/#events':\n\n```\nt= 4914 [st=  118]  HTTP2_SESSION_RECV_PUSH_PROMISE\n                    --> :authority: www.imququ.com\n                        :method: GET\n                        :path: /static/css/theme/greyshade_50d9a.css\n                        :scheme: https\n                        accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\n                        accept-encoding: gzip, deflate, sdch\n                        accept-language: zh-CN,zh;q=0.8,en;q=0.6,en-US;q=0.4,ja;q=0.2,de;q=0.2,zh-TW;q=0.2,cs;q=0.2,pt;q=0.2,ko;q=0.2\n                        user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.65 Safari/537.36\n                    --> id = 5\n                    --> promised_stream_id = 6\nt= 4914 [st=  118]  HTTP2_SESSION_SEND_RST_STREAM\n                    --> description = \"Received duplicate pushed stream with url: https://www.imququ.com/static/css/theme/greyshade_50d9a.css\"\n                    --> status = 1\n                    --> stream_id = 6\nt= 4914 [st=  118]  HTTP2_SESSION_RECV_DATA\n                    --> fin = false\n                    --> size = 690\n                    --> stream_id = 5\nt= 4915 [st=  119]  HTTP2_SESSION_RECV_DATA\n                    --> fin = false\n                    --> size = 4200\n                    --> stream_id = 5\nt= 4915 [st=  119]  HTTP2_SESSION_RECV_DATA\n                    --> fin = false\n                    --> size = 1447\n                    --> stream_id = 5\nt= 4915 [st=  119]  HTTP2_SESSION_RECV_DATA\n                    --> fin = true\n                    --> size = 0\n                    --> stream_id = 5\nt= 4915 [st=  119]  HTTP2_SESSION_RECV_HEADERS\n                    --> fin = false\n                    --> :status: 200\n                        cache-control: max-age=315360000\n                        content-encoding: gzip\n                        content-type: text/css\n                        date: Sat, 06 Jun 2015 17:48:33 GMT\n                        etag: W/\"5572e176-3ce9\"\n                        expires: Thu, 31 Dec 2037 23:55:55 GMT\n                        last-modified: Sat, 06 Jun 2015 12:03:02 GMT\n                        server: h2o/1.2.1-alpha1\n                        vary: Accept-Encoding\n                        x-http2-pushed: 1\n                    --> stream_id = 6\nt= 4915 [st=  119]  HTTP2_SESSION_RECV_DATA\n                    --> fin = false\n                    --> size = 1276\n                    --> stream_id = 6\nt= 4915 [st=  119]  HTTP2_SESSION_RECV_DATA\n                    --> fin = false\n                    --> size = 1400\n                    --> stream_id = 6\n... ...\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/355/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "anchor00": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/354", "title": "How can I use LibreSSL instead of OpenSSL with libh2o", "body": "Hello,\nHow can I switch to LibreSSL if I use h2o as a library? or do I need to change the project settings before compiling it?\nThanks,\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/354/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/351", "title": "Any callback for handler to pass the path to the handler in register_handler ", "body": "Hello,\nI want to get the \"path\" in the register_handler (the 2nd parameter) when the server received the event and pass it to the handler. I am thinking the handler will has switch statements and switch to different codes base on the \"path\". Is it a way to accept it?\n\nstatic h2o_pathconf_t _register_handler(h2o_hostconf_t *hostconf, const char *path, int (_on_req)(h2o_handler_t *, h2o_req_t *))\n\nIn summary, is it a way that the handler know what is \"path\"?\nThanks\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/351/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "ahjin": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/347", "title": "cmake: relocation error: /usr/lib/x86_64-linux-gnu/libcurl.so.4: symbol SSL_CTX_set_srp_password, version OPENSSL_1.0.1 not defined in file libssl.so.1.0.0 with link time reference", "body": "I do:\ncmake -DCMAKE_INSTALL_PREFIX=/usr/local/h2o -DOPENSSL_LIBRARIES='/usr/local/ssl/lib/libssl.so;/usr/local/ssl/lib/libcrypto.so' -DOPENSSL_INCLUDE_DIR=/usr/local/ssl/include/\n\nsystem return:\ncmake: relocation error: /usr/lib/x86_64-linux-gnu/libcurl.so.4: symbol SSL_CTX_set_srp_password, version OPENSSL_1.0.1 not defined in file libssl.so.1.0.0 with link time reference\n\nHow can I do it? Can you help me?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/347/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "gaoyichuan": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/339", "title": "When for fastcgi?", "body": "I'd like to run a php application, but now h2o doesn't support fastcgi, and I don't want to use nginx or apache in the background. So when will fastcgi be supported?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/339/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/14262265", "body": "You forgot to change the comment on line 52. :)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/14262265/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "review_comments": []}, "aguai": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/338", "title": "binding to python and golang???", "body": "is there any guide to run python or golang application on h2o???\nor any resource??\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/338/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "nijx": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/334", "title": "h2o client HTTP2/HTTP1.X ", "body": "I have found h2o very useful, I'm testing it out yet i had review that in your examples directory the http1client, and while i'm coding a simple client the library contains mixed c coding content with server side functions inside c source and header files if you could outline in a \"diff\" what are client's side includes and files for HTTP2 and HTTP1.X clients i would focus more on client side rather then server.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/334/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "TimSylvester": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/329", "title": "Windows / Visual Studio support", "body": "Libh2o looks like it would be very useful to me, but I would need to be able to build it for Windows platforms with Visual Studio 2012+.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/329/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "StefanoDeVuono": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/326", "title": "Serve single page apps", "body": "There should be an option under the `path` directive to serve any route or a series or routes so that a client-side single-page app can handle routing. This will dovetail particularly well with HTTP/2, since single-page apps can make great use of features like eager loading of the app through multiplexed requests and partial updates through server pushes.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/326/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "shivajivarma": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/325", "title": "Website design improvisation", "body": "I believe it would be great if website (https://h2o.github.io/index.html) design is improvised using any of open source html framework works like bootstrap, boilerplate etc.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/325/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "pokey": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/320", "title": "Notification of client closing connection in http1", "body": "I noticed that if the client closes the connection while waiting for a response from the server, there is no mechanism by which the request handler on the server is notified.  Is there some reasoning behind this?  I would think that `req->_generator->stop` would be called in this case.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/320/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/319", "title": "Semantics of generator.stop", "body": "Is it accurate to say that in the case that after a request handler has called `h2o_start_response` with a non-null generator, then `req->_generator->stop` will be called if and only if the request is terminated before the request handler calls `h2o_send(..., 1)`?  \n\nFor context, I am implementing long-polling using libh2o.  I set a timeout to send an empty response if there is no new data after 55 seconds.  I would like to be sure that I always cancel the timer before the memory pool for the request is freed.  That way, I can safely allocate the timer on the memory pool for the request.  It seems that if I call `h2o_start_response` to set a `stop` callback, and also make sure to teardown the timer myself before calling `h2o_send(..., 1)`, then I should be guaranteed that my timer will always be cancelled before the request's memory pool is freed.  Correct?\n\nOn a related note, I assume it is fine in this case to set the `proceed` callback to be an empty function, since I plan to send all my data at once, and I am only interested in being notified when the request is terminated. \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/319/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/318", "title": "on_generator_dispose vs do_close in lib/core/proxy.c", "body": "In proxy.c, it seems that both `on_generator_dispose` and `do_close` will be called whenever a request is finished.  Is this not the case?  If so, why are both functions used?  \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/318/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/317", "title": "Why doesn't h2o_mem_alloc_shared allocate from the pool?", "body": "I noticed that `h2o_mem_alloc_shared` uses `h2o_mem_alloc` to allocate memory, instead of `h2o_mem_alloc_pool`.  Is there a reason for this?  I'd like to allocate memory from a pool, and get notified when the memory is about to be freed.  \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/317/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/310", "title": "Use of do_proceed in proxy.c", "body": "It seems that two different events can trigger a call to `do_send` in proxy.c: the http client calling `on_body`, or the output stream calling `on_proceed`.  If I'm understanding correctly, `on_proceed` allows the output socket to ask for new data from the proxy.  If the upstream server is sending data in chunks, then the available chunks of data are taken off of the socket and sent downstream.  On the other hand, once the body has fully arrived from the upstream server, the proxy code will initiate its own send operation to send the remaining data downstream.  Is this correct?  Ie, if there were no such thing as the upstream sending data in chunks, then you could just use a `{NULL, NULL}` generator and wait for http1client to call `on_body`, correct?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/310/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/309", "title": "pull vs send when implementing request handler", "body": "I'm trying to understand the differences between pull and send when implementing a request handler.  In both cases, it seems that the ostream that we're writing to asks for new data when it's ready.  The only difference I can tell is who owns the output iovec(s).  In the case of pull, the ostream owns the iovec, whereas in send, the request handler owns it (them).  Thus, it seems that offering both pull and send interfaces is merely a convenience, with no performance impact.  Am I missing something?\n\nTo give some context, I writing a microservice using libh2o.  My server is basically a cache.  When a request comes in, I respond with a cache entry.  I was thinking of using the send interface to send iovecs corresponding to the entire cache entry.  Then I don't bother writing a generator at all, correct?  Is there an advantage to using the pull interface instead?\n\nThanks!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/309/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "Roze": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/315", "title": "Segmentation fault sk_free  at stack/stack.c:290", "body": "This kinda seems LibreSSL fault but reporting anyways:\n\n```\nCore was generated by `/data/h2o/bin/h2o -c /data/h2o/h2o.conf'.\nProgram terminated with signal 11, Segmentation fault.\n#0  sk_free (st=0x200000000) at stack/stack.c:290\n290             free(st->data);\n\n(gdb) bt full\n#0  sk_free (st=0x200000000) at stack/stack.c:290\nNo locals.\n#1  0x00000000004a2471 in int_free_ex_data (class_index=<optimized out>, obj=0x5753580, ad=0x5753650) at ex_data.c:530\n        mx = 0\n        i = <optimized out>\n        item = 0x7f1f1427ac00\n        ptr = <optimized out>\n        storage = <optimized out>\n#2  0x0000000000491584 in SSL_SESSION_free (ss=0x5753580) at ssl_sess.c:698\nNo locals.\n#3  SSL_SESSION_free (ss=0x5753580) at ssl_sess.c:687\n        i = <optimized out>\n#4  0x000000000048ebd5 in SSL_free (s=0x36c89e0) at ssl_lib.c:531\n        i = <optimized out>\n#5  0x00000000004474ac in destroy_ssl (ssl=0x271a380) at /data/install/h2o-1.2.0/lib/common/socket.c:208\nNo locals.\n#6  0x0000000000447504 in dispose_socket (sock=0x3d4f8b0, status=<optimized out>) at /data/install/h2o-1.2.0/lib/common/socket.c:220\n        close_cb = <optimized out>\n        close_cb_data = <optimized out>\n#7  0x0000000000446ce9 in on_write_complete (status=0, sock=0x3d4f8b0) at /data/install/h2o-1.2.0/lib/common/socket.c:378\n        cb = <optimized out>\n#8  run_socket (sock=0x3d4f8b0) at /data/install/h2o-1.2.0/lib/common/socket/evloop.c.h:461\n        status = 0\n#9  run_pending (loop=<optimized out>) at /data/install/h2o-1.2.0/lib/common/socket/evloop.c.h:477\n        sock = 0x3d4f8b0\n#10 0x0000000000447a45 in h2o_timeout__do_post_callback (loop=loop@entry=0xff42a0) at /data/install/h2o-1.2.0/lib/common/socket/evloop.c.h:519\nNo locals.\n#11 0x0000000000449d9e in h2o_timeout_run (loop=loop@entry=0xff42a0, timeout=timeout@entry=0x7fff9f46f1f0, now=<optimized out>) at /data/install/h2o-1.2.0/lib/common/timeout.c:36\n        entry = <optimized out>\n        max_registered_at = 1431877187495\n#12 0x0000000000447978 in h2o_evloop_run (loop=0xff42a0) at /data/install/h2o-1.2.0/lib/common/socket/evloop.c.h:495\n        timeout = 0x7fff9f46f1f0\n        node = 0x7fff9f46f1f8\n        __PRETTY_FUNCTION__ = \"h2o_evloop_run\"\n#13 0x0000000000473a02 in run_loop (_thread_index=_thread_index@entry=0x0) at /data/install/h2o-1.2.0/src/main.c:1205\n        thread_index = 0\n        listeners = 0x7fff9f46f150\n        i = <optimized out>\n#14 0x00000000004433da in main (argc=<optimized out>, argv=<optimized out>) at /data/install/h2o-1.2.0/src/main.c:1610\n        cmd = 0x7fff9f4718db \"/data/h2o/bin/h2o\"\n        opt_config_file = <optimized out>\n        error_log_fd = <optimized out>\n        __PRETTY_FUNCTION__ = \"main\"\n        i = 4\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/315/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "kysnm": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/290", "title": "How do I use the bundled libressl with libh2o? (was: HTTP/2 does not work with examples-simple)", "body": "I am try to compile with  -DWITH_BUNDLED_SSL=on option, But examples-simple does not work as expected.\n\nh2o version is v1.0.2\n\nBelow is a compile logs:\nhttps://gist.github.com/kysnm/e9b21edab26d3d754685\n\nPlease tell me how should be\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/290/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "evmuc": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/277", "title": "Fix cmake for OpenSSL 1.0.2a", "body": "Hi there,\n\nis it possible to fix the FindOpenSSL routine in cmake for supporting OpenSSL 1.0.2a?\n\nhttp://www.cmake.org/gitweb?p=cmake.git;a=commitdiff;h=c5d9a8283cfac15b4a5a07f18d5eb10c1f388505\n\nWould be perfect ....\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/277/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "6D65": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/275", "title": "Quic protocol support", "body": "Any plans for supporting QUIC?\n\nIt seems that currently QUIC doesn't have a lot of changes over HTTP2(same HPACK, same semantics) layer, instead its main focus it's to improve upon TCP, by replacing it with UDP. I wonder if you've thought about it? I'm searching for a high performance QUIC/HTTP2 webserver. \n\nI guess, ideally, it would be only a matter of swapping the TCP under the current HTTP implementation, with QUIC's UDP replacement. But I guess it isn't that easy? Isn't it?\n\nHow would you do it if you were to work on it?\n\nThanks.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/275/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "centminmod": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/273", "title": "proxy ignore headers ?", "body": "Is or will there be away of specifying which headers to ignore in proxy mode ? similiar to nginx's [proxy_ignore_header](http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_ignore_headers) option\n\nWhen proxying to a backend with same header as proxy, you end up with duplicate headers\n\n```\ncurl -I https://h2oproxy1.centminmod.com:8083/\nHTTP/1.1 200 OK\nDate: Tue, 07 Apr 2015 07:04:19 GMT\nServer: h2o/1.1.2-alpha1\nConnection: keep-alive\nContent-Length: 1405\ncontent-type: text/html; charset=utf-8\nlast-modified: Sat, 04 Apr 2015 22:29:11 GMT\nvary: Accept-Encoding\netag: \"552065b7-57d\"\nexpires: Wed, 08 Apr 2015 07:04:19 GMT\ncache-control: max-age=86400, max-age=900\ncache-control: public, must-revalidate, proxy-revalidate\naccept-ranges: bytes\npowered-by: h2o on centminmod.com\ncache-control: public, must-revalidate, proxy-revalidate\nssl host: 8083\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/273/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/260", "title": "content-type charset=utf-8", "body": "How would I got about setting utf-8 in header for h2o ?\n\nI am trying to replicate all headers against nginx spdy/3.1 config so can more evenly compare them seeing as there's header compression overhead involved in both spdy/3.1 and HTTP/2\n\nnotice in nginx `Content-Type: text/html; charset=utf-8` as nginx.conf has variable\n\n```\ncharset utf-8;\n```\n\nh2o HTTP/2 https\n\n```\ncurl -I https://h2ohttp2.centminmod.com:8081/flags.html\nHTTP/1.1 200 OK\nDate: Tue, 31 Mar 2015 05:44:29 GMT\nServer: h2o/1.1.2-alpha1\nConnection: keep-alive\nContent-Length: 63859\ncontent-type: text/html\nlast-modified: Sun, 29 Mar 2015 15:43:59 GMT\netag: \"55181dbf-f973\"\nvary: accept-encoding\ncache-control: max-age=900\npowered by: h2o on centminmod.com\ncache-control: public, must-revalidate, proxy-revalidate\nlink: </style.css>; rel=preload; as=stylesheet\nlink: </reset.css>; rel=preload; as=stylesheet\n```\n\nnginx spdy/3.1\n\n```\ncurl -I https://h2ohttp2.centminmod.com/flags.html     \nHTTP/1.1 200 OK\nDate: Tue, 31 Mar 2015 05:44:35 GMT\nContent-Type: text/html; charset=utf-8\nContent-Length: 63859\nLast-Modified: Sun, 29 Mar 2015 15:43:59 GMT\nConnection: keep-alive\nVary: Accept-Encoding\nETag: \"55181dbf-f973\"\nServer: nginx centminmod\nExpires: Tue, 31 Mar 2015 05:59:35 GMT\nCache-Control: max-age=900\nCache-Control: public, must-revalidate, proxy-revalidate\nAccept-Ranges: bytes\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/260/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/257", "title": "h2o handling of opportunistic encryption over http ?", "body": "With regards to Opportunistic Encryption http://bitsup.blogspot.com.au/2015/03/opportunistic-encryption-for-firefox.html over http non-TLS connections, how would h2o server handle it ? With the same Alt-Svc:h2 header added just pointing to HTTP/2 https port on h2o server ? \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/257/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/244", "title": "header Link push correct syntax ?", "body": "I'm setting up push for css files via Link header for 2 css files style.css and reset.css. Is this the correct way via header.set and header.append ?\n\n```\nheader.set: \"Link: </style.css>; rel=preload; as=stylesheet\"\nheader.append: \"Link: </reset.css>; rel=preload; as=stylesheet\"\n```\n\nover HTTP/1.1\n\n```\ncurl -I https://h2ohttp2.centminmod.com:8081/flags.html        \nHTTP/1.1 200 OK\nDate: Sat, 21 Mar 2015 09:45:13 GMT\nServer: h2o/1.1.2-alpha1\nConnection: keep-alive\nContent-Length: 60838\ncontent-type: text/html\nlast-modified: Sat, 21 Mar 2015 08:07:21 GMT\netag: \"550d26b9-eda6\"\nvary: accept-encoding\ncache-control: max-age=2678400\npowered by: h2o on centminmod.com\nlink: </style.css>; rel=preload; as=stylesheet, </reset.css>; rel=preload; as=stylesheet\n```\n\nover HTTP/2\n\n```\ncurl --http2 -I https://h2ohttp2.centminmod.com:8081/flags.html         \nHTTP/2.0 200\nserver:h2o/1.1.2-alpha1\ndate:Sat, 21 Mar 2015 09:45:20 GMT\ncontent-type:text/html\nlast-modified:Sat, 21 Mar 2015 08:07:21 GMT\netag:\"550d26b9-eda6\"\nvary:accept-encoding\ncache-control:max-age=2678400\nlink:</style.css>; rel=preload; as=stylesheet, </reset.css>; rel=preload; as=stylesheet\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/244/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/243", "title": "SSI - server side includes ?", "body": "Any plans for h2o to include SSI support http://nginx.org/en/docs/http/ngx_http_ssi_module.html ?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/243/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/241", "title": "h2o tuning performance guide ?", "body": "I re-created my 254 World Flags demo which I did for my Centmin Mod LEMP Nginx SPDY/3.1 setup on the same server with h2o 1.1.2-alpha1 just to see how things are performing. But curious what h2o server parameters should I be looking at to improve performance for the ~261-262 page requests ?\n- You can see comparison and video at http://www.webpagetest.org/video/view.php?id=150319_de19515157798057a5da3af57f40d8730c187733&data=1 \n- [Filmstrip comparison](http://www.webpagetest.org/video/compare.php?tests=150319_D7_01e30c10d158f75babc48ea6417497e0-r%3A8-c%3A0-l%3Asan+francisco+h2o+HTTP%2F2+cable+1%2C150319_7K_2bcded7733d0fd702885e1641e1b68ec-r%3A6-c%3A0-l%3Asan+francisco+Centmin+Mod+Nginx+spdy%2F3.1+cable+1%2C&thumbSize=100&ival=100&end=visual)\n\nedit: updated setting from\n\nhttp2-max-concurrent-requests-per-connection: 100\n\nto\n\nhttp2-max-concurrent-requests-per-connection: 300\n\nresults\n- [Webpagetest.org Video Compare](http://www.webpagetest.org/video/view.php?id=150319_358766f10abfac3b432cafe5f18686f24481450e&data=1)\n- [Filmstrip compare](http://www.webpagetest.org/video/compare.php?tests=150319_KD_6b6331f2a7ff40668f683ec494c17a6c-r%3A2-c%3A0-l%3Asan+francisco+h2o+HTTP%2F2+cable+1+max+concurrent+300%2C150319_D7_01e30c10d158f75babc48ea6417497e0-r%3A8-c%3A0-l%3Asan+francisco+h2o+HTTP%2F2+cable+1%2C150319_7K_2bcded7733d0fd702885e1641e1b68ec-r%3A6-c%3A0-l%3Asan+francisco+Centmin+Mod+Nginx+spdy%2F3.1+cable+1%2C&thumbSize=100&ival=100&end=visual)\n\ncheers\n\nGeorge\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/241/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/240", "title": "h2load test h2o - overhead with additional header.set etc settings ?", "body": "Curious if the below measured 20% overhead involved in additional header.set, expires and file.\\* settings in SSL h2o host during h2load testing is normal ? I repeated the below h2load tests around 6x times each.\n\n```\n/usr/local/bin/h2o -v\nh2o version 1.1.2-alpha1\n\n/usr/local/http2-15/bin/h2load --version\nh2load nghttp2/0.7.8-DEV\n```\n# Server Specs\n\nserver is an OpenVZ VPS\n\n```\n4 cpu threads\nXeon E3-1230v2 3.3Ghz\n1GB memory\n25GB SSD\nCentOS 6.6 64bit\n```\n# Global h2o settings\n\n```\nlisten:\n  host: 0.0.0.0\n  port: 8080\n# pid-file: /var/run/h2o.pid\nmax-connections: 10240\nhttp1-request-timeout: 10\nlimit-request-body: 536870912\nhttp1-upgrade-to-http2: ON\nhttp2-idle-timeout: 10\nhttp2-max-concurrent-requests-per-connection: 16\nnum-threads: 4\nuser: nginx\n#expires: 1 day\n#file.dirlisting: off\nfile.send-gzip: on\n#header.set: \"Powered by: h2o on centminmod.com\"\n```\n# h2load test with index page pregzip compressed with `file.send-gzip: on` setting\n\n```\nls -l /usr/local/nginx/html | grep index.html\n-rw-r--r-- 1 nginx nginx  3801 Mar 14 19:15 index.html\n\npigz -11k index.html \n\nls -l /usr/local/nginx/html | grep index.html\n-rw-r--r-- 1 nginx nginx  3801 Mar 14 19:15 index.html\n-rw-r--r-- 1 nginx nginx  1554 Mar 14 19:15 index.html.gz\n```\n# h2o dev build test with expires, file.dirlisting and file.send-gzip set and header.set as follows\n\n```\nlisten:\n  host: 0.0.0.0\n  port: 8081\n  ssl:\n    certificate-file: /usr/local/h2o/centminmod.com-unified.crt\n    key-file: /usr/local/h2o/centminmod.com.key\n    minimum-version: TLSv1\ncipher-suite: ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-    SHA384:ECDHE-ECDSA-AES256$\n    cipher-preference: server\n\nexpires: 2 day\nfile.dirlisting: off\nfile.send-gzip: on\nheader.set: \"Powered by: h2o on centminmod.com\"\nheader.set: \"SSL Host: default SSL\"\nheader.set: \"strict-transport-security: max-age=31536000; includeSubDomains; preload\"\nheader.set: \"x-frame-options: deny\"\n```\n\nh2load test with expires, file.dirlisting and file.send-gzip set and header.set. With repeated tests seems only with the entire combination of extra settings does h2load performance drop ~20% from 49K-51K to around 39K to 41K requests/second. Testing individual settings enabled one at a time give between 47K to 49K requests/s with exception of file.send-gzip by itself gives 49K to 51K (see test further below)\n\n```\n/usr/local/http2-15/bin/h2load -c500 -m100 -n2000000 -v https://XXX.centminmod.com:8081   \nstarting benchmark...\nspawning thread #0: 500 concurrent clients, 2000000 total requests\nProtocol: TLSv1.2\nCipher: ECDHE-RSA-AES128-GCM-SHA256\nServer Temp Key: ECDH P-256 256 bits\nprogress: 10% done\nprogress: 20% done\nprogress: 30% done\nprogress: 40% done\nprogress: 50% done\nprogress: 60% done\nprogress: 70% done\nprogress: 80% done\nprogress: 90% done\nprogress: 100% done\n\nfinished in 50.49s, 39611 req/s, 147.52MB/s\nrequests: 2000000 total, 2000000 started, 2000000 done, 2000000 succeeded, 0 failed, 0 errored\nstatus codes: 2000000 2xx, 0 3xx, 0 4xx, 0 5xx\ntraffic: 7810209408 bytes total, 170152908 bytes headers, 7602000000 bytes data\n                     min         max         mean         sd        +/- sd\ntime for request:    22.48ms       1.74s       1.22s    170.03ms    85.73%\n```\n# h2o dev build test with only `file.send-gzip: on` setting - repeated tests always between 49K to 51K requests/second\n\n```\nlisten:\n  host: 0.0.0.0\n  port: 8081\n  ssl:\n    certificate-file: /usr/local/h2o/centminmod.com-unified.crt\n    key-file: /usr/local/h2o/centminmod.com.key\n    minimum-version: TLSv1\ncipher-suite: ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-    SHA384:ECDHE-ECDSA-AES256$\n    cipher-preference: server\n\n#expires: 2 day\n#file.dirlisting: off\nfile.send-gzip: on\n#header.set: \"Powered by: h2o on centminmod.com\"\n#header.set: \"SSL Host: default SSL\"\n#header.set: \"strict-transport-security: max-age=31536000; includeSubDomains; preload\"\n#header.set: \"x-frame-options: deny\"\n```\n\nh2load test with only `file.send-gzip: on` setting\n\n```\n/usr/local/http2-15/bin/h2load -c500 -m100 -n2000000 -v https://XXX.centminmod.com:8081\nstarting benchmark...\nspawning thread #0: 500 concurrent clients, 2000000 total requests\nProtocol: TLSv1.2\nCipher: ECDHE-RSA-AES128-GCM-SHA256\nServer Temp Key: ECDH P-256 256 bits\nprogress: 10% done\nprogress: 20% done\nprogress: 30% done\nprogress: 40% done\nprogress: 50% done\nprogress: 60% done\nprogress: 70% done\nprogress: 80% done\nprogress: 90% done\nprogress: 100% done\n\nfinished in 38.65s, 51741 req/s, 188.85MB/s\nrequests: 2000000 total, 2000000 started, 2000000 done, 2000000 succeeded, 0 failed, 0 errored\nstatus codes: 2000000 2xx, 0 3xx, 0 4xx, 0 5xx\ntraffic: 7654561500 bytes total, 14505000 bytes headers, 7602000000 bytes data\n                     min         max         mean         sd        +/- sd\ntime for request:    18.37ms       1.36s    926.25ms    146.21ms    84.47%\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/240/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/234", "title": "Suggestion - progressive comparison benchmarks for h2o versions ?", "body": "On front page at https://github.com/h2o/h2o you list nginx vs h2o benchmarks for both HTTP 1.1 vs 2.0 for h2o 0.9.0 versions. Would be great to have each h2o version included in benchmarks to see if there's regressions in terms of performance etc ?\n\nsimilar to how PHP 7/PHP NG has listed on bottom of page at https://wiki.php.net/phpng :)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/234/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/232", "title": "suggestion for h2o.conf example", "body": "Just a suggestion, but for an example h2o.conf you could have it populated with **ALL** example settings and **ALL** available configuration options even if they are defaults. For defaults, populate the example h2o.conf with the default values.\n\nThis would be a great way to provide an overview of what settings are available, so folks can then go back to documentation or help output to review what each setting does.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/232/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/231", "title": "h2o SSL - chrome reporting insecure content when there is none ?", "body": "I am using H2O 1.1.1 with SSL config outlined at https://github.com/h2o/h2o/issues/230\n\nUsing Comodo based SSL wildcard certificate\n\n**Problem**\nWhen I view the H2O SSL served site on port 8081 pages and even individual images loaded in Chrome are reported by Chrome as having insecure content served. But how is that possible even when loading an individual image i.e. cmlogo.png over https:// ? Chrome / HTTP/2 issue or H2O issue ?\n- Chrome Version 41.0.2272.89 m\n- Windows 8 64bit\n\n![](http://centminmod.com/h2o/screenshots/ssl/h2o_insecure_content_00.png)\n\ncheck https SSL on port 8081 for H20 server using [cipherscan](https://github.com/jvehent/cipherscan)\n\n```\n./cipherscan XXX.centminmod.com:8081        \n..............\nTarget: XXX.centminmod.com:8081\n\nprio  ciphersuite                  protocols              pfs_keysize\n1     ECDHE-RSA-AES256-GCM-SHA384  TLSv1.2                ECDH,P-256,256bits\n2     ECDHE-RSA-AES256-SHA384      TLSv1.2                ECDH,P-256,256bits\n3     ECDHE-RSA-AES256-SHA         TLSv1,TLSv1.1,TLSv1.2  ECDH,P-256,256bits\n4     AES256-GCM-SHA384            TLSv1.2\n5     AES256-SHA256                TLSv1.2\n6     AES256-SHA                   TLSv1,TLSv1.1,TLSv1.2\n7     ECDHE-RSA-AES128-GCM-SHA256  TLSv1.2                ECDH,P-256,256bits\n8     ECDHE-RSA-AES128-SHA256      TLSv1.2                ECDH,P-256,256bits\n9     ECDHE-RSA-AES128-SHA         TLSv1,TLSv1.1,TLSv1.2  ECDH,P-256,256bits\n10    AES128-GCM-SHA256            TLSv1.2\n11    AES128-SHA256                TLSv1.2\n12    AES128-SHA                   TLSv1,TLSv1.1,TLSv1.2\n13    DES-CBC3-SHA                 TLSv1,TLSv1.1,TLSv1.2\n\nCertificate: trusted, 2048 bit, sha256WithRSAEncryption signature\nTLS ticket lifetime hint: 300\nOCSP stapling: supported\nClient side cipher ordering\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/231/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68177782", "body": "Just came across H20 and interesting project might integrate it into my Centmin Mod LEMP web stack as I have plans to add other web servers Apache 2.4 and OpenLiteSpeed to existing Nginx web stack so H20 seems like simple enough to integrate too :)\n\nFor benchmarks also check out other tools \n1. siege http://wordpress7.centminmod.com/122/wordpress-super-cache-benchmark-siege-http-load-testing/\n2. locust.io http://wordpress7.centminmod.com/132/wordpress-super-cache-benchmark-locust-io-load-testing/ - official site at http://locust.io/ and github https://github.com/locustio/locust\n3. blitz.io http://wordpress7.centminmod.com/74/wordpress-super-cache-benchmarks-blitz-io-load-test-237-million-hitsday/\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68177782/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68196819", "body": "thanks, i figured it out = moving user directive to root level of the conf file :)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68196819/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68196862", "body": "thanks @kazuho that would be great as I plan to automate via shell script the vhost generation for h2o similar to what I do for Nginx in my Centmin Mod LEMP web stack installer http://centminmod.com/nginx_domain_dns_setup.html\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68196862/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68206872", "body": "Glad I could help :)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68206872/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68210452", "body": "@kazuho speaking to the aspect of familiarity of config files regardless of nginx or YAML, for someone new to both they'd be a bit lost I suspect. Maybe develop a tool or wrapper script which can generate individual h2o vhost config files via easy to use question/answer prompt and spit out the YAML formatted file ? That way anyone can jump right into initial setup at least and working backwards from generated YAML file can understand better how all the pieces and settings fit are laid out.\n\nIf you made the wrapper script able to support command line argument inputs, then you open it up to being scripted for installers or cli automation :)\n\n```\n./wrapper --listenip=127.0.0.1 --listenport=8080 --user:USER -- max-connections=1024 --filedir=/path/to/webroot/ --hostname=hostname\n```\n\nwrapper would generate a valid YAML file\n\nWould make h2o user adoption much easier I suspect for folks not familiar with YAML at all like me :)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68210452/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68356100", "body": "thanks @kazuho instructions for cpanm etc are helpful. However 2 issues cpanm via https doesn't work probably due to poodle SSLv3 attack and disabling of SSLv3 so used non-http install. But second issue is Server::Starter failed to install via cpanm\n\nDid the following\n\n```\nyum -y install perl-devel perl-CPAN\n\ncurl -L https://cpanmin.us | perl - App::cpanminus\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\ncurl: (35) SSL connect error\n\ncurl -L http://cpanmin.us | perl - App::cpanminus\n\ncpanm Server::Starter\n```\n\nended in the following at end\n\n```\nTest Summary Report\n-------------------\nt/06-autorestart.t (Wstat: 256 Tests: 28 Failed: 1)\n  Failed test:  6\n  Non-zero exit status: 1\nFiles=8, Tests=103, 85 wallclock secs ( 0.05 usr  0.03 sys +  2.52 cusr  0.40 csys =  3.00 CPU)\nResult: FAIL\nFailed 1/8 test programs. 1/103 subtests failed.\nmake: *** [test_dynamic] Error 255\n-> FAIL Installing Server::Starter failed. See /root/.cpanm/work/1419945442.19792/build.log for details. Retry with --force to     force install it.\n7 distributions installed\n```\n\nfull log posted at https://gist.github.com/centminmod/302638c5791dd274a859\n\ntried --force install and start_server errors when run\n\n```\nstart_server --port=0.0.0.0:8080 -- /usr/local/bin/h2o -c /usr/local/h2o/h2o.conf\n\nworker 21581 died unexpectedly with status:19968, restarting\nstarting new worker 21582\n[/usr/local/h2o/h2o.conf:3] in command listen, tcp socket:(null):8080 is not being bound to the server\n```\n\ncurrent h2o.conf based on example template https://github.com/h2o/h2o/blob/master/examples/h2o/h2o.conf\n\n```\n# to find out the configuration commands, run: h2o --help\n\nlisten: 8080\nmax-connections: 10240\nhttp1-request-timeout: 10\nlimit-request-body: 536870912\nhttp1-upgrade-to-http2: ON\nhttp2-idle-timeout: 10\nhttp2-max-concurrent-requests-per-connection: 16\nnum-threads: 2\nuser: nginx\nlisten:\n  port: 8081\n  ssl:\n    certificate-file: /usr/local/h2o/server.crt\n    key-file: /usr/local/h2o/server.key\nhosts:\n  \"0.0.0.0:8080\":\n    paths:\n      /:\n        file.dir: /usr/local/nginx/html\n    access-log: /usr/local/h2o/logs/access.log\n  \"alternate.127.0.0.1.xip.io:8081\":\n    listen:\n      port: 8081\n      ssl:\n        certificate-file: /usr/local/h2o/alternate.crt\n        key-file: /usr/local/h2o/alternate.key\n    paths:\n      /:\n        file.dir: /usr/local/nginx/html.alternat\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68356100/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68357998", "body": "Thanks.. reason for preferenced cipher suites is to be able to specify chacha20_poly1305 ciphers for OpenSSL 1.0.2 patched builds i.e. https://www.ssllabs.com/ssltest/analyze.html?d=sslspdy.com&hideResults=on&ignoreMismatch=on&latest\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68357998/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68366141", "body": "with the complexity, might be easier to bundle with h2o it's own init.d/systemd compatibility startup scripts\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68366141/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68412111", "body": "Does that mean the change i would need made for my example h2o.conf would be changing `\"alternate.127.0.0.1.xip.io:8081\"` to `\"0.0.0.0:8081\"` ?\n\n```\n# to find out the configuration commands, run: h2o --help\n\nlisten: 8080\nmax-connections: 10240\nhttp1-request-timeout: 10\nlimit-request-body: 536870912\nhttp1-upgrade-to-http2: ON\nhttp2-idle-timeout: 10\nhttp2-max-concurrent-requests-per-connection: 16\nnum-threads: 2\nuser: nginx\nlisten:\n  port: 8081\n  ssl:\n    certificate-file: /usr/local/h2o/server.crt\n    key-file: /usr/local/h2o/server.key\nhosts:\n  \"0.0.0.0:8080\":\n    paths:\n      /:\n        file.dir: /usr/local/nginx/html\n    access-log: /usr/local/h2o/logs/access.log\n  \"0.0.0.0:8081\":\n    listen:\n      port: 8081\n      ssl:\n        certificate-file: /usr/local/h2o/alternate.crt\n        key-file: /usr/local/h2o/alternate.key\n    paths:\n      /:\n        file.dir: /usr/local/nginx/html.alternate\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68412111/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68415350", "body": "Ah that gist clarifies things alot ... thanks !\n\nso if I understand, my configure should be something like this now for starters ?\n\n```\n# bind all listening ports to \"0.0.0.0\", so it can start with: start_server --port 0.0.0.0:8080 --port 0.0.0.0:8081 -- /usr/local/bin/h2o -c /usr/local/h2o/h2o.conf\n\nlisten:\n  host: 0.0.0.0\n  port: 8080\nmax-connections: 10240\nhttp1-request-timeout: 10\nlimit-request-body: 536870912\nhttp1-upgrade-to-http2: ON\nhttp2-idle-timeout: 10\nhttp2-max-concurrent-requests-per-connection: 16\nnum-threads: 2\nuser: nginx\nlisten:\n  host: 0.0.0.0\n  port: 8081\n  ssl:\n    certificate-file: /usr/local/h2o/server.crt\n    key-file: /usr/local/h2o/server.key\nhosts:\n  \"0.0.0.0:8080\":\n    paths:\n      /:\n        file.dir: /usr/local/nginx/html\n    access-log: /usr/local/h2o/logs/access.log\n  \"alternate.127.0.0.1.xip.io:8081\":\n    listen:\n      host: 0.0.0.0\n      port: 8081\n      ssl:\n        certificate-file: /usr/local/h2o/alternate.crt\n        key-file: /usr/local/h2o/alternate.key\n    paths:\n      /:\n        file.dir: /usr/local/nginx/html.alternate\n    access-log: /usr/local/h2o/logs/access-alternate.log\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68415350/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68418712", "body": "Just an update seems to work and using --force install for start_server despite the error, seems to work - well I assume it's correct :)\n\nstart\n\n```\nstart_server --port 0.0.0.0:8080 --port 0.0.0.0:8081 --pid-file=/var/run/h2o.pid --status-file=/usr/local/h2o/h2o_status -- /usr/local/bin/h2o -c /usr/local/h2o/h2o.conf &\n[1] 10219\n\nstart_server (pid:10219) starting now...\nstarting new worker 10220\nh2o server (pid:10220) is ready to serve requests\n```\n\nrestart\n\n```\nstart_server --restart --port 0.0.0.0:8080 --port 0.0.0.0:8081 --pid-file=/var/run/h2o.pid --status-file=/usr/local/h2o/h2o_status -- /usr/local/bin/h2o -c /usr/local/h2o/h2o.conf &\n[2] 10239\nreceived HUP (num_old_workers=0)\nspawning a new worker (num_old_workers=0)\nstarting new worker 10240\nh2o server (pid:10240) is ready to serve requests\nnew worker is now running, sending TERM to old workers:10220\nsleep 0 secs\nkilling old workers\nold worker 10220 died, status:15\n```\n\nEventually I will be doing comparison benchmarks with Nginx via my Centmin Mod LEMP web stack to see how static file serving fairs and will use http://wordpress7.centminmod.com/ as the test site for it :)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68418712/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68652666", "body": "thanks @kazuho for the update !\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68652666/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "Groterik": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/267", "title": "User data in context", "body": "Is it possible to associate some user data (user context, pointer is enough) with h2o_context_t and h2o_req_t?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/267/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "judofyr": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/261", "title": "How to use libh2o with blocking socket interface?", "body": "Is there a way for me to have a blocking socket reading loop (that I control) and pass the result into libh2o (which will do all the hard HTTP work)?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/261/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68523319", "body": "Seems fair enough. It would be nice to support streaming request bodies, but it's certainly not something you need often.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68523319/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "devlearner": {"issues": [{"url": "https://api.github.com/repos/h2o/h2o/issues/182", "title": "Corner cases: http/1 requests, h2o as reverse proxy", "body": "Hi kazuho,\n\nCame across h2o (and nghttp2) on my way to learning HTTP/2 (and programming); despite still a beginner and learner, I'm truly impressed by your project ~~(and another one from Tatsuhiro)~~. Great work!\n\nReally impressive and promising progress as h2o hits 1.0.0 (I'm personally impressed by your notion to build a fast (optimized) http server to meet challenges of the Web for the next generation --- 'simple' in terms of efficiency --- that 'simpler is faster' (it's hard to get it right; harder to get it light, right?).\n\n~~(on the other hand, i appreciate tatsuhiro's project as it covers a client, a server, and a proxy --- i think both projects serve different purposes, and both are taking the lead as the pioneer in HTTP/2 development --- something that's apparantly certain and widely appreciated!)~~\n\nActually I've a few corner cases I'd like to share with h2o as a reverse proxy. I'd say they are probably minor issues (or the \"rough edges\") that won't be critical; ~~(sorry that I'm stacking them up in one thread)~~\n\n~~[probably we'd agree that http/2 is far more interesting; but i find these while experimenting with http/1 requests; so also bear with me :)  ]~~\n\nFor my test setup, I prepare a simple test `h2o.conf` (with longer io timeouts just for the sake of convenience:\n\n```\nlisten: \n   host: 127.0.0.1\n   port: 444\n\nhosts:\n  default:\n    paths:\n      /:\n        proxy.reverse.url: http://127.0.0.1:333/\n        proxy.preserve-host: ON\n        proxy.timeout.io: 60000\n        proxy.timeout.keepalive: 600000\n```\n\nand I run h2o 1.0.0 for the test:\n\n```\n$ h2o -c h2o.conf\n```\n\n[I'll keep it brief here] So, the corner cases (and some really primitive suggestions):\n###### 1. absolute uris in requests\n\nI observe that when a (HTTP/1) client sends a request with an absolute-uri like this:\n\n```\nGET http://127.0.0.1:444/ HTTP/1.1\nHost: 127.0.0.1:444\n\n\n```\n\nthe url seems to be scrambled in the proxied request at the backend:\n\n```\nGET /ttp://127.0.0.1:444/ HTTP/1.1\nconnection: keep-alive\nhost: 127.0.0.1:444\nx-forwarded-proto: http\nx-forwarded-for: 127.0.0.1\n\n\n```\n\nIt's a corner case since a (normal) HTTP client (like a browser) would probably send a relative uri in the request (like `GET / HTTP/1.1`).\n[as extended reading (to those who might feel interested), i came across a section in the revised HTTP/1.1 specs ([RFC 7230](http://tools.ietf.org/html/rfc7230#section-5.3.1)) that reads (p.42):\n\n>   To allow for transition to the absolute-form for all requests in some\n>   future version of HTTP, a server MUST accept the absolute-form in\n>   requests, even though HTTP/1.1 clients will only send them in\n>   requests to proxies.\n\n[the wording is probably a bit harsh for our case; (i'm not that kind of conformant person); \nbut just some raw ideas:\n- h2o could be more lenient and converts absolute to relative uri (strips `^[^:]*://[^/]*/` to `/`); or\n- we could directly issue a 400 (which the backend is going to issue anyway in this case) ]]\n###### 2. a malformed server reply (from the backend) may accidentally displace subsequent requests\n- Consider that a client sends a (HTTP/1) request (through h2o) to the backend server, \n  and the backend replies with a conformant reply.\n  - Client A issues a request (GET `/1g`) to h2o, and backend replies with a message \"abc\"\n- The client's request got satisfied and disconnects from h2o; \n  the backend's connection (to h2o) stays alive (within keep-alive timeout)\n- During the server keep-alive period, the (buggy) backend somehow repeats the reply\n  - Buggy backend repeats the previous reply:\n\n```\nHTTP/1.1 200 OK\nContent-Length: 3\n\nabc\n```\n- [since the last read from the backend (and satisfied the last request from client), h2o seems to have put the backend server's connection in a suspended state (by temporarily freezing the read side from backend)] Since it occurs during the idle period, the unexpected write by backend seems unnoticed by h2o\n- Another client connects to h2o and makes a request; h2o (as usual) proxied the request to the backend. However, seeing that there is incoming buffer from backend (after resuming reading from backend), h2o seems to mistake it as a reply to this new request (which in fact was the repeated reply for the old request by the buggy server) and relayed it to the client.\n  - Client B connects to h2o and requests for `/2g`; h2o resumes reading from backend and received the repeated reply (for the previous request) which the backend has (re-)issued at an earlier time.\n  - h2o requests `/2g` from the backend as usual, but (seems to have) mistaken \"abc\" (from the previous request) as the reply to this request\n  - h2o replies \"abc\" for the request `/2g` (while the real message should be \"def\")\n- (the backend replies for the second request; which potentially erroneously 'pre-answers' for the third request, thus as a possibility effectively displacing subsequent requests)\n\nAs some primitive thoughts (for this issue), I think:\n- h2o could drop backend connection when it detects something abnormal (like idle backend's sending a reply when no request's in flight or pending)\n  - which would be similiar to the behavior of nghttpx or squid (I think); or\n- simply clears existing buffers from backend's connection (if any) first before writing to backend for a new request\n\nefffectively which ensures that a reply is received _after_ the request is sent (to/from the backend)\n###### 3. cancel proxied request when originating http/1 client connection is lost\n\n~~[I actually posted a similar issue earlier with nghttp2 which Tatsuhiro generously fixed in 0.7.4\n(Hope that Tatsuhiro won't mind me cross-referencing here; but just for reference:\nthe [issue](https://github.com/tatsuhiro-t/nghttp2/issues/156) was here; and some potentially relevant commits here: [`011e3b3`](https://github.com/tatsuhiro-t/nghttp2/commit/011e3b325da8c1fa4e02e4d802bd57acdfe32f55) [`442572c`](https://github.com/tatsuhiro-t/nghttp2/commit/442572c1f45104da5650f842bffb1bd597007e9b) ) ]\nEDIT: I described a similar test setup in an old thread which could be found [here](https://github.com/tatsuhiro-t/nghttp2/issues/156#issuecomment-74113029)~~\n\nIn a nutshell: sometimes a (http/1) client may want to cancel an in-flight request while full request headers have already been sent to h2o (the reverse proxy) but before h2o (receives a reply from the backend and) returns the first byte to the client. \n\n[just for the sake of elucidation:\nA http/2 client could easily abort a request (probably by issuing a RST_STREAM to the respective stream) but before the introduction of streams (and multiplexing in http/2) there's no easy way to do this in http/1 after a full request is sent [write completed] while waiting for a reply [read pending] since there's no application-level signal for an in-flight abort; as a result, most probably, the http/1 client would resort to a connection drop (by disconnecting from the h2o proxy). ]\n\n~~While investigating why the proxy doesn't seem to notice a connection drop by the client while a request's in-flight, Tatsuhiro explains the case of nghttpx (and I quote):~~\n\n> ~~nghttpx HTTPS frontend stops reading while waiting for response from backend server... [in order] to avoid reading next pipelined requests which client may send speculatively.~~\n\nI haven't tested the case of a http/2 client with h2o (as a reverse proxy); just as a wild guess, h2o perhaps stops reading while processing an in-flight request from the (http/1) client, as a result it doesn't seem to notice the client's connection drop (and cancel the proxied request to the backend accordingly) ?\n\nReally sorry for the length. Thanks a lot (for reading) and any help / input appreciated!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/182/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "zlm2012": {"issues": [], "commits": [{"url": "https://api.github.com/repos/h2o/h2o/commits/42358539ed5ed3a6e2a73ce3f5f6a68fa4f1b726", "message": "set `-i` so that the container will be terminated (instead of being detached) when the test is interrupted with Ctrl-C (amends #1614)"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/f9a8bed92ea771c3d3a4750cf00315b8a0d1addc", "message": "make docker ci pretty & able to be canceled by ^C"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/92e0d214c7d56cc7a631e426f9839198e46b1951", "message": "correct the comment."}, {"url": "https://api.github.com/repos/h2o/h2o/commits/e7a8f475cd844f86458ca73b17d4640454d60f40", "message": "asynchronously run on_send_complete() in http1.c & assertion for h2o_socket_write"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/e34cb054d9c36191e1ad4212a60ddd6666e216ee", "message": "add test for multiple balancer usage"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/7f87afd2c3e4208c61f2c04c8f3415e97807973e", "message": "fix proxy configurator according to last review."}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6598725b9583d57b397ec1ee13ad192d40e885b7", "message": "Merge remote-tracking branch 'upstream/kazuho/pr/1361' into lb-optimization"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/537e1103d65fd095ac41970c8b10d480e5b887d1", "message": "Merge remote-tracking branch 'upstream/master' into lb-optimization"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/92a5a43a57e9f2629f126f29cb645f68f98d017b", "message": "fix indent"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/9f15303eddc48fa6d68817243fb484e57001b8c0", "message": "make lib/http1.c always delay on_send_complete()"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/4d5cfecf05dcc687f4e5a5fefef4cb84581d7ce8", "message": "fix heap-use-after-free error triggered in t/50unexpected-upstream-body.t"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/805ee580d506a1fa3f47ffc2bf20ad8237cdf5b7", "message": "Merge remote-tracking branch 'upstream/master' into lb-optimization"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ef611d7053b9d4611e5d2f2a888ab0b9d8d333ff", "message": "Merge remote-tracking branch 'upstream/master' into lb-optimization"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/cb22802a79676ac656f663574217ab59bf6d7f23", "message": "some polishing according to last review comments."}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6de88e6a4b2a3cd2295881615526f6ca11644a0a", "message": "update srcdoc for more specified weight definition"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/81ebc8aaa32e9ed7f5886e31fc1198230bb2e696", "message": "Merge remote-tracking branch 'upstream/master' into lb-optimization"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/2f8b515295d22229231c3995608cf80ee69f5162", "message": "optimized code according to last review"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a73a498238d90e298a6d40027ae2ba3147bb96a9", "message": "Merge remote-tracking branch 'upstream/master' into lb-optimization"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6da1b8c70411878aafc39ed5ba75a1cfee95e5f6", "message": "Merge remote-tracking branch 'upstream/master' into lb-optimization"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/4bc9b192793cf8ea8a849fa0f07b4a44a2132d9f", "message": "Merge remote-tracking branch 'upstream/master' into lb-optimization"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/5a08dcfb5e111c719c254afb6eb7460bed712df4", "message": "update srcdoc for load balancing support."}], "pull_requests": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/1626", "title": "[WIP] bounded consistent hashing balancer support", "body": "This PR brings bounded consistent hashing balancer support to h2o. Requests could be balanced by hashing with there source ip (might be with port) or requesting path. Currently tests and doc are lacked, which should be appended soon.", "author_association": "CONTRIBUTOR"}], "issue_comments": [], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/12691753", "body": "Well I think we should change `accept-range` to `none` instead of drop it since client may still try to make range request. Ref. Section 2.3 from RFC 7233.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/12691753/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "review_comments": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31735576", "body": "Just to make sure I did not misunderstand, is this part what you meant \"polishing up the push generator\"? TBO I don't fully understand how `do_procceed()` work when file is larger than `buf`, though I just followed that function and write `do_multirange_proceed()`. What is the process after non-finished sending, i.e. when leave the proceed function after calling h2o_send with `is_finished` 0? Sorry for not fully understanding the workflow, I tried my best...\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31735576/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31774388", "body": "Understood. I will handle it :-)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31774388/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31979913", "body": "RFC 7233 defines that \n\n```\nbyte-range-set = *( \",\" OWS ) ( byte-range-spec /\nsuffix-byte-range-spec ) *( OWS \",\" [ OWS ( byte-range-spec /\nsuffix-byte-range-spec ) ] )\n```\n\nSo I think I should\n- check `,[ \\t]*` at the top of the do-while block (and skip). If `[ \\t]*` is skipped when last single range parsing ended and no `,` found, error occurred.\n- skip `[ \\t]*` at each exit from single range parsing\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/31979913/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35286235", "body": "Well it seems that `deflateInit2` is still needed. When I was learning the usage of zlib (well, still not so familiar though), I learned that windowbits should be OR with 16 so zlib will generate gzip header & trailer instead of zlib ones.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35286235/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35645834", "body": "Well... I'm not sure if I was misunderstanding but this part only runs at the first call of `send_gzip` of one output stream. I check started flag to do so. And if this block is not enough, it will allocate more blocks as output buffer as code below.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/35645834/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}]}, "Varbin": {"issues": [], "commits": [{"url": "https://api.github.com/repos/h2o/h2o/commits/7f5f2ea1e384dbd1e430b67607c0ae8f5180b574", "message": "enable ECDH"}], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "tagomoris": {"issues": [], "commits": [{"url": "https://api.github.com/repos/h2o/h2o/commits/dd20b333ea727286ed6bd298c1b721a4a630908b", "message": "Merge pull request #1538 with tweaks\n\nAdd a mention about how to control timeouts in http_request method"}], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "i110": {"issues": [], "commits": [{"url": "https://api.github.com/repos/h2o/h2o/commits/deaf3c9ead92cfe7ca3b17e1bda1e1b21a965f42", "message": "Merge pull request #1578 from h2o/i110/mruby-invalid-response\n\nhandle mruby response array and generator correctly"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/acd3f46fd9a1e66c6f4461b2d52624d8077d36e0", "message": "handle mruby response array and generator correctly"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/df1764a60f8ce0a1089e92b9dfe4040836b7f71e", "message": "Merge pull request #1566 from h2o/i110/fix-duplicate-date-headers\n\nfix duplicate date headers"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6e4e929d2417726c8622e2bbf45eff44ab936a46", "message": "remove unnecessary checks and assertions"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/b7ae25730adc03ee4a149b23dd8d68a5a66ae90d", "message": "Merge pull request #1565 from h2o/i110/fix-h2o_mruby_new_str\n\nfix h2o_mruby_new_str"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/dfe688a9285f757b0882b14c816bad63483b5299", "message": "fix duplicate date headers"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/fb1771b19f892964c5ed5cecd68d6ef6796c6a6b", "message": "improve http_request client-warning tests"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0782d59e3fc56d18282ec1c16828cb71c198eb61", "message": "remove mysterious colon"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/33bb92968f78a3b3c31fec4213d36d4217144963", "message": "fix h2o_mruby_new_str"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/e03f86b33f650fdaa6e500c5c0d40496ac0b2c86", "message": "remove client-warning header from token definitions"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/3b161c05f468a18df45756dfd1933fad0a95bb21", "message": "don't reuse upstream_hostport"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/56c723608319845b3bcf66bd9ff53d65b645a1db", "message": "add `client-warning header` to http_request method responses when it failed"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/29cd7918651986d40a68255eeae290692013fc28", "message": "never ignore and close stream when it's push"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/8e81ecb609adf6ea7c604c4d3417bd28e2835c53", "message": "make sure that finalostream_send is called even when bufcnt is zero and send state is IN_PROGRESS"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0bbc06282b849a7dfa7c53c63d888a41aa8a84bd", "message": "change max push stream id from INT32_MAX to 0x7ffffffe"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/abf5d5175c4be2066109ba716f2ef60c29280fb2", "message": "Merge branch 'master' into i110/send-headers-immediately"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/6ac34d1f4adf1f04212fab6f48801e2eef1f7560", "message": "do stream_id check in execute_or_enqueue_request_core"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/5d8a6b5ac02fad04b9023a34b3cb0b5b885ee057", "message": "Merge branch 'master' into i110/stop-opening-new-push-streams-after-goaway"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/0c3ca80d044aef64834b860e2d9162a3f72d9075", "message": "move HALF_CLOSED check from handle_headers_frame to h2o_http2_stream_prepare_for_request"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/8051b70e50cd3d74ad6ce1424e73fe7adecb8ed1", "message": "Merge branch 'master' into i110/process-existing-streams-after-goaway"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ab15e0750720c8563e0469efaefa148297dde82b", "message": "fix stream existing check"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/79fe899da4b9ca231f68945c7ab1d8ea1611c4ad", "message": "Merge pull request #1554 from h2o/i110/update-h2get\n\nupdate h2get"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a99b602e965f3791eda9fa57c0b0d59c4f22e61a", "message": "update h2get"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/a0f37e3273fbd6a42a8e308da344ff11933251ae", "message": "stop opening new push streams after received GOAWAY frame"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/ded2b962fe34fac6c22c1eb524648a1a59100ae5", "message": "remove unnecessary condition for simplicity due to the fact that PRIORITY frames never increments max_open"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/05fe666b4ded7e330f33b3b6675b505ee0fbc3c2", "message": "don't abort processing existing streams while graceful shutdown"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/1d6e644de2d2edf7e385e743d8cce0ec0f5d54c3", "message": "fix doc Makefile"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/bce6523cc0c93dc7e73e27ec53c89c5952c725ca", "message": "make document's selected tab navigatable"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/9f521eed8689fc3ffc57a8f2ee8305ff3efc4bfe", "message": "add directive lists in document"}, {"url": "https://api.github.com/repos/h2o/h2o/commits/f0525a9165a70e82fe8e8d31041961783d348165", "message": "count sock->bytes_written correctly"}], "pull_requests": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/1625", "title": "add /usr/lib/llvm-4.0/bin to PATH to successfully run llvm-symbolize", "body": "address sanitizer requires `llvm-symbolize` binary to locate file:line, and it's located in `/usr/lib/llvm-4.0/bin`.", "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/1549", "title": "[WIP] http2client", "body": "This PR *will* make it able to send HTTP/2 request to the upstreams using proxy or mruby http_request method.\r\n\r\n- [ ] request body streaming\r\n- [ ] automatic retry (when received goaway or REFUSED_STREAM)\r\n- [ ] decode `transfer-encoding: chunked` response\r\n- [ ] limit maximum stream id\r\n- [ ] fix connection selecting logic (least-streams with certain round-robin manner?)\r\n- [ ] protocol negotiation i.e. ALPN and Upgrade\r\n- [ ] merge with http1client into `httpclient`\r\n- [ ] consider configuration..\r\n- [ ] write tests!!!", "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/1482", "title": "[WIP] Refactor: remove generator", "body": "tataki", "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/1217", "title": "mruby Rack middleware", "body": "TODOs:\r\n- [x] request filtering\r\n- [x] ~response fast path~\r\n- [x] ~preserve original request headers~\r\n- [ ] performance tuning", "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/1195", "title": "[WIP] place shared files into versioned directory", "body": "To avoid dependency problem between installed versions, this PR installs shared files into versioned directory.\r\nDevelopers have to set `H2O_SHARE_DIR` environment variable to `$H2O_ROOT/share/h2o` to run the server.\r\n\r\nTODOs:\r\n- [ ] fix paths in documents", "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/1188", "title": "reorganize preloads.rb and bootstrap.rb", "body": "This PR reorganizes the core mruby files, `preloads.rb` and `bootstrap.rb`.\r\n\r\n* `bootstrap.rb` shouldn't be modified by users, so embed it in c source\r\n* makes `preloads.rb` optional to enhance portability (users can modify it, but the h2o itself doesn't depends on the existence of `preloads.rb`)", "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/1152", "title": "redis from mruby", "body": "This PR makes it able to access redis from mruby hanlder, like the following:\r\n\r\n```\r\n        mruby.handler: |\r\n          redis = H2O::Redis.new(:host => '127.0.0.1', :port => 6379)\r\n          Proc.new do |env|\r\n            set = redis.set('key', 'value')\r\n            get = redis.get('key')\r\n            # redis.disconnect\r\n            [ 200, {}, [set.join, get.join] ]\r\n          end\r\n```\r\n\r\nTODOs:\r\n- [x] support more redis features (other commands, authentication, etc..)\r\n- [x] consider preparing specific exception class for IO & procotol errors\r\n- [x] embed mruby source code in `handler/mruby/redis.c` ? (I feel it'll reduce maintainability, so let's discuss)\r\n- [x] timeout\r\n- [x] subscribe", "author_association": "CONTRIBUTOR"}], "issue_comments": [], "commit_comments": [], "review_comments": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74837559", "body": "2.2 ?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74837559/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73820215", "body": "I completely agree! I'll fix.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73820215/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73820249", "body": "tashikani.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73820249/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73820321", "body": "I got it.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73820321/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73821378", "body": "As we discussed, we have to call `satisfy?` method for every requests because whether the request match conditions or not cannot be decided without each request information.\nI guess that not so many acl conditions will appear, so it won't be performance issue.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73821378/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73821516", "body": "OK. this wrapping is just for checking the returned value, but I'll make it done in ruby scripts as talked below, so I can remove this wrapping as you said.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73821516/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73833031", "body": "\u3053\u3053\u30de\u30af\u30ed\u306e\u4e2d\u30672\u56de\u30b3\u30f3\u30d1\u30a4\u30eb\u8d70\u3063\u3066\u305f\u7f60\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/73833031/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74029894", "body": "moved from `hpack.c` to expose this so that debug_state handler can use this..\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74029894/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74030158", "body": "doesn't change except for adding `conn-flow-in` and `conn-flow-out`, but re-formatted by `tokens.pl`\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74030158/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74546907", "body": "Sorry, this isn't relevant to this PR.\nI believe that canonical MIME type of JSON document is `application/json`, and also this JSON document is mainly consumed by \"status\" web-app, so people don't see this in browsers, isn't it?\nhttps://tools.ietf.org/html/rfc7159#section-11\n\nBut, I have no strong kodawari about this, so if you don't like this, I can get it back to`text/plain` ( also with `debug_state.c` ). WDYT?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74546907/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74547256", "body": "I found this spelling in `lib/handler/status.c`, and misunderstood it as a oshare-way of comma...\nI'll fix this!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74547256/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74547604", "body": "> keeping the code-base compact and precise, rather than minimizing impact of each PR\n\ntotally agree. I'll fix.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74547604/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74548451", "body": "tashikani..\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74548451/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74548545", "body": "OK, I'll reduce memory footprint\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74548545/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74868169", "body": "great idea!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74868169/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74868235", "body": "tashikani.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74868235/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74872232", "body": "memo:\nAs we talked, `va_start` can be called again after `va_end` is called against the same va_list\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74872232/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74937773", "body": "you're right..\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74937773/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75086279", "body": "\u3050\u306c\u306c\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75086279/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75240492", "body": "configurator also should use one shared mrb_state for compile testing, because handlers may cause side-effects to other handlers, and it may cause compile (accurately, evaluating)  errors.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75240492/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75240937", "body": "generalize validation as `after_generate_handler` hook, and it came to do finalization too\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75240937/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75263801", "body": "@kazuho To get mruby state shared between multiple handler contexts, each handler context occasionally should do some `clean up` or `finalize` process, additional to validation. For example, `acl` module has a state which is used to validate handler, and that state should be used only in the scope of one handler configuration. So it should be cleared after a handler context is generated.\nSo, we should have two options:\n1. Adding another hook, like `cleanup`, and call it in `on_context_init` too\n2. Put validation and cleanup together in opaque `hook` s\n\nI felt that the latter is better because of ... simplicity \ud83d\ude04 (It's difficult for me to explain this in English, so let's talk f2f later)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75263801/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75615432", "body": "you're right!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75615432/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74935764", "body": "use stack as a memo of filenames to detect circular reference\nOne potential issue: Right now this implementation distinguishes absolute and relative paths, and it may be a bit wasted, but I believe it's not critical issue.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/74935764/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75854962", "body": "`s/typcial/typical/`\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75854962/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75855117", "body": "Is this correct?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75855117/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}]}, "cho45": {"issues": [], "commits": [{"url": "https://api.github.com/repos/h2o/h2o/commits/3116a8328e08c61d83f0d75168900cd5a8ebf41b", "message": "backport test provided in #1560"}], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": []}, "deweerdt": {"issues": [], "commits": [], "pull_requests": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/1410", "title": "Dynamic backends", "body": "This PR adds infrastructure to make it possible to dynamically chose\r\na backend destination on a per request basis. We then take advantage of\r\nthis by allowing `proxy.reverse.url` to take a mapping, in which case we\r\ncan add customizable routing policies. This commit adds the `header`\r\npolicy, if this is set, H2O will look for a given header name in order\r\nto chose the backend destination.\r\n\r\nHaving dynamic backends also supposes that backends can defined on their\r\nown right, indenpendently of `proxy.reverse.url`.  To that end, this\r\ncommit defines a `backend` directive that allows to declare a backend to\r\nH2O, which can then be used for routing.", "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/1199", "title": "ORIGIN frame", "body": "This introduces a new option: `http2-origin-frame`. It can be either a\r\nscalar or a sequence. When this option is sent, H2O sends an ORIGIN\r\nframe as described here:\r\nhttps://github.com/httpwg/http-extensions/blob/master/draft-ietf-httpbis-origin-frame.md\r\n\r\nThe PR is mostly intended to serve as basis for the discussion, rather than intended for merging. It feels like the contents of ORIGIN frame we send should actually depend on the SNI as follows:\r\n- Config defines an SNI to host names mapping\r\n- SNI callback adds the SNI to `h2o_conn_t`\r\n- `expect_preface` looks up the SNI in `h2o_conn_t` and using the config mapping, builds the ORIGIN frame\r\n\r\nThoughts?", "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/919", "title": "Introduce a 'proxy.per_socket_pool' option.", "body": "When this option is 'ON', socket pooling is done at the frontend\nconnection level, so that backend connections are only re-used for a\ngiven frontend connection.\nWe achieve this by adding a `per_socket_pool` member to `h2o_socket_t`.\nIf the option is set, pooled sockets will be added there and the pool\nwill be destroyed at the same time as the socket.\n\nThis also adds a test that checks that tcp connections are re-using the\nsame port, there's also a part of the test that checks that connections\nover unix sockets are still functional.\n\nQuestion: we currently lower case `struct rp_handler_t->upstream` in order to be able to match it afterwards. In order to keep that functionality _and_ be able to re-use `upstream` in the pool creation, I've added a `lcupstream` lowercase version to use for matching. Is that the right thing to do? Another possibility would be to special case the unix socket case, but that requires an intrusive change, as far as I understand.\n", "author_association": "OWNER"}], "issue_comments": [], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/17616656", "body": "Do you mean have the json member look like `h2o-http2-error-flow-control` and `h2o-status-error-400` ? That sounds good to me.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/17616656/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/17616694", "body": "Alternatively, we could have the json object look like something like:\n\n```\n \"h2o-http2-error\" : {\n  \"flow-control\": 2,\n  \"compression\": 3,\n ...\n},\n\"h2o-status-error\": {\n  \"400\": 0,\n  \"403\", 1,\n  ...\n},\n```\n\nThat would be less verbose in terms of json, what do you think?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/17616694/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}], "review_comments": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/62265611", "body": "Yes, of course, it's fixed now. Thanks!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/62265611/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63426150", "body": "That's actually an oversight on my end, I've updated the docs to reflect the current implementation.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63426150/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63426293", "body": "I believe the second of the two new commits address what you suggested. I had to keep a few calls directly to `h2o_send_error_generic`, since sometimes the error isn't directly known in the call site.\nThanks!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63426293/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65220748", "body": "@kazuho ah yes, of course. That's fixed in a3b35d1\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65220748/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63079394", "body": "My reading of the `TCP_NOTSENT_LOWAT` patch (https://lwn.net/Articles/560082/) is that setting 1 as a value means that `epoll()` will only call `EPOLLOUT` if there are `0` unsent bytes on the socket. Is that the intended behavior? In the email, Eric Dumazet seemed to hint that using 128K would allow most applications to save memory (traded for CPU) without affecting throughput.\nI also believe that setting the value to `0` won't disable the feature, but will make it use the system wide value in `/proc/sys/net/ipv4/tcp_notsent_lowat`\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63079394/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/68082646", "body": "I believe this needs to be moved above the `rsc->req_data.len` check, otherwise we might race and skip the coma multiple times.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/68082646/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70885657", "body": "> Did you mean free(norm_indexes)?\n\nI did mean to `memset` it...\n\n> Also, please test the values of norm_indexes[0](I believe it contains a valid value).\n\n... but also mean to test if afterwards, thank you for catching this.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/70885657/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71798018", "body": "Hugh :( I'll blame lack of coffee\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71798018/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 1, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71799261", "body": "> I think you would also need to adjust the return code as well.\n\nIs that so? In the soft error case, we want to continue parsing. Passing the right error code is handled in https://github.com/h2o/h2o/pull/974/files#diff-cdf5c2480fce6f3c41c628a00e404f32R392\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/71799261/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75799874", "body": "http://english.stackexchange.com/a/15802 :)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75799874/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75800081", "body": "Fixed in 0b9026f, thanks for noticing.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75800081/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75891627", "body": "> How about merging the two functions as int h2o_time_compute_##name(struct st_h2o_req_t *req, int64_t *delta_usec), and use the function from both logconf.c and durations.c?\n\nThe reason i didn't do that is that it seemed wasteful to combine the values into a usec just to split them again for the `logconf.c` case. I'll combine them into a single function.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75891627/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75955720", "body": "Ah yes, i misread your suggestion, thank you for the reminder. Updating.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75955720/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76153830", "body": "Thanks for catching this. Removed in 024db0e\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/76153830/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "OWNER"}]}, "theirix": {"issues": [], "commits": [], "pull_requests": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/1097", "title": "Parse :status in hpack", "body": "Added parsing and extracting `:status` to hpack parser.\n", "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/1096", "title": "Added missing required header", "body": "Including header `http2_internal.h` requires `khash.h` which is added to the install directory by this patch.\n", "author_association": "NONE"}], "issue_comments": [], "commit_comments": [], "review_comments": []}, "robguima": {"issues": [], "commits": [], "pull_requests": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/982", "title": "improve ssl locking by using add_lock_callback and rw locks", "body": "@deweerdt is in the loop and has reviewed this\n\nThis PR improves openssl and libressl locking in two ways:\n1. Using RW locks (pthread) for one of the lock types (similar to what openssl does internally)\n2. Adding a lock_add callback which avoids `lock-add-unlock`. \n\nWe've been running similar changes in different applications with success - especially the add_lock callback, but this would need to be tested under load.\n\nI originally intended to implement dynamic locks as per comment in ssl.c. However, we've found that dynlocks are only used by the CHIL engine in openssl, which makes them pretty useless. \\* we can still add them if desirable - also not sure whether perhaps libre makes better use of them.\n\nBTW, this seems to work with the bundled libressl as well. Wonder if a test for specific openssl version must be added though.\n", "author_association": "CONTRIBUTOR"}], "issue_comments": [], "commit_comments": [], "review_comments": []}, "cwyang": {"issues": [], "commits": [], "pull_requests": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/597", "title": "[h2o-ssl] Renegotiation Support", "body": "To support renegotiation, it is sufficient to flush write buffer\nwhen write operation is happened in SSL_read().\n", "author_association": "CONTRIBUTOR"}], "issue_comments": [], "commit_comments": [], "review_comments": []}, "cubicdaiya": {"issues": [], "commits": [], "pull_requests": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/363", "title": "suppressed compiler warnings for ignoring return value of \u2018write\u2019.", "body": "## warning messages\n\n```\n/home/bokko/workspace/h2o/lib/common/serverutil.c: In function \u2018h2o_spawnp\u2019:\n/home/bokko/workspace/h2o/lib/common/serverutil.c:133:14: warning: ignoring return value of \u2018write\u2019, declared with attribute warn_unused_result [-Wunused-result]\n         write(pipefds[1], &errnum, sizeof(errnum));\n                                                      \u30fb\n                                                      \u30fb\n                                                      \u30fb\n/home/bokko/workspace/h2o/lib/handler/access_log.c: In function \u2018log_access\u2019:\n/home/bokko/workspace/h2o/lib/handler/access_log.c:379:10: warning: ignoring return value of \u2018write\u2019, declared with attribute warn_unused_result [-Wunused-result]\n     write(fh->fd, line, pos - line);\n```\n", "author_association": "CONTRIBUTOR"}], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61833484", "body": "Hi, thanks for your reply.\n\n> - please use struct sockaddr_storage addr to store the address. IIRC it is capable of storing any kind of socket address including sockaddr_un\n> - the length check does not match that in line 251.\n> - please make this a switch statement (i.e. switch (listener->family))\n> - please create and access an attribute instead of using unix: as an indicator of UNIX socket\n\nI fixed the above spots in ec6585bacf24a93e9c9a26b76790c30905d99095.\n\n> - does other server behave the same way (silently remove existing unix socket file)?\n\nTo my knowledge, `nginx` removes unix-socket files when `nginx` received a specified signal(e.g. SIGTERM, SIGQUIT, ...) and itself exits. But as my understanding and appreciation of `h2o` is still short, I don't find a way to do it very well yet. So I took the current approach. Do you have a good idea?\n\n> would you mind tell me what the real use case is? I'm curious.\n> \n> IMO h2o is suited for a front-end server and that means that it would be likely setup to bound to a global TCP address\n\nYes, of course. You're right. \n\nBut though `apache` and `nginx` also are suited for a front-end server, I have had experiences in using `apache` and `nginx` as internal proxy on several occations  for esoteric reasons.(Though `apache` can't listen with unix socket.) \n\nThough I don't know about `h2o` in the future, it's my view that a server software can listen with unix socket is sometimes useful in the real world for esoteric reasons.(though it is non-essential..)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61833484/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68622755", "body": "`h2o` supports to listen unix sockets. The example is below.\n\n``` yml\nlisten:\n  port: /tmp/h2o.sock\n  type: unix\nhosts:\n  default:\n    paths:\n      /:\n        file.dir: examples/doc_root\n    access-log: /dev/stdout\n```\n\nBut any other supports for unix sockets are not enough yet.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68622755/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commit_comments": [], "review_comments": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/32379856", "body": "Even if `pthread_create()` for `ocsp_updater_thread()` fails, `h2o` can continue to serve. But I'm a little worried whether  `h2o` should continue to serve in this case. How about you?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/32379856/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33412959", "body": "There is the lack of NULL-check for `mrb_parse_file()`.  It may be better to add it.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33412959/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33412973", "body": "There is the lack of NULL-check for `mrb_open()`.  It may be better to add it.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33412973/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}]}, "mattn": {"issues": [], "commits": [], "pull_requests": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/2", "title": "Windows porting", "body": "IRC \u3067\u8a00\u3063\u305f\u69d8\u306b keep-alive \u304c\u52d5\u3044\u3066\u306a\u3044\u3067\u3059\u304c pull-req \u3057\u3068\u304d\u307e\u3059\u3002\n\n```\n[20:20] < mattn_jp_> Windows porting \u51fa\u6765\u305f\u3088\n[20:21] < mattn_jp_> no libuv \u7248\n[20:27] < mattn_jp_> kazuho_: https://github.com/mattn/h2o/tree/windows\n[20:27] < mattn_jp_> \u306a\u305c\u304b keep-alive \u52d5\u304b\u306a\u3044\u3051\u3069\n[20:28] < mattn_jp_> keep-alive \u7121\u3057\u306b Requests per second:    6471.85 [#/sec] (mean)\n[20:28] < mattn_jp_> on windows\n[20:39] < mattn_jp_> \u3093\u30fc\u306a\u3093\u3060\u308d\n[20:39] < mattn_jp_> https://gist.github.com/mattn/77b4249ac88e3680fcc1\n[20:39] < mattn_jp_> \u3053\u308c\u3092\n[20:40] < mattn_jp_> cat data.txt | nc 127.0.0.1 7890\n[20:40] < mattn_jp_> \u3063\u3066\u3084\u3063\u305f\u3089\u3061\u3083\u3093\u3068\u52d5\u3044\u3066\u308b\u306e\u3067\u3001Windows porting\n                     \u306e\u4ed5\u696d\u3067\u306f\u306a\u3044\u3068\u601d\u3046\u3002\n[20:40] < mattn_jp_> > keep-alive \u304c\u52d5\u304b\u306a\u3044\u4ef6\u3002\n```\n", "author_association": "CONTRIBUTOR"}], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54620234", "body": "\u5b58\u5728\u3057\u3066\u307e\u3059\u30fc\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54620234/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54766345", "body": "\u51fa\u6765\u306a\u304f\u306f\u306a\u3044\u3067\u3059\u304c\u3001\u96e3\u3057\u3044(\u9006\u306b\u6c5a\u304f\u306a\u308b)\u3068\u601d\u3044\u307e\u3059\u3002\n\nH2O_STRLIT \u3092\u4f7f\u3063\u3066\u57cb\u3081\u8fbc\u307f\u3067\u5ba3\u8a00\u3057\u3066\u3044\u308b\u7b87\u6240\u306f\u7c21\u5358\u306b\u9006\u306b\u51fa\u6765\u307e\u3059\u304c\n\n``` c\nstatic const h2o_buf_t CONNECTION_PREFACE = { H2O_STRLIT(\"PRI * HTTP/2.0\\r\\n\\r\\nSM\\r\\n\\r\\n\") };\n```\n\n\u3053\u308c\u3092\u95a2\u6570\u547c\u3073\u51fa\u3057\u306b\u4f7f\u3063\u3066\u3044\u308b\u7b87\u6240\u306a\u3069\u306f\u52d5\u304b\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n``` c\nif (! h2o_contains_token(req->headers.entries[connection_index].value.base, req->headers.entries[connection_index].value.len, H2O_STRLIT(\"http2-settings\"))) {\n```\n\n\u9001\u4fe1\u624b\u524d\u3067\u9006\u306b\u4ed8\u3051\u66ff\u3048\u308b\u306e\u306f\u30e1\u30e2\u30ea\u3092\u6d88\u8cbb\u3059\u308b\u306e\u3067\u7121\u99c4\u306b\u601d\u3044\u307e\u3059\u3002\n\n\u3042\u3068\u69cb\u9020\u4f53\u3092\u30e1\u30f3\u30d0\u6307\u5b9a\u3059\u308b\n\n``` c\n.base = XXX, .len = YYY\n```\n\n\u306fC99\u304b\u3089(\u304b\u306a\uff1f)\u306a\u306e\u3067\u4f7f\u3048\u306a\u3044\u304b\u3082\u3067\u3059\u3057\u3002\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54766345/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54768905", "body": "alloc \u3057\u3066 swap \u3059\u308b(\u3082\u3057\u304f\u306f\u7834\u58ca\u3057\u306a\u304c\u3089 swap \u3059\u308b)\u3068\u3044\u3046\u4e8b\u3067\u3057\u3087\u3046\u304b\uff1f\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54768905/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54802054", "body": "pull-req \u66f4\u65b0\u3057\u307e\u3057\u305f\u3002\nkeep-alive \u306e\u4ef6\u3082\u6cbb\u308a\u307e\u3057\u305f\u3002\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/54802054/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56323788", "body": "This is too old. We will have to do this porting again against latest h2o .\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56323788/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63160775", "body": "lol\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63160775/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65544971", "body": "I'm not sure. but.\n\nUsing include_directories directive has problem?\n\nhttps://github.com/mattn/http-server/blob/master/CMakeLists.txt#L19\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65544971/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65545839", "body": "In my opinion, it must NOT install picohttpparser.h/yoml.h via h2o. Because picohttpparser/yoml is an one of a software production for each them.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65545839/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65546881", "body": "I understand your suggestion. We know that there is production that contains header file as the own code. For example, mruby include khash.h.\nhttps://github.com/mruby/mruby/blob/master/include/mruby/khash.h\nHowever, in my experience, most of them (that contains third-party header files) are struggling for releasing package of xxx-dev.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65546881/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commit_comments": [], "review_comments": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431956", "body": "making macro for read/close is dangerous because we may break behavior of really calling of read for file-I/O not socket. so i think this make sense.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431956/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431997", "body": "windows doesn't have `sys/select.h`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/33431997/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}]}, "swinghu": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56252191", "body": "thanks for your great job!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56252191/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56259883", "body": "Hi,there,Could I build it in windows 7?   I have building it .I found it very interesting to take part in this project! I wonder whether can i build it successfully on platform  win7 vs2013 ,because there is little info about building/ install this project in the file  README.md.\n\nE:\\h2o\\h2o>cmake .\n-- Building for: Visual Studio 12 2013\n-- Found OpenSSL: C:/usr/local/ssl/lib/ssleay32.lib;C:/usr/local/ssl/lib/libea\n2.lib (found version \"1.0.1i\")\n-- Could NOT find UV (missing:  LIBUV_LIBRARIES LIBUV_INCLUDE_DIR)\n-- Could NOT find YAML (missing:  LIBYAML_LIBRARIES LIBYAML_INCLUDE_DIR)\n-- Could NOT find WSLAY (missing:  WSLAY_LIBRARIES WSLAY_INCLUDE_DIR)\n-- Configuring done\n-- Generating done\n-- Build files have been written to: E:/h2o/h2o\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56259883/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56264008", "body": "@syohex Thank you for your reply , I think you have  mis-understood my problem,my problem now is that I want to learn ,is it h2o can complie in window platform ,and Could I develop it on window platform in the future.Your reply will be appriciated!\n\nwhen I open it in VS2013,there is some error like these:\n\n#include <sys/time.h>\n#include <sys/socket.h>   //Error can not open file \n#include <time.h>            //Error can not open file\"time.h\" .\n#include <unistd.h>\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56264008/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56292952", "body": "@kazuho  Thanks, I will try it on Ubuntu first !  then try it on Windows. \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56292952/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56663726", "body": "Yep ,good job ,after update the http2 module ,the performance will be better!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56663726/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56972915", "body": "Why there is so many ads,like\n\n \"\u6cf0\u56fd\u8bd5\u7ba1\u5a74\u513f\u5168\u653b\u7565\" ?\nIs there something wrong ?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56972915/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57050818", "body": "@Alir3z4  Good Job!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57050818/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/60195850", "body": "@chzhewl  It would be better if you upload your Test Case\uff01Thanks\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/60195850/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/7861300", "body": "I also found the README.md file should be more detailed!  \nThanks for your great job!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/7861300/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "review_comments": []}, "feilaoda": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56255113", "body": "\u662f\u4f60github\u7684SSH Key\u6ca1\u914d\u7f6e\u597d\u5427\uff1f\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56255113/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "syohex": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56260914", "body": "@swinghu  You can download libyaml binary and header files from\n- 32bit - https://github.com/jonforums/libyaml-waf/downloads\n- 64bit - http://packages.openknapsack.org/libyaml/libyaml-0.1.4-x64-windows.tar.lzma\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56260914/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/12099268", "body": "typo `amke install` -> `make install`\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/12099268/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "review_comments": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63481321", "body": "`http_status <= 199` or `199 >= http_status` ?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/63481321/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75834348", "body": "`leekage` -> `leakage`\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75834348/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75834357", "body": "`developping` -> `developing`\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/75834357/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}]}, "ipeychev": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56273886", "body": "I also couldn't compile it, on Ubuntu 13.10:\n$ git clone https://github.com/kazuho/h2o.git\nCloning into 'h2o'...\nremote: Counting objects: 1483, done.\nremote: Total 1483 (delta 0), reused 0 (delta 0)\nReceiving objects: 100% (1483/1483), 370.36 KiB | 190.00 KiB/s, done.\nResolving deltas: 100% (980/980), done.\nChecking connectivity... done\ntest@http2:~/install$ cd h2o/\ntest@http2:~/install/h2o$ git submodule update --init --recursive\nSubmodule 'deps/klib' (https://github.com/attractivechaos/klib.git) registered for path 'deps/klib'\nSubmodule 'deps/picohttpparser' (https://github.com/kazuho/picohttpparser.git) registered for path 'deps/picohttpparser'\nSubmodule 'deps/picotest' (https://github.com/kazuho/picotest.git) registered for path 'deps/picotest'\nSubmodule 'deps/yoml' (https://github.com/kazuho/yoml.git) registered for path 'deps/yoml'\nCloning into 'deps/klib'...\nremote: Counting objects: 763, done.\nremote: Total 763 (delta 0), reused 0 (delta 0)\nReceiving objects: 100% (763/763), 288.85 KiB | 241.00 KiB/s, done.\nResolving deltas: 100% (402/402), done.\nChecking connectivity... done\nSubmodule path 'deps/klib': checked out '28c6d8307950929510a1cbb57ed023eff70b1050'\nCloning into 'deps/picohttpparser'...\nremote: Counting objects: 108, done.\nremote: Total 108 (delta 0), reused 0 (delta 0)\nReceiving objects: 100% (108/108), 16.70 KiB | 0 bytes/s, done.\nResolving deltas: 100% (64/64), done.\nChecking connectivity... done\nSubmodule path 'deps/picohttpparser': checked out '275ff298ca91cc6dda6174667aa1438801fb0d12'\nCloning into 'deps/picotest'...\nremote: Counting objects: 4, done.\nremote: Total 4 (delta 0), reused 0 (delta 0)\nUnpacking objects: 100% (4/4), done.\nChecking connectivity... done\nSubmodule path 'deps/picotest': checked out '4728941c8e78ca041ddee45643e0012a977e1484'\nCloning into 'deps/yoml'...\nremote: Counting objects: 24, done.\nremote: Total 24 (delta 0), reused 0 (delta 0)\nUnpacking objects: 100% (24/24), done.\nChecking connectivity... done\nSubmodule path 'deps/yoml': checked out 'ef25ce3ab863a6df7c63b63b650ac0a17cb48119'\nSubmodule 'deps/picotest' (git@github.com:kazuho/picotest.git) registered for path 'deps/picotest'\nCloning into 'deps/picotest'...\nPermission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\nClone of 'git@github.com:kazuho/picotest.git' into submodule path 'deps/picotest' failed\nFailed to recurse into submodule path 'deps/yoml'\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56273886/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56631173", "body": "Okay, I will wait, thanks!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56631173/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58793128", "body": "Great job!\n\nI just tried, but I was unable to run it successfully with SSL configuration. Here is my config for my test HTTP2 server, which is running on this domain http2rulez.com:\n\nlisten:\n  port: 8084\n  ssl:\n    certificate-file: /home/iliyan/cert/http2rulez.com.cert\n    key-file: /home/iliyan/cert/http2rulez.com.key\nfiles:\n  /: /home/iliyan/http2rulez.com/public\nrequest-timeout: 10\nmime-types:\n  txt: text/plain\n  html: text/html\n  gif: image/gif\n  png: image/png\n  jpg: image/jpeg\n  jpeg: image/jpeg\n  css: text/css\n  js: application/javascript\n\nOn this domain I have a few endpoints - SPDY on port 8081, HTTP2 on Port 80 (via node-http2) and so on.\n\nI just configured H2O to run on port 8084 and I tried to connect with Canary and Firefox Nightly. In Canary I have enabled SPDY/4 flag. Both failed to connect to https://http2rulez.com:8084, but they successfully connected via HTTP2 protocol on this address: https://http2rulez.com.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58793128/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/59147191", "body": "Great job! It works now on https://http2rulez.com:8084!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/59147191/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "xiangzhai": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56324519", "body": "Hi kazuho,\n\nI totally agree with you that paper is NOT able to prove the performance, but it is able to explain WHY h2o is faster 2x than Nginx, because h2o is ZERO-module, but Nginx has to consider about lots of features? https://github.com/nginx/nginx/tree/master/src/http/modules or due to h2o use John Carmack alike sqrt Ancient Aliens' algorithm?\n\nAnd the benmark http://github.com/kazuho/h2o#benchmark is too simple, please look at Google`s V8 benchmark https://v8.googlecode.com/svn/data/benchmarks/\n\nRegards,\nLeslie Zhai\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56324519/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56338606", "body": "so @kazuho failed to explain WHY h2o is faster 2x than Nginx https://github.com/kazuho/h2o/issues/14 \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56338606/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56348995", "body": "@kazuho I hold the view that if you develop a new I/O event notification better performance than epoll in kernel space, then h2o might be faster than Nginx for Linux box, but only I/O event optimization is not enough, if you have a look at Nginx\u2018s modules` source code ;)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56348995/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56351687", "body": "@kazuho sorry, I missed your reply ;) https://news.ycombinator.com/item?id=8342684\n\nGood, it is the correct way to compare the efficiency of different utilities, I will read your HTTP parser  source code https://github.com/kazuho/picohttpparser/blob/master/picohttpparser.c then compare with Nginx to check out the time complexity O(n), indeed it is fair play ;)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56351687/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56468778", "body": "@kazuho I checked out your phr_parse_request https://github.com/kazuho/picohttpparser/blob/master/picohttpparser.c#L246 used by h2o, the phr_parse_request's time complexity shown as below:\n1. is_complete O(n) to check whether nor not buf_start == buf_end\n2. ADVANCE_TOKEN O(n) is it really better than strtok? called TWICE by parse_request\n3. parse_int O(n) is it really better than Python's parse string to int algorithm in C?\n4. parse_headers O(n^2) \n5. get_token_to_eol O(n^2) called by parse_headers\n\nIt is NOT impressed, just so so, but if you developed in Assembly.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56468778/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56616347", "body": "@kazuho please patched the time-complexity-test.patch https://github.com/xiangzhai/picohttpparser/blob/master/time-complexity-test.patch to check out the time elpased called your HTTP parser about request stuff 10K times.\n\nI hold the view that your HTTP parser is O(n^2) just like VERY BASIC one http://leetcode.com/2011/11/longest-palindromic-substring-part-i.html NOT black art O(n) http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html\n\n> I cannot expect a correct analysis on nginx or H2O from the same approach that caused so many mistakes in analyzing picohttpparser (< 1000 LOC)\n\nYUP, it is the fastest algorithm if you developed NOTHING ;) https://github.com/xiangzhai/picohttpparser/blob/master/test_print.c \n\nPerhaps h2o would be faster 2x than Nginx after you experienced all of the leetcode questions http://leetcode.com/\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56616347/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56618279", "body": "@kazuho \n1. I do not have time to write testcase of heavy pressure and boundary test for your copy/paste open source project.\n2. get_token_to_eol`s time complexity is O(n), my mistake, sorry\n3. just ignore me ;) because I argue that your stuff is not better than Nginx\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56618279/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61582497", "body": "Hi @kazuho \n\nWhat impressed me is your spirit, I mean, keep on developing h2o, even that I challenged your algorithm...\n\nI want to introduce FastSocket https://github.com/fastos/fastsocket a kernel-space improvement for networking development, happy hacking and just for fun ;)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/61582497/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "wangbin579": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56350501", "body": "Nginx\uff1a\n\n```\n# ./nginx -v\nnginx version: nginx/1.6.2\n\nworker_processes 1;\nmaster_process  off;\ndaemon off;\nerror_log /dev/stderr warn;\nevents {\n  worker_connections 1024;\n}\nhttp {\n  default_type      application/octet-stream;\n  sendfile          on;\n  tcp_nopush        on;\n  keepalive_timeout 65;\n  keepalive_requests 1000000;\n  access_log off;\n  server {\n    listen 8070;\n    location / {\n      root html;\n    }\n  }\n}\n\n[html]# cat index.html\nIt works!\n\n[webbench-1.5]# ./webbench -c 10 -t 60 http://xxx.xxx.xxx.xxx:8070/index.html\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\n\nBenchmarking: GET http://xxx.xxx.xxx.xxx:8070/index.html\n10 clients, running 60 sec.\n\nSpeed=960826 pages/min, 3827290 bytes/sec.\nRequests: 960826 susceed, 0 failed.\n```\n\nH2O\uff1a\n\n```\nport: 8090\nfiles:\n  /: examples/doc_root\nrequest-timeout: 10\nmime-types:\n  txt: text/plain\n  html: text/html\n  gif: image/gif\n  png: image/png\n  jpg: image/jpeg\n  jpeg: image/jpeg\n  css: text/css\n  js: application/javascript\n\n[doc_root]# cat index.html\nIt works!\n\n[webbench-1.5]# ./webbench -c 10 -t 60 http://xxx.xxx.xxx.xxx:8090/index.html\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\n\nBenchmarking: GET http://xxx.xxx.xxx.xxx:8090/index.html\n10 clients, running 60 sec.\n\nSpeed=752419 pages/min, 2671087 bytes/sec.\nRequests: 752419 susceed, 0 failed.\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56350501/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56353269", "body": "nginx:\n[webbench-1.5]# ./webbench -c 500 -t 60 http://xxx.xxx.xxx.xxx:8070/index.html\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\n\nBenchmarking: GET http://xxx.xxx.xxx.xxx:8070/index.html\n500 clients, running 60 sec.\n\nSpeed=1084465 pages/min, 4319785 bytes/sec.\nRequests: 1084465 susceed, 0 failed.\n\nh2o:\n[webbench-1.5]# ./webbench -c 500 -t 60 http://xxx.xxx.xxx.xxx:8090/index.html \nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\n\nBenchmarking: GET http://xxx.xxx.xxx.xxx:8090/index.html\n500 clients, running 60 sec.\n\nSpeed=958200 pages/min, 3401716 bytes/sec.\nRequests: 958200 susceed, 0 failed.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56353269/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56353963", "body": "We also notice that nginx consumes more cpu resources(vmstat's us) than h2o\n\nvmstat:\nh2o:\n  r  b   swpd   free   buff              cache   si   so    bi    bo   in   cs      us sy id wa st\n 2  0  28764 162556 508400 2562564    0    0     0     8 2464 3743  4 40 56  0  0\n 2  0  28764 162680 508400 2562564    0    0     0     0 2446 3931  3 40 57  0  0\n\nnginx:\n  r  b   swpd   free   buff              cache   si   so    bi    bo   in   cs      us sy id wa st\n 2  0  28764 143944 508400 2562564    0    0     0     0 2418  188  6 44 50  0  0\n 2  0  28764 143944 508400 2562564    0    0     0     0 2333  170  6 44 50  0  0\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56353963/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56355497", "body": "[webbench-1.5]# uname -a\nLinux zw1-12-193.inter.163.com 2.6.32-431.5.1.el6.x86_64 #1 SMP Fri Jan 10 14:46:43 EST 2014 x86_64 x86_64 x86_64 GNU/Linux\n\n[webbench-1.5]# grep \"model\\ name\" /proc/cpuinfo\nmodel name      : Intel(R) Xeon(R) CPU            5130  @ 2.00GHz\nmodel name      : Intel(R) Xeon(R) CPU            5130  @ 2.00GHz\nmodel name      : Intel(R) Xeon(R) CPU            5130  @ 2.00GHz\nmodel name      : Intel(R) Xeon(R) CPU            5130  @ 2.00GHz\n\n[webbench-1.5]# free -m\n             total       used       free     shared    buffers     cached\nMem:          7871       1413       6458          0        166        151\n-/+ buffers/cache:       1096       6775\nSwap:         8191         43       8148\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56355497/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56470548", "body": "Sorry, I have not mentioned that webbench runs on a different machine.\n\nWhen running webbench via lo interface, h2o outperforms nginx a little, but this is not the common usage scenario.\n\n```\nnginx:\n[190 webbench-1.5]$ ./webbench -c 500 -t 60 http://xxx.xxx.xxx.190:8070/index.html\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\n\nBenchmarking: GET http://xxx.xxx.xxx.190:8070/index.html\n500 clients, running 60 sec.\n\nSpeed=888454 pages/min, 3539008 bytes/sec.\nRequests: 888454 susceed, 0 failed.\n\nh2o:\n[190 webbench-1.5]$ ./webbench -c 500 -t 60 http://xxx.xxx.xxx.190:8090/index.html\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\n\nBenchmarking: GET http://xxx.xxx.xxx.190:8090/index.html\n500 clients, running 60 sec.\n\nSpeed=986666 pages/min, 3501936 bytes/sec.\nRequests: 986461 susceed, 205 failed.\n```\n\nIf we use takset, the results are the following:\n\n```\nnginx:\n[190 webbench-1.5]$ taskset 7 ./webbench -c 500 -t 60 http://xxx.xxx.xxx.190:8070/index.html \nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\n\nBenchmarking: GET http://xxx.xxx.xxx.190:8070/index.html\n500 clients, running 60 sec.\n\nSpeed=998937 pages/min, 3979099 bytes/sec.\nRequests: 998937 susceed, 0 failed.\n\nh2o:\n[190 webbench-1.5]$ taskset 7 ./webbench -c 500 -t 60 http://xxx.xxx.xxx.190:8090/index.html\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\n\nBenchmarking: GET http://xxx.xxx.xxx.190:8090/index.html\n500 clients, running 60 sec.\n\nSpeed=1008222 pages/min, 3578822 bytes/sec.\nRequests: 1008120 susceed, 102 failed.\n\nNote that there are failed requests here.\n```\n\nIf running webbench on a different machine(not a virtual machine), no matter how you optimize it, the results are similar to the following:\n\n```\nnginx:\n[191 webbench-1.5]# taskset 7 ./webbench -c 500 -t 60 http://xxx.xxx.xxx.190:8070/index.html\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\n\nBenchmarking: GET http://xxx.xxx.xxx.190:8070/index.html\n500 clients, running 60 sec.\n\nSpeed=1045694 pages/min, 4165339 bytes/sec.\nRequests: 1045694 susceed, 0 failed.\n\nh2o:\n[191 webbench-1.5]# taskset 7 ./webbench -c 500 -t 60 http://xxx.xxx.xxx.190:8090/index.html\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\n\nBenchmarking: GET http://xxx.xxx.xxx.190:8090/index.html\n500 clients, running 60 sec.\n\nSpeed=895681 pages/min, 3179621 bytes/sec.\nRequests: 895668 susceed, 13 failed.\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56470548/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56470683", "body": "When using taskset, both h2o and nginx consume almost 100% cpu resources (%cpu)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56470683/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56483222", "body": "It should be noted that webbench uses short-lived connections while wrk uses long-lived connections.\n\nWhen using wrk to stress nginx and h2o, we get the following results:   \n\n```\n[190 html]# ll hessian-serialization.html \n-rw-r--r-- 1 root root 68814 Mar 24  2014 hessian-serialization.html\n\nh2o:\n[191 wrk]# ./wrk -c 100 -d 15 -t 1 http://xxx.xxx.xxx.190:8090/hessian-serialization.html\nRunning 15s test @ http://xxx.xxx.xxx.190:8090/hessian-serialization.html\n  1 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    58.28ms   15.82ms  85.58ms   63.70%\n    Req/Sec     1.72k    61.48     1.87k    66.00%\n  25701 requests in 15.00s, 1.66GB read\nRequests/sec:   1713.38\nTransfer/sec:    113.03MB\n\nnginx:\n[191 wrk]# ./wrk -c 100 -d 15 -t 1 http://xxx.xxx.xxx.190:8070/hessian-serialization.html\nRunning 15s test @ http://xxx.xxx.xxx.190:8070/hessian-serialization.html\n  1 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    58.15ms   15.61ms  85.30ms   63.85%\n    Req/Sec     1.72k    41.09     1.81k    65.00%\n  25696 requests in 15.00s, 1.66GB read\nRequests/sec:   1713.00\nTransfer/sec:    113.03MB\n\n\n[190 html]# ll index.html\n-rw-r--r-- 1 root root 10 Sep 22 14:16 index.html\n\nh2o:\n[191 wrk]# ./wrk -c 100 -d 15 -t 1 http://xxx.xxx.xxx.190:8090/index.html \nRunning 15s test @ http://xxx.xxx.xxx.190:8090/index.html\n  1 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency     2.81ms   88.15us   5.13ms   71.17%\n    Req/Sec    37.67k     1.96k   45.56k    56.11%\n  528777 requests in 15.00s, 109.93MB read\nRequests/sec:  35252.31\nTransfer/sec:      7.33MB\n\nnginx:\n[191 wrk]# ./wrk -c 100 -d 15 -t 1 http://xxx.xxx.xxx.190:8070/index.html\nRunning 15s test @ http://xxx.xxx.xxx.190:8070/index.html\n  1 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency     3.33ms    1.80ms   7.28ms   58.30%\n    Req/Sec    31.67k     1.69k   40.56k    59.42%\n  445899 requests in 15.00s, 103.76MB read\nRequests/sec:  29727.10\nTransfer/sec:      6.92MB\n```\n\nBTW, in my opinion benchmarks can prove nothing to the engineers sometimes and production workload based comparison is more useful.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56483222/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "razum2um": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56660873", "body": "hi @kazuho \nI read https://github.com/kazuho/h2o/issues/15 and as far as I understand the problem shifted to discussing benchmark tool, I think it's wrong direction and I support @xiangzhai 's opinion that to be X times faster you need to do some notable improvements.\n\nI understand, that being modular slows nginx down, but I don't think that it's the main reason,\n\nStill, have you seen nginx's source and can you tell differences in implementation?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/56660873/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "tatsuhiro-t": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57078456", "body": "It is very interesting result.  As it looks, nghttpd is quite slow, mostly we did many expensive string operations and also there is some overhead in libevent usage.  In deed, its purpose is for debugging tool to aid HTTP/2 development.\nTo evaluate the real performance of libnghttp2 core functionality, I wrote `tiny-nghttpd`.\nIt is in `examples/tiny-nghttpd` after compilation.  Could you run this under your benchmark test?\nIn my environment, it performs like between h2o and trusterd.\nIt only uses `epoll` and only runs on linux, but since your benchmark is on ubuntu, so it does not matter.  \nI also a bit optimized nghttp2 code, so trusterd also gets a bit more power now.\nThank you in advance.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57078456/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57106728", "body": "Yeah, it would be helpful.  Thank you very much. We will continue to improve the performance of nghttp2.\nBTW I got single crash if h2o yesterday.  Unfortunately there is no trace. I will send stacktrace next time.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57106728/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57302292", "body": "Thanks! Keep up your good work.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/57302292/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62539552", "body": "h2load still does not support prioritization at the moment; it needs some work.\nFor immediate use, however, nghttp command line client has `-a` option to parse incoming HTML file and send requests the resources linked from the HTML (e.g., css, js and images, static resource only, no javascript evaluation is available). It prioritizes the following rule: HTML > CSS > js > images.\n\n```\n$ nghttp -nva https://nghttp2.org/\n```\n\nFYI, I blogged about prioritization while ago: https://nghttp2.org/blog/2014/04/27/how-dependency-based-prioritization-works/\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62539552/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63213497", "body": "As a first step to analyze how priority affects resource transfer, I added HAR format output option to nghttp client for easier visualization. It also get option to enable/disable priority hints, so we can compare the difference.\nI wrote a blog post about this: https://nghttp2.org/blog/2014/11/16/visualization-of-http-slash-2-priority/\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63213497/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63662529", "body": "doc is a bit old right now. The flag is\n\n```\n  -r, --har=<FILE>   Output  HTTP transactions  <FILE> in  HAR format.\n                     If '-' is given, data is written to stdout.\n```\n\n`nghttp -h` will also show all flags.\n\n`--no-dep` flag is also interesting for experiments.\n\n```\n  --no-dep           Don't  send  dependency  based priority  hint  to\n                     server.\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63662529/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/12948654", "body": "I think this commit should be reverted.\nRFC 7540 says that client cannot send PUSH_PROMISE and any attempt to enable push in server initiated SETTINGS is connection error.  Which means effectively server disables reception of push.\n\n```\n   A client cannot push.  Thus, servers MUST treat the receipt of a\n   PUSH_PROMISE frame as a connection error (Section 5.4.1) of type\n   PROTOCOL_ERROR.  Clients MUST reject any attempt to change the\n   SETTINGS_ENABLE_PUSH setting to a value other than 0 by treating the\n   message as a connection error (Section 5.4.1) of type PROTOCOL_ERROR.\n```\n\nSo, making enable_push to 1 is even more confusing, assuming \"1\" means enabling push.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/12948654/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "review_comments": []}, "vuongnch57": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58542713", "body": "Yes.I built libcrypto with OpenSSL.I follow your suggestion and now the h2o server is working perfectly. Thanks a lot\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58542713/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "chzhewl": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58738521", "body": "Well, I have a small web program (no service scripts, multiple JS files), using nginx as the server can run normally. In the use of H2O, in accordance with the \"README.md\" in the success of centos6.5 64bit in steps to deploy and start the service, JS script error accessing my web program home through the browser, the browser debugging found confusion in the contents of the JS file provided by H2O, and every time to re visit when chaotic sequence is not the same.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58738521/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/60216640", "body": "@kazuho  I'm sorry! Recently, the time is a little tight, thank you for your email reminder, just test, the problem has been fixed.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/60216640/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "desaxce": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58796683", "body": "@ipeychev:\n\nHi, I am not sure h2o supports AEAD cipher suites. Personally I managed to run an h2o HTTP/2 server with SSL and then I used Firefox Nightly to connect to it (but I had to set network.http.spdy.enforce-tls-profile to false).\n\nHope that helps.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/58796683/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "igrigorik": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62012782", "body": "@kazuho at the moment, both Chrome and FF are only using the weight field -- does H20 respect that? That said, I do expect that we'll be adding the DAG dependency model as well.\n\nAlso, this is a tangent, but when/if issuing a PUSH response, is there a way for me to impose a priority on the stream I want to push? E.g. let's say I _want_ to push the entire push response before the original response body is served.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62012782/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62099516", "body": "> You are right. At the moment, H2O only respects the weight within the HEADERS frame. It should also be noted that the server does not distribute the bandwidth between the streams by their weight values. Instead, it gives 100% bandwidth to the oldest and most highly weighted stream (if data is available on such stream).\n> \n> My understanding is that this is the most web-browser-friendly way of sending data (in terms of early rendering) at the moment. It may change as browsers start implementing DAG dependency, but IMO it might be worthwhile to keep the current implementation as a separate option, since it would suite the needs of some users (e.g. for game developers wanting to do batched downloads in prioritized groups, as you have mentioned).\n\nMakes sense, thanks. If anything, this just shows that we need some good shared benchmarks to iterate on various strategies - e.g. take a set of different sites, serve them through an HTTP/2 server/proxy, and start measuring speedindex / firstpaint / load time / etc.\n\n/cc @pmeenan (who might have some ideas for how to setup such a thing)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62099516/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62462115", "body": "@kazuho I like it, that would be a handy tool to have. /cc @mnot \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62462115/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62562572", "body": "@tatsuhiro-t great writeup!\n\nEffectively, what we need is a tool that is able to run the analysis that you show in the blog post: send a few requests with a particular deps pattern, analyze the order in which data frames are coming back. For consistency, we could also implement a common backend endpoint/server that provides a mix of different resources - e.g. a static resource that's immediately available, a resource that takes some time to trickle out, etc.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/62562572/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63657641", "body": "@tatsuhiro-t that's great work! For HAR output, what's the flag? I'm not seeing it in [the docs](https://nghttp2.org/documentation/nghttp.1.html).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/63657641/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "Stanback": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/64824120", "body": "Sure - feel free to reopen and merge. System-wide installation is a little easier to get up and running quickly but submodule probably best for most projects.\n\nI may publish a small example project showing how to setup a simple server in c++ using libh2o as a submodule with CMake.\n\nEdit: One more thing - you'll probably need to add install targets for the headers contained under deps/ or require the user to install them manually - which was another reason I opted for submodule.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/64824120/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68325909", "body": "Thanks! C++ regression testing would be nice.\n\nBTW, I'm also getting the following linker error:\n\n```\nduplicate symbol _h2o_file_default_index_files\n```\n\nEdit: Ah, I see you fixed that in the commit as well :+1: \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68325909/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68990957", "body": "@kazuho No problem, I've amended the commit to include the check for libuv\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68990957/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commit_comments": [], "review_comments": []}, "alexkoch01": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/64947242", "body": "Ok thanks for your answer. I am at the moment only interested in HTTP/1, I would like to use H2O as a library in a small application, so basically the stacks I need (correct me if I am wrong) are the http parser (this is used in Perl applications already), the HTTP/1 implementation and the networking/memory stack. Based on what you said, it is fairly safe for production usage?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/64947242/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "methane": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65183058", "body": "This installs picohttpparser.h and yoml.h to include directory.\nIt makes easy to use libh2o.  But it may conflicts other projects installing picohttpparser.\n\nHow do you think about adding symlink \"h2o/picohttpparser.h\" -> \"../deps/picohttpparser/picohttpparser.h\"?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65183058/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65185466", "body": "OK.  I agree that we should avoid symlink.\nNow my PR uses `#include \"yoml.h\"` and `#include \"picohttpparser.h\"` from only headers under \"include/h2o\".\n\nWhen building h2o, they are included from deps.\nWhen using libh2o, they are included from \"<prefix>/include/h2o/\".\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65185466/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65190557", "body": "@kazuho OK, I see.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65190557/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65358547", "body": "No, I am waiting your review again.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65358547/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65543188", "body": "@kazuho Currently, h2o's API uses types from yoml.  And httpparser is used httpclient.\nIt seems difficult to hide bundled yoml and picohttpparser.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65543188/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65544226", "body": "Another solution is copying picohttpparser.h and yoml.h into \"include/h2o/\".\nPros:  We can use `#include \"h2o/picohttpparser.h\"` everywhere.\nCons: When building h2o without cmake, developer should copy them manually.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65544226/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65545390", "body": "@kazuho I can't understand what \"make test install\".\nMakefile generated cmake is very hard to me...\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65545390/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65545613", "body": "@mattn\nThis PR is for using libh2o from another project.\nAfter `make install`, `libh2o` should be installed to `<prefix>/lib` and all headers required to use libh2o\nshould be installed under `<prefix>/include`.\nCurrently, picohttpparser.h and yoml.h are required to build program linking libh2o.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65545613/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65545993", "body": "@mattn But they are not used as normal library.  They are bundled in libh2o.\nI prefer bundling because some projects may use different version of picohttpparser.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65545993/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65546266", "body": "If API of picohttpparser and yoml are very stable, it's OK to install their headers separately.\nTheir Makefile should support `make install -DPREFIX=<prefix>`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65546266/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65548931", "body": "Now is not the time to provide \"make install.\"\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/65548931/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "pierrebeaucamp": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/66589171", "body": "Thank you for looking into this. \n\n> googledrive.com seems to redirect http requests to https; the reverse proxy of H2O does not support https. Supporting https in reverse proxy is IMO a low priority issue.\n\nIn this case, I would suggest to rename the issue to address the HTTPS support for the proxy. I understand that this is a low priority but I would be happy to see this somewhere in the future. \n\nI haven't digged this deep into your code yet, so I don't know if this will relate to #39 \n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/66589171/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "jbergstroem": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68195938", "body": "@kazuho Thanks for your quick reply. The reason I was suggesting libucl was because of the same argument you're using :) A lot of people already using nginx would probably appreciate the same config structure. It would also handle issues like #82, at the same time having the similar advantage to yaml when you want to use config generators (whatever language -> yaml, but in the libucl case json instead).\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68195938/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68200807", "body": "@kazuho thanks for elaborating. Fwiw, I saw people asking about similar stuff (having a nginx-syntax config file) in the hacker news-thread which is I thought it'd be a good idea to bring it up for both venting interest as well as having future users understand the rationale behind the decision. Close for now?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68200807/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/9115550", "body": "Libuv ships with a `.pc`. Couldn't you just call `pkg_check_modules` from Cmake?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9115550/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "review_comments": []}, "bagder": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68221693", "body": "Firefox has \"depdendency priorities\" now: https://bugzilla.mozilla.org/show_bug.cgi?id=1003450\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68221693/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69472661", "body": "Patrick also explained it somewhat further in this blogpost: http://bitsup.blogspot.se/2015/01/http2-dependency-priorities-in-firefox.html\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69472661/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70420367", "body": "It would probably make sense to also make sure to send back a \"proper\" response code for non-recognized methods while you're at it changing this code path. Just sending back a 404 when we send \"MOO\" as a request is weird and not HTTP/1.1 compliant.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70420367/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "hedgehog": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68237044", "body": "Support building against PolarSSL:\nhttps://polarssl.org/\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68237044/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68309469", "body": "Hi, Thanks for the prompt response.  I have the ARM 32 bit chips in mind, and wasn't sure to what extent the pico-http-parser relies on instructions specific to x86.  I'm in the process of trying to build an ARM-32 emulator in  VM so will report any findings.\n\nI mainly was wanting to know whether your intent was to support the ARM platforms (32 and 64 bit) - it sounds like it is.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68309469/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "kawa-": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68311080", "body": "Sorry, I've found it. h2load is in the repo of [https://github.com/tatsuhiro-t/nghttp2](https://github.com/tatsuhiro-t/nghttp2) .\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/68311080/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "commit_comments": [], "review_comments": []}, "nickdesaulniers": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69480748", "body": "Cool! Thanks for pointing this out, was inspired by a recent talk I saw about atomics vs mutexes.  Just curious, I know the qrintf stuff requires gcc extensions, but wouldn't c11 atomics be preferred?  If so, I'd be happy to rewrite my patch.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69480748/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69480900", "body": "I don't know how to run the unit tests, I simply loaded up the home page in a browser twice, and then ran `wrk -c 100 -t 100 http://localhost:8080` against it.  I'm not sure how valid that is to test, but atleast things looked slightly better:\nBefore:\n\n```\nwrk -c 100 -t 100 http://localhost:8080\nRunning 10s test @ http://localhost:8080\n  100 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency     3.42ms    3.77ms  28.95ms   86.58%\n    Req/Sec   396.51    152.00   777.00     53.85%\n  374886 requests in 9.99s, 143.01MB read\nRequests/sec:  37515.11\nTransfer/sec:     14.31MB\n```\n\nafter:\n\n```\nwrk -c 100 -t 100 http://localhost:8080\nRunning 10s test @ http://localhost:8080\n  100 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency     3.23ms    4.05ms  34.73ms   88.09%\n    Req/Sec   427.90    160.20   777.00     64.60%\n  403781 requests in 9.99s, 154.03MB read\nRequests/sec:  40417.98\nTransfer/sec:     15.42MB\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69480900/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69481517", "body": "Would it be faster to use `__sync_add_and_fetch` in place of `__sync_fetch_and_add` based on the [documentation](https://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Atomic-Builtins.html)?\n\n__sync_fetch_and_add: These builtins perform the operation suggested by the name, and returns the value _that had previously been in memory._\n\n__sync_add_and_fetch: These builtins perform the operation suggested by the name, and return the _new_ value.\n\nSince we're not doing anything with the return value, I see no need to keep track of the old value.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69481517/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69481916", "body": "Let's look at the emitted instructions: `gobjdump -d CMakeFiles/h2o.dir/lib/common/socketpool.c.o | less`\nthen `/on_close`\n\nfetch and add:\n\n```\n0000000000000610 <_on_close>:\n 610:   55                      push   %rbp\n 611:   48 89 e5                mov    %rsp,%rbp\n 614:   f0 48 ff 8f b8 00 00    lock decq 0xb8(%rdi)\n 61b:   00\n 61c:   5d                      pop    %rbp\n 61d:   c3                      retq\n 61e:   66 90                   xchg   %ax,%ax\n```\n\nadd and fetch:\n\n```\n0000000000000610 <_on_close>:\n 610:   55                      push   %rbp\n 611:   48 89 e5                mov    %rsp,%rbp\n 614:   f0 48 ff 8f b8 00 00    lock decq 0xb8(%rdi)\n 61b:   00\n 61c:   5d                      pop    %rbp\n 61d:   c3                      retq\n 61e:   66 90                   xchg   %ax,%ax\n```\n\nLooks like the compiler knows we're not using the return values; they emit the same code!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69481916/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69483151", "body": "It would be nice to add this info to the readme for new contributors:\n\n```\nthe source files of H2O can be categorized into the following groups.\n\n    libraries\n        memory, string, socket, timeout, ...\n        header file for each library exists in include/h2o\n    the core\n        depends on the libraries\n        defined in context.c, headers.c, request.c, ...\n        declarations are in h2o.h\n    server-side protocol implementations\n        depends on the core\n        http1, http2\n    the standalone server\n        src/main.c\n\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69483151/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69484423", "body": "oof failed some tests.  Is it just `make test` to run the tests?  One thing I noticed is that I have 8 virtual cores on my machine, but if we spawn 8 threads, we're up to 9.  I'm not sure how much work is being done in the main thread, but if it's significant then I should rewrite the patch to use fewer threads.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69484423/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69484461", "body": "I seem to be unable to run the tests:\n\n```\nt/00unit.evloop.t ............... Can't locate Net/EmptyPort.pm in @INC (@INC contains: /Library/Perl/5.12/darwin-thread-multi-2level /Library/Perl/5.12 /Network/Library/Perl/5.12/darwin-thread-multi-2level /Network/Library/Perl/5.12 /Library/Perl/Updates/5.12.4 /System/Library/Perl/5.12/darwin-thread-multi-2level /System/Library/Perl/5.12 /System/Library/Perl/Extras/5.12/darwin-thread-multi-2level /System/Library/Perl/Extras/5.12 .) at t/Util.pm line 7.\nBEGIN failed--compilation aborted at t/Util.pm line 7.\nCompilation failed in require at t/00unit.evloop.t line 6.\nBEGIN failed--compilation aborted at t/00unit.evloop.t line 6.\nDubious, test returned 2 (wstat 512, 0x200)\nNo subtests run\n```\n\nI don't know the first thing about perl, but it looks like I'm missing a dependency.  Are there docs on how to run the tests?  They should be added to the readme.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69484461/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69485032", "body": "I had to install a dependency: `cpan Net::EmptyPort` after wrestling with some OSX 10.8.5 permissions errors in order to run the test suite `make test`.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69485032/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69485094", "body": "Looks like I need to install something called plackup?\n\n```\nt/80issues61.t .................. spawning plackup... Can't exec \"plackup\": No such file or directory at t/Util.pm line 81.\nfailed to exec plackup:No such file or directory at t/Util.pm line 82.\n```\n\n`cpan Plack`\n\nAlso, some tests look like they're running Apache bench `ab`.  That should be added to the readme.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69485094/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69485399", "body": "Looks like another dependency:\n\n```\nt/80issues61.t .................. spawning plackup... Can't locate Plack/Handler/Starlet.pm in @INC (@INC contains: /Library/Perl/5.12/darwin-thread-multi-2level /Library/Perl/5.12 /Network/Library/Perl/5.12/darwin-thread-multi-2level /Network/Library/Perl/5.12 /Library/Perl/Updates/5.12.4 /System/Library/Perl/5.12/darwin-thread-multi-2level /System/Library/Perl/5.12 /System/Library/Perl/Extras/5.12/darwin-thread-multi-2level /System/Library/Perl/Extras/5.12 .) at /Library/Perl/5.12/Plack/Util.pm line 23.\n```\n\n`cpan Plack/Handler/Starlet`\n\nproduces tons of errors:\n\n```\n...\n250 Directory successfully changed.\n250 Directory successfully changed.\n250 Directory successfully changed.\n250 Directory successfully changed.\n550 Failed to change directory.\n(remote-directory) 550 Failed to change directory.\n550 Failed to change directory.\n550 Failed to change directory.\n550 Failed to change directory.\n200 Switching to Binary mode.\nPassive mode: off; fallback to active mode: off.\nlocal: Starlet.tmp69809 remote: Starlet\n200 EPRT command successful. Consider using EPSV.\n550 Failed to open file.\n221 Goodbye.\nBad luck... Still failed!\nCan't access URL ftp://noodle.portalus.net/CPAN/authors/id/P/P//P/Pl/Plack/Handler/Starlet.\n...\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69485399/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69507816", "body": "I should probably also check that sys_thread_count is less than INT_MAX before assigning a long integer to an unsigned integer.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69507816/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69538240", "body": "How's that look?  Let me know if you'd prefer them squashed, I can do that.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69538240/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69655615", "body": "ok will do.  You can't initialize a static stuct to the results of a function call at runtime.  Changing [that line](https://github.com/h2o/h2o/blob/06e923664497ee1d85d1e6d3752d295f8e251a06/src/main.c#L1073) to `sysconf(_SC_NPROCESSORS_ONLN),` will give a compiler error.  If the struct stays statically allocated, then you can only update members at runtime, like I did.  Either it should not be made static, or possibly moved out of main?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69655615/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69656890", "body": "Sounds good.  What about the tests?  I really don't understand why they are failing.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69656890/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69660284", "body": "How's that look?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69660284/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69783545", "body": "Ah, it was the race condition that was causing the tests to fail.  Did you use a tool to help you spot the source of the race?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69783545/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69972401", "body": "neat thanks!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69972401/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69976746", "body": "hmm... was able to pass all of the tests locally.  How do I run individual tests?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69976746/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69993633", "body": "Yep, I'm using clang's static analyzer.  Going to submit a patch that handles a couple of NULL checks too!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69993633/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69996343", "body": "@kazuho , I need your help with one of my projects: https://github.com/nickdesaulniers/What-Open-Source-Means-To-Me preferably in Japanese if you would be so kind!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69996343/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69997665", "body": "http://llvm.org/bugs/show_bug.cgi?id=22228\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/69997665/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70011689", "body": "Looks like we can remove the increments to argv and argc.  http://linux.die.net/man/3/optind\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70011689/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70021515", "body": "I think running the checker with `-disable-checker deadcode.DeadStores`.\n\n```\nmkdir build\ncd !$\n~/Downloads/checker-276/scan-build cmake ..\n~/Downloads/checker-276/scan-build -disable-checker deadcode.DeadStores make\n```\n\nworks.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70021515/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70021617", "body": "Maybe a comment in those lines would be sufficient, ex:\n`if you plan to use dst after this point you must update it by 8` etc\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70021617/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70130057", "body": "should `h2o_mem_alloc` also be marked as `returns_nonnull` as well? https://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#Function-Attributes\n\nI'll file a bug with the static analyzer.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70130057/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70541152", "body": "I think this PR can be closed, since we cherry picked the good parts?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70541152/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70545237", "body": "http://llvm.org/bugs/show_bug.cgi?id=22263\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70545237/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70546673", "body": "Looks like [this](http://unixwiz.net/techtips/gnu-c-attributes.html#compat) will help.  I'm not sure how to see what version of GCC to check for whether noreturn is available.  Also, I thought clang on osx/bsd had a gcc front end or something; I took that to mean compatibility with gcc specific things, like the atomics I added in #98 #100 ?\n\nAlso, from [here](http://docs.freebsd.org/info/gcc/gcc.info.Function_Attributes.html):\n\n```\nThe attribute `noreturn' is not implemented in GNU C versions\n     earlier than 2.5.  An alternative way to declare that a function\n     does not return, which works in the current version and in some\n     older versions, is as follows:\n\n          typedef void voidfn ();\n\n          volatile voidfn fatal;\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70546673/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/9264118", "body": "How do you know that _SC_NPROCESSORS_ONLN is defined in sys/sysctl.h?  I'm not exactly proficient in C/C++, so this is a beginner question.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9264118/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/9424962", "body": "satrt -> start\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9424962/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "review_comments": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/23201655", "body": "Also, this line is super long, wasn't sure if it was ok to split up preprocessor statements across multiple lines.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/23201655/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}]}, "mback2k": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [{"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70430613", "body": "@bagder Implemented by returning 405 Method Not Allowed and Allow header for methods other than GET or HEAD. Thanks for the suggestion.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/issues/comments/70430613/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "commit_comments": [], "review_comments": []}, "linuxscooter": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/7861191", "body": "Hi - not being familiar with git much could you perhaps provide more detailed steps?\nI seem to be getting the following:\n\n> $ cmake .\n> CMake Error: Error in cmake code at\n> /home/pete/h2o/CMakeLists.txt:5:\n> Parse error.  Expected a command name, got unquoted argument with text \"<!DOCTYPE\".\n> -- Configuring incomplete, errors occurred!\n\nThanks and keep up the great work.\nC\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/7861191/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "review_comments": []}, "mgumz": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/8457194", "body": "i am not quite sure you will need to include <alloca.h> at all: \"By default the glibc version of <stdlib.h> includes <alloca.h>\"  (see http://linux.die.net/man/3/alloca ). i compiled the code as it was in 06faa76f2eb70a88e5acc48cde437a469a3dfc17 and that worked quite fine on linux, freebsd and macosx.\n\nwhat reasons do you have to explicitely include <alloca.h>?\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/8457194/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}], "review_comments": []}, "maksqwe": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/9335559", "body": "What about \"-fno-builtin-memcmp\"? It's gcc bug. https://gcc.gnu.org/bugzilla/show_bug.cgi?id=43052\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/9335559/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "review_comments": []}, "TheDecryptor": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/15058017", "body": "Content is spelt wrong here.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/15058017/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/17710784", "body": "An alternative for Linux is `getrandom`, but the code complexity might not be worth it, since it's only defined on newer releases\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/17710784/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/comments/17711820", "body": "From what I understand, it's a shortcut to reading /dev/urandom (Without having to have a fd), which itself is the output of a CSPRNG. Using it as the input to srand would also work.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/17711820/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "review_comments": []}, "devnexen": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [{"url": "https://api.github.com/repos/h2o/h2o/comments/17711578", "body": "is getrandom a number generator ? I m not too sure, althought I m not Linux more a BSD but to me getrandom appears to be closer to getentropy's purpose.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/comments/17711578/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}], "review_comments": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65483398", "body": "Basically for the slowness of RC4 but yes otherwise it is possible for sure. Good point for Apple though I forgot.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65483398/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65483423", "body": "h2o.h already include stdlib.h as these are macros I thought that should not be an issue :)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65483423/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65483443", "body": "Ok fair point.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65483443/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65483458", "body": "Sure I was just not sure about the policy.\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65483458/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65485483", "body": "Yes typo mistake sorry :) not enough awake I guess :)\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/65485483/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "CONTRIBUTOR"}]}, "unasuke": {"issues": [], "commits": [], "pull_requests": [], "issue_comments": [], "commit_comments": [], "review_comments": [{"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/53562498", "body": "It seem curl is duplicate.\n\n``` diff\nRUN apk update \\\n    && apk upgrade \\\n    # need for ocsp stapling \\\n    && apk add -U perl openssl \\\n    && apk add -U build-base \\\n               cmake \\\n-               curl \\\n               linux-headers \\\n               zlib-dev \\\n               ca-certificates curl wget \\\n    && wget -O - $(curl -s https://api.github.com/repos/h2o/h2o/releases/latest | grep tarball | cut -d\\\" -f4) | tar xz \\\n        && cd h2o-* \\\n        && cmake -DWITH_BUNDLED_SSL=on . \\\n        && make install \\\n        && cd .. \\\n        && rm -rf h2o-* \\\n    && apk del build-base \\\n               cmake \\\n-               curl \\\n               linux-headers \\\n               zlib-dev \\\n               ca-certificates curl wget \\\n    && rm -rf /var/cache/apk/*\n```\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/53562498/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}, {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/53579318", "body": "Oh, sorry.\nThank you!\n", "reactions": {"url": "https://api.github.com/repos/h2o/h2o/pulls/comments/53579318/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0}, "author_association": "NONE"}]}}}}